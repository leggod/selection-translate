(()=>{"use strict";var e,t={9966:(e,t,n)=>{n.d(t,{$o:()=>s,FC:()=>o});var l=n(124),a=n(3326),r=n(3150),c=n.n(r),i=n(3417);const s=!0,o={id:"bdocr",name:"百度文字识别",points:!0,secretKeys:{get:()=>c().storage.local.get({baiDuOCRKey:[]}).then((({baiDuOCRKey:e})=>(Array.isArray(e)?e:[e]).map((e=>({id:e.key,key:e.secret}))))),set:e=>c().storage.local.set({baiDuOCRKey:e.map((e=>({key:e.id,secret:e.key})))}),isComplete:e=>(0,i.dz)(e,["id"])},pointsEnable:{get:()=>c().storage.local.get({bdOcrPoints:s}).then((({bdOcrPoints:e})=>e)),set:e=>c().storage.local.set({bdOcrPoints:e})}};class m extends l.E{constructor(){super(o,!0)}callBySecretKey(e,t){return new a.w(e).ocr(t.image)}transform(e){if(!e.paragraphs_result)throw new Error("百度文字识别服务配置有误，请确认你领取过免费资源包，且密钥填写无误。");return e.paragraphs_result.reduce(((t,{words_result_idx:n})=>(t.push(n.reduce(((t,n)=>t+e.words_result[n].words),"")),t)),[]).join("\n")}}new m},6372:(e,t,n)=>{n.d(t,{Xn:()=>o,Lx:()=>d,zr:()=>E});var l=n(1227),a=n.n(l),r=n(3938);const c=a()("web-speech"),i=window.SpeechRecognition||window.webkitSpeechRecognition,s=!!i,o={"cnm-Hans-CN":"中文(简体)","en-US":"英语(美国)","ja-JP":"日语","ko-KR":"韩语","fr-FR":"法语","de-DE":"德语","ru-RU":"俄语"},m={"audio-capture":"你的电脑没有连接麦克风。","no-speech":"没有检测到语音。","not-allowed":"请在浏览器询问是否允许使用麦克风时选择“允许”。如果你之前选择过“禁止”，请点击浏览器地址栏左侧的锁或感叹号图标，然后将“麦克风”改为“允许”。如果浏览器从未询问过，则说明当前页面由于未知的原因不允许使用麦克风。","service-not-allowed":"你的浏览器当前不允许使用划词翻译的内置语音识别服务。",network:"网络出错，请检查你的网络连接。注意：划词翻译内置的语音转文字服务需要能连接外网才可使用。","language-not-supported":"你的浏览器不支持识别此语种。",aborted:"识别过程被中断了。","bad-grammar":"语法错误。"},u=/\S/;const d={id:"default-speech",name:"划词翻译内置语音转文字",realtime:!0,defaultLang:"cnm-Hans-CN"};class p extends r.Z{constructor(){super(d)}async microphone(e){const{lang:t,options:n}=e;if(!s)throw new Error("划词翻译的内置语音转文字服务不支持在 Firefox 上使用，请选用腾讯云语音转文字服务。");let l=!1,a=!1;const r=new i;r.lang=t,r.interimResults=!!n.onInterim,r.continuous=!n.stopOnFirstSentence,r.addEventListener("error",(e=>{var t;c("error 事件",e),"aborted"===e.error&&l||(l=!0,null===(t=n.onError)||void 0===t||t.call(n,new Error(`${m[e.error]||e.error+". "}${e.message||""}`)))}));const o=[];return r.addEventListener("result",(e=>{var t,l;const a=e.results[e.resultIndex],r=a[0].transcript;if(a.isFinal){const e=r.replace(u,(function(e){return e.toUpperCase()}));c("识别到一句完整的话：",e),null===(t=n.onSentence)||void 0===t||t.call(n,e),o.push(e)}else c("识别到一句话的临时结果：",r),null===(l=n.onInterim)||void 0===l||l.call(n,r)})),r.addEventListener("nomatch",(e=>{var t;c("nomatch 事件",e),a=!0,null===(t=n.onError)||void 0===t||t.call(n,new Error(`${this.service.name}无法准确识别你的语音，请确保在安静的环境中，并吐字清晰。`))})),r.addEventListener("end",(e=>{var t;c("end 事件",e,"识别出来的文本：",o,`是否已经中断：${l}`,`是否已经 nomatch：${a}`),l||a||null===(t=n.onStop)||void 0===t||t.call(n,o)})),r.start(),{stop:()=>{c("调用 stop 方法"),r.stop()},abort:()=>{c("调用 abort 方法"),l=!0,r.abort()}}}mediaStream(e){return Promise.reject(new Error("划词翻译的内置语音转文字服务只支持通过麦克风使用。"))}}const E=new p},3951:(e,t,n)=>{var l=n(7294),a=n(3935),r=n(6974),c=n(5744),i=n(966),s=n(7643),o=n(3150),m=n.n(o),u=n(4898),d=n(267),p=n(1515);function E(e){const[t,n]=(0,l.useState)(!1),a=e.inputRef,[r,c]=(0,l.useState)(null);(0,l.useEffect)((()=>{a&&("function"==typeof a?a(r):a.current=r)}),[r,a]);const s={...e,inputRef:c};return l.createElement(i.BZ,{...s,type:t?"text":"password",rightElement:l.createElement(i.zx,{icon:t?"eye-open":"eye-off",minimal:!0,onClick:()=>{n((e=>!e)),null==r||r.focus()}})})}const h=i.x7.create(),g={email:"",pwd:"",vk:""},f=(0,l.forwardRef)((function(e,t){const{onLogin:n,openType:a,tip:r}=e,[c,s]=(0,l.useState)(!1),o=(0,l.useRef)(null),m=(0,l.useRef)(null),[f,v]=(0,l.useState)(null),b="login"===a,y=b?"登录":"注册";(0,l.useEffect)((()=>{f&&f.focus()}),[f]);const[k,w]=(0,l.useState)(g),[x,C]=(0,d.Z)((async()=>{try{await u.L.post("/sendEmail",(0,p.Z)(k,"email"))}catch(e){return}h.show({intent:"success",message:l.createElement(l.Fragment,null,l.createElement("p",null,"验证码已发送到你的邮箱，请查收。"),l.createElement("div",{className:"bp3-text-small"},"如果长时间没有收到验证码，请确认邮箱是否填写有误，或者检查验证码邮件是否在垃圾邮箱里。")),timeout:0}),s(!0)}),[k]),[S,T]=(0,d.Z)((async()=>{try{const e=await u.L.post(b?"/login":"/register",k);n(e.data)}catch(e){}}),[a,k,n]);return(0,l.useImperativeHandle)(t,(()=>({clear(){w(g)},focus(e){var t,n;"user"===e?null===(t=o.current)||void 0===t||t.focus():"pwd"===e&&(null===(n=m.current)||void 0===n||n.focus())}})),[]),l.createElement("form",{onSubmit:e=>{e.preventDefault(),b||c?T():C()}},l.createElement("div",{className:"bp3-dialog-body"},r,l.createElement(i.cw,{label:"邮箱",labelFor:"email-input",labelInfo:"（区分大小写）"},l.createElement(i.BZ,{id:"email-input",disabled:S.loading,inputRef:o,value:k.email,onChange:e=>{w((t=>({...t,email:e.target.value})))},required:!0,type:"email",pattern:"\\b[\\w.-]+@[\\w.-]+\\.\\w{2,4}\\b"})),l.createElement(i.cw,{label:"密码",labelFor:"pwd-input"},l.createElement(E,{id:"pwd-input",disabled:S.loading,inputRef:m,value:k.pwd,onChange:e=>{w((t=>({...t,pwd:e.target.value})))},required:!0,minLength:6,maxLength:20})),c&&l.createElement(i.cw,{label:"验证码",labelFor:"vk-input"},l.createElement(i.BZ,{id:"vk-input",inputRef:v,disabled:S.loading,value:k.vk,onChange:e=>{w((t=>({...t,vk:e.target.value})))},required:!0}))),l.createElement("div",{className:"bp3-dialog-footer"},l.createElement("div",{className:"bp3-dialog-footer-actions",style:{alignItems:"center"}},"login"===a&&l.createElement("a",{href:"https://hcfy.app/forget.html",target:"_blank",rel:"noreferrer"},"忘记密码？"),l.createElement(i.zx,{text:y,loading:x.loading||S.loading,type:"submit",intent:"primary",style:{marginLeft:"15px"}}))))}));var v=n(9970),b=n(1922);const y=l.createContext(),k=l.createContext(),w=(0,p.Z)(v.d,"user");function x(e){const[t,n]=(0,b.Z)(w),a=(0,l.useCallback)((e=>{n({user:e})}),[n]);return l.createElement(k.Provider,{value:a},l.createElement(y.Provider,{value:t&&t.user},e.children))}function C(e){const{open:t}=e,n=(0,l.useRef)(),{setShowVip:a,setShowLogin:c,syncOptions:s}=(0,l.useContext)($),o=(0,l.useContext)(k),m=(0,r.s0)(),u=()=>{var e;null===(e=n.current)||void 0===e||e.clear()},d="登录";return l.createElement(i.Vq,{isOpen:t,onClose:()=>{c(!1),u()},onClosed:u,onOpened:()=>{var e;null===(e=n.current)||void 0===e||e.focus("user")},title:d},l.createElement(f,{ref:n,onLogin:e=>{c(!1),o(e),s(e)},openType:"login",tip:l.createElement("p",null,"划词翻译无需",d,"即可免费使用，只有当你要用",l.createElement("a",{onClick:()=>{c(!1),a(!0)}},"会员功能"),"或",l.createElement("a",{onClick:()=>{c(!1),m("/services?tab=points")}},"翻译积分"),"时才需要",d,"。")}))}var S=n(1095),T=n(9669);const L=n.n(T)().create({baseURL:"https://hcfy.app/"});var Z=n(7856);function A(e){const{docURL:t}=e,n=(0,S.Z)((async()=>(await L.get(t)).data),[t]);return n.loading?l.createElement("p",null,"正在加载，请稍候……"):n.error?l.createElement("p",null,"加载失败，请稍后重试。"):l.createElement("div",{dangerouslySetInnerHTML:{__html:n.value?(0,Z.sanitize)(n.value,{USE_PROFILES:{html:!0},ADD_ATTR:["target"]}):"加载失败，请稍后重试。"}})}function N(e){const{nextBtnText:t,summaryURL:n,onNext:a,onLogin:r}=e,c=(0,l.useContext)(y);return l.createElement(l.Fragment,null,l.createElement("div",{className:"bp3-dialog-body"},l.createElement(A,{docURL:n})),l.createElement("div",{className:"bp3-dialog-footer"},l.createElement("div",{className:"bp3-dialog-footer-actions",style:{alignItems:"center"}},!c&&l.createElement("a",{onClick:r},"已有账号？去登录"),l.createElement(i.zx,{intent:"primary",text:t||"下一步",onClick:a}))))}var R=n(9599),P=n(986);function O(e){let t;return(null==e?void 0:e.vipEndTime)&&(0,R.Z)(t=new Date(e.vipEndTime))?{isOpened:!0,text:"续费会员",endTime:(0,P.Z)(t,"yyyy 年 M 月 d 日 HH:mm:ss")}:{isOpened:!1,text:"开通会员"}}var F=n(8652);const D=[{label:"支付宝",value:"alipay"},{label:"微信",value:"wx"},{label:"PayPal",value:"pp"}],K="https://hcfy.app/docs/paypal";function I(e){var t;const{onPaid:n,priceURL:a,createOrderAPI:r}=e,[c,s]=(0,l.useState)("alipay"),[o,m]=(0,l.useState)(""),d=null===(t=D.find((e=>e.value===c)))||void 0===t?void 0:t.label,p=(0,S.Z)((async()=>{const e=(await L.get(a)).data;return m(e[0].value),e}),[a]),E=(0,S.Z)((async()=>{if(!o)return;if("pp"===c)return void window.open(K);return(await u.L.post(r,{id:o,method:c})).data}),[c,o,r]),h=E.value;return(0,l.useEffect)((()=>{if(!h)return;const e=window.setInterval((async()=>{if(!h)return;let e;try{e=await u.L.get("/checkOrder",{params:{orderId:h.orderId}})}catch(e){return}e.data.paid&&n(e.data.user)}),1e3);return()=>{window.clearInterval(e)}}),[n,h]),l.createElement(l.Fragment,null,l.createElement("div",{className:"bp3-dialog-body"},l.createElement(i.Ee,{label:"请选择支付方式:",inline:!0,options:D,selectedValue:c,onChange:e=>{s(e.currentTarget.value)}}),"pp"===c?l.createElement("div",null,"请阅读",l.createElement("a",{href:K,target:"_blank",rel:"noreferrer"},"如何使用 PayPal 付款"),"。"):l.createElement(l.Fragment,null,p.loading?l.createElement("p",null,"正在加载价格信息，请稍候……"):p.error?l.createElement("p",null,"价格信息加载失败，请稍后重试。"):l.createElement(i.Ee,{label:"请选择：",inline:!0,onChange:e=>{m(e.currentTarget.value)},selectedValue:o,options:p.value}),l.createElement("p",null,"请使用",l.createElement("b",{style:{fontSize:20}},d),"扫描下方二维码支付："),E.loading?l.createElement("p",null,"正在加载二维码，请稍候……"):E.error?l.createElement("p",null,"加载二维码时出错，请稍后重试。错误信息：",l.createElement("span",{style:{color:"#FFB366"}},E.error.message),"alipay"===c&&"支付宝偶尔不能正常加载二维码，请换用其它支付方式。"):h&&l.createElement(l.Fragment,null,l.createElement("p",null,l.createElement("img",{src:h.qrUrl,width:280,height:280,alt:"支付二维码"})),l.createElement("p",{className:"bp3-text-muted"},"当你完成支付后，此页面一般会在 5 秒内自动跳转，在跳转之前请不要关闭窗口。如果 30 秒后还没有跳转，你可以重启浏览器试试。")))))}const z=l.createElement(i.JO,{icon:"tick-circle",intent:"success"});function B(e){const t=(0,l.useContext)(y),n=(0,l.useContext)(k),{onFinish:a,generateSuccessMsg:r,priceURL:c,createOrderAPI:s,onPaid:o}=e,m=(0,l.useRef)(),[u,d]=(0,l.useState)(t?1:0),[p,E]=(0,l.useState)([{text:"第一步：注册账号"},{text:"第二步：购买"},{text:"完成"}]);return(0,l.useEffect)((()=>{var e;E((e=>{const t=(0,F.Z)(e);return t.forEach(((e,t)=>{t<u?(e.current=!1,e.icon=z):t===u?(e.current=!0,delete e.icon):(e.current=!1,delete e.icon)})),t})),0!==u||null===(e=m.current)||void 0===e||e.focus("user")}),[u]),l.createElement(l.Fragment,null,l.createElement(i.Oo,{className:"buy-steps",items:p,overflowListProps:{minVisibleItems:3}}),0===u&&l.createElement(f,{ref:m,onLogin:e=>{n(e),d((e=>e+1))},openType:"register"}),1===u&&l.createElement(I,{priceURL:c,createOrderAPI:s,onPaid:e=>{n(e),o&&o(),d((e=>e+1))}}),2===u&&l.createElement(l.Fragment,null,l.createElement("div",{className:"bp3-dialog-body"},"支付成功！",t&&r(t)),l.createElement("div",{className:"bp3-dialog-footer"},l.createElement("div",{className:"bp3-dialog-footer-actions"},l.createElement(i.zx,{text:"完成",intent:"primary",onClick:a})))))}const _={0:{title:"开通会员",docURL:"/vip-short-summary.html",summaryBtnText:"开通会员",docPricesURL:"/prices.json",qrAPI:"/getPayQR",generateSuccessMsg:e=>e.forever?"您的会员永不过期":`您的会员到期时间为 ${O(e).endTime}。`,onPaid:()=>{m().runtime.sendMessage({action:"sync data"})}},1:{title:"购买翻译积分",docURL:void 0,summaryBtnText:void 0,docPricesURL:"/points.json",qrAPI:"/getPointsPayQR",onPaid:void 0,generateSuccessMsg:e=>`您的翻译积分数量为 ${e.points}。您可以前往【个人中心】确认翻译积分余额。`}};function q(e){const{isOpen:t,buyType:n}=e,a=_[n],r=a.docURL?0:1,[c,s]=(0,l.useState)(r),{setShowVip:o,setShowLogin:m,setShowBuyPoints:u}=(0,l.useContext)($);let d;switch(n){case 0:d=o;break;case 1:d=u;break;default:throw new TypeError(`不支持的购买类型：${n}`)}const p=()=>{d(!1)},E=()=>{p(),s(r)};return l.createElement(i.Vq,{isOpen:t,canOutsideClickClose:!1,canEscapeKeyClose:!1,onClose:E,title:a.title,style:0===c?{width:660}:void 0},a.docURL&&0===c&&l.createElement(N,{summaryURL:a.docURL,nextBtnText:a.summaryBtnText,onNext:()=>{s((e=>e+1))},onLogin:()=>{p(),m(!0)}}),1===c&&l.createElement(B,{priceURL:a.docPricesURL,createOrderAPI:a.qrAPI,onPaid:a.onPaid,generateSuccessMsg:a.generateSuccessMsg,onFinish:E}))}var U=n(4063),V=n.n(U);async function H(){const e=await m().storage.local.get(v.q),t=await u.L.put("/options",{options:JSON.stringify(e)});await m().storage.local.set({optionsSyncAt:t.data})}async function M(e){let t;e||(t=(await m().storage.local.get("optionsSyncAt")).optionsSyncAt);const n=await u.L.get("/options",{params:{ifModifiedSince:t}});if(204===n.status)return"no-data";if(304===n.status)return"not-modified";const l=n.data;if(!l)return"server-data-error";let a;try{a=JSON.parse(l.optionsString)}catch(e){return"server-data-error"}return V()(await m().storage.local.get(v.q),a)?(await m().storage.local.set({optionsSyncAt:l.updatedAt}),"not-modified"):e||t?(a.optionsSyncAt=l.updatedAt,await m().storage.local.set(a),"covered"):{status:"need-confirm",date:l.updatedAt}}const W=i.x7.create({maxToasts:2}),j=(0,l.forwardRef)((function(e,t){const[n,a]=(0,l.useState)(!1),[r,c]=(0,l.useState)("");(0,l.useImperativeHandle)(t,(()=>({async syncOptions(){let e;try{e=await async function(){const e=await M();return"no-data"===e?(await H(),"uploaded"):e}()}catch(e){return}"string"!=typeof e?(c(e.date),a(!0)):W.show({intent:"success",message:l.createElement(l.Fragment,null,"uploaded"===e&&"已将划词翻译设置上传到服务器。","not-modified"===e&&"划词翻译设置已经是最新的了，无需更新。","server-data-error"===e&&"服务器保存的划词翻译设置数据有误，请稍后重试。如果多次出现这种情况，请反馈给我。","covered"===e&&"已更新划词翻译设置。")})}})),[]);const s=new Date(r),o=(0,R.Z)(s)?(0,P.Z)(s,"yyyy-MM-dd HH:mm:ss"):"";return l.createElement(i.bZ,{isOpen:n,cancelButtonText:"上传本地设置",confirmButtonText:"下载云端设置",onCancel:async()=>{a(!1);try{await H(),W.show({intent:"success",message:"上传成功"})}catch(e){}},onConfirm:async()=>{let e;a(!1);try{e=await M(!0)}catch(e){return}W.show({intent:"success",message:l.createElement(l.Fragment,null,"no-data"===e&&"服务器没有保存过划词翻译设置，请先将本地设置上传。","not-modified"===e&&"划词翻译设置已经是最新的了，无需更新。","server-data-error"===e&&"服务器保存的划词翻译设置数据有误，请稍后重试。如果多次出现这种情况，请反馈给我。","covered"===e&&"已更新划词翻译设置。")})}},l.createElement(i.H4,null,"同步设置"),l.createElement("p",null,"您本地的设置与 ",o," ","上传至云端的设置不一致，您想要如何同步您的设置？"))})),$=l.createContext(),J="?login"===window.location.search,X="?vip"===window.location.search;function Y(e){const[t,n]=(0,l.useState)(J),[a,r]=(0,l.useState)(!1),[c,i]=(0,l.useState)(X),s=(0,l.useRef)(null),o=(0,l.useCallback)((e=>{var t;(null==e?void 0:e.vipActivated)?null===(t=s.current)||void 0===t||t.syncOptions():i(!0)}),[]);return l.createElement($.Provider,{value:{setShowLogin:n,setShowBuyPoints:r,setShowVip:i,syncOptions:o}},l.createElement(C,{open:t}),l.createElement(q,{isOpen:a,buyType:1}),l.createElement(q,{isOpen:c,buyType:0}),l.createElement(j,{ref:s}),e.children)}const Q="?notices"===window.location.search,G={...(0,p.Z)(v.q,["noticesRead"]),...(0,p.Z)(v.d,["noticesUnreadNum","noticesFiltered"])};function ee(){const[e,t]=(0,b.Z)(G),[n,a]=(0,l.useState)(!0),[r,c]=(0,l.useState)(Q),s=[],o=[];e&&e.noticesFiltered.forEach((t=>{e.noticesRead.includes(t.id)?s.push(t):o.push(t)}));const u=n?o:s;return(0,l.useEffect)((()=>{m().runtime.sendMessage({action:"refresh notices"})}),[]),l.createElement("div",{style:{position:"relative"}},l.createElement(i.J2,{popoverClassName:"notice-popover",isOpen:r,position:"bottom",onClose:()=>{c(!1)},onClosed:()=>{a(!0)},content:l.createElement(l.Fragment,null,l.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10}},l.createElement(i.H4,{style:{marginBottom:0}},"通知"),l.createElement("a",{onClick:()=>a((e=>!e))},"显示",n?"已读":"未读")),l.createElement("div",{className:"notices-box"},u.map((n=>{const a=null==e?void 0:e.noticesRead.includes(n.id);return l.createElement(i.Zb,{key:n.id,style:{padding:10}},n.title&&l.createElement(i.H6,null,n.title),l.createElement("p",{dangerouslySetInnerHTML:{__html:(0,Z.sanitize)(n.text)}}),(n.link||!a)&&l.createElement("p",{className:"actions"},n.link&&l.createElement("a",{href:n.link,target:"_blank",rel:"noreferrer"},"查看详情"),!a&&l.createElement(l.Fragment,null,l.createElement("a",{style:{float:"right"},onClick:()=>{t((e=>{e.noticesRead.push(n.id)}))}},"标为已读"))))})),!u.length&&l.createElement(i.tR,{icon:"notifications-updated",description:`没有${n?"未读":"已读"}通知`})))},l.createElement(i.zx,{icon:"notifications",onClick:()=>c((e=>!e)),minimal:!0})),!!(null==e?void 0:e.noticesUnreadNum)&&l.createElement("div",{className:"notices-num",style:{position:"absolute",top:0,right:0}},null==e?void 0:e.noticesUnreadNum))}function te(e){const t=(0,l.useRef)(null),{inline:n}=e;return(0,l.useEffect)((()=>{var e;if(!n)return;const l=t.current;if(!l)return;const a=null===(e=l.closest(".bp3-popover-wrapper"))||void 0===e?void 0:e.parentElement;return a?(a.classList.add("bp3-inline"),()=>{a.classList.remove("bp3-inline")}):void 0}),[n]),l.createElement(i.u,{interactionKind:"hover",hoverCloseDelay:300,position:"bottom",content:l.createElement("div",{style:{width:e.width||300}},e.children)},l.createElement("span",{ref:t,style:{display:"inline-flex",height:12,width:12}},l.createElement(i.JO,{icon:"help",iconSize:12,style:{cursor:"help"}})))}function ne(){const{syncOptions:e}=(0,l.useContext)($),t=(0,l.useContext)(y),n=(0,r.s0)();return l.createElement(l.Fragment,null,l.createElement(i.wp,{fixedToTop:!0},l.createElement(i.fT,{align:"left"},l.createElement(i.ym,null,"划词翻译"," ",l.createElement("span",{className:"bp3-text-small"},"v",m().runtime.getManifest().version))),l.createElement(i.fT,{align:"right"},l.createElement(i.AN,{icon:"git-repo",text:"更新日志",minimal:!0,href:"https://hcfy.app/docs/log",target:"_blank",rel:"noreferrer"}),l.createElement(i.AN,{icon:"issue",text:"反馈问题",href:"https://hcfy.app/docs/issues",target:"_blank",rel:"noreferrer"}),l.createElement(i.ox,null),l.createElement(i.zx,{icon:"refresh",text:"同步设置",onClick:()=>{e(t)},style:{marginRight:"10px"}}),l.createElement(te,null,l.createElement("p",null,"开通会员后，划词翻译会在你每次更改设置后自动将设置上传到服务器。"),l.createElement("div",null,"另外，划词翻译会在后台每隔一小时检查设置是否有变更，你也可以点击“同步设置”按钮立刻进行一次检查。")),l.createElement(i.ox,null),l.createElement(i.zx,{icon:t?t.vipActivated?"crown":"user":"log-in",minimal:!0,onClick:()=>{n("/user")},rightIcon:t?"caret-down":void 0,text:t?t.email:"登录"}),l.createElement(ee,null))))}var le=n(9203),ae=n(4194);let re=!1;const ce=i.x7.create({maxToasts:2});function ie(e){return l.createElement(l.Fragment,null,l.createElement("li",{className:"bp3-text-muted bp3-text-small",style:{marginTop:15,paddingLeft:5}},e.title),l.createElement(i.R,null))}c.$.onlyShowFocusOnTabs(),re||(u.L.interceptors.response.use(le.Z,(e=>{const t={intent:"danger",message:""},n=(0,ae.RE)(e);return t.message=n.message,n.link&&(t.action={text:n.link.name,href:n.link.url,target:"_blank"}),ce.show(t),Promise.reject(e)})),re=!0);var se=n(9711);function oe(e){const[t,n]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{function t(){m().permissions.contains(e).then(n)}return t(),m().permissions.onAdded.addListener(t),m().permissions.onRemoved.addListener(t),()=>{m().permissions.onAdded.removeListener(t),m().permissions.onRemoved.removeListener(t)}}),[e]),t}const me={permissions:["notifications"]};const ue={origins:["<all_urls>"]};const de=window.navigator.userAgent,pe=(de.includes("Mac"),de.includes("Chrome")),Ee=de.includes("Edg"),he=pe&&!Ee,ge=de.includes("Firefox");function fe(e){return e.split(".").map((e=>Number(e)))}fe(m().runtime.getManifest().version);const ve="chrome://extensions/?id="+m().runtime.id;function be(){m().tabs.create({url:ve})}const ye=l.createElement("a",{onClick:be},"划词翻译的详细信息页面"),ke=Ee?"允许访问文件 URL":"允许访问文件网址";function we(){const e=(0,S.Z)((()=>m().extension.isAllowedFileSchemeAccess()),[]);return e.loading||e.value||e.error?null:l.createElement(i.UW,{icon:"info-sign",title:"未允许划词翻译访问文件网址"},l.createElement("p",null,"你需要先前往",ye,"勾选【",ke,"】，划词翻译才能检测到或者自动打开你拖放进浏览器的 PDF 文件。另外，当你勾选之后，你就可以将你电脑里的文件（例如"," ",l.createElement(i.EK,null,".txt"),"、",l.createElement(i.EK,null,".md"),"、",l.createElement(i.EK,null,".html")," 或"," ",l.createElement(i.EK,null,".png"),"）拖放进浏览器并使用划词翻译了。"),l.createElement(i.zx,{intent:"primary",onClick:be},"去勾选"))}function xe(){return l.createElement(i.UW,{icon:"info-sign"},"由于你的浏览器不提供本地文件的访问权限，所以划词翻译无法自动打开你拖放进浏览器的 PDF 文件，也无法在以 ",l.createElement(i.EK,null,"file:///")," ","开头的网址（例如你拖放进浏览器的 ",l.createElement(i.EK,null,".txt")," 或 ",l.createElement(i.EK,null,".png")," ","文件）里使用。")}const Ce=Ee?"站点访问权限":"有权访问的网站";function Se(e){return oe(ue)?null:l.createElement(i.UW,{icon:"info-sign",title:"你更改了划词翻译的权限范围",style:e.style,intent:"danger"},l.createElement("p",null,"划词翻译检测到你更改了【",Ce,"】，这会导致划词翻译在所有网站内都无法正常使用，各翻译服务以及登录 / 注册划词翻译账号时均会提示”服务器无响应“。请前往",ye,"，将【",Ce,"】改为【在所有网站上】。"),l.createElement("p",null,"如果你希望在部分网站内不启用网页划词，你可以点击浏览器地址栏右侧的划词翻译图标，展开【此页面已启用网页划词】，然后选择【在当前网站中禁用】。你还可以在左侧的【网页划词翻译】中勾选【在所有网站中禁用网页划词】，只通过快捷键、辅助键或右键菜单的方式显示翻译结果。"),l.createElement(i.zx,{intent:"primary",onClick:be},"去修改"))}function Te(e){const{setShowVip:t}=(0,l.useContext)($),n=(0,l.useContext)(y),a=e.forever?"永久":"";return(e.forever?null==n?void 0:n.forever:null==n?void 0:n.vipActivated)?l.createElement(l.Fragment,null,"你已经是",a,"会员了，可以使用此功能。",!(null==n?void 0:n.forever)&&l.createElement("a",{onClick:()=>t(!0)},"续费会员")):l.createElement(l.Fragment,null,"这是一个",a,"会员功能，请在",l.createElement("a",{onClick:()=>t(!0)},"成为",a,"会员"),"后使用。")}const Le=l.createElement(i.u,{interactionKind:"hover",hoverCloseDelay:300,content:l.createElement(Te,null)},l.createElement(i.Vp,{style:{top:"3px"},icon:"crown"},"会员功能")),Ze=l.createElement(i.u,{interactionKind:"hover",hoverCloseDelay:300,content:l.createElement(Te,{forever:!0})},l.createElement(i.Vp,{style:{top:"3px",fontWeight:"normal"},icon:"crown"},"永久会员功能")),Ae=(0,p.Z)(v.q,["pageTrsJumpTwo"]);function Ne(){m().tabs.create({url:"chrome://extensions/shortcuts"})}const Re={_execute_browser_action:"打开划词翻译的扩展按钮弹出窗口。",switchWeb:"切换【在所有网站中禁用网页划词】选项。",pageSwitchMode:l.createElement(l.Fragment,null,"可选项：",l.createElement((function(){const[e,t]=(0,b.Z)(Ae);return l.createElement(i.XZ,{inline:!0,style:{marginBottom:0},label:"跳过【双语】",checked:e?e.pageTrsJumpTwo:Ae.pageTrsJumpTwo,onChange:e=>{t({pageTrsJumpTwo:e.target.checked})}})}),null)),panel:l.createElement(l.Fragment,null,l.createElement("div",{style:ge?{textDecoration:"line-through"}:void 0},"这是一个全局快捷键，你可以在浏览器以外的地方使用此快捷键来打开独立窗口翻译剪切板内的文本或图片。在修改此快捷键时，请确保作用域为“全局”。"),ge&&l.createElement("b",null,"由于 Firefox 不支持全局快捷键，所以无法在浏览器以外的地方使用此快捷键。"))};function Pe(){var e;const t=(0,S.Z)((()=>m().commands.getAll()),[]);return l.createElement(i.Zb,null,l.createElement(i.H4,null,"快捷键"),l.createElement("p",null,pe&&l.createElement(l.Fragment,null,"请前往",l.createElement("a",{onClick:Ne},"键盘快捷键页面"),"修改这些快捷键。",l.createElement("a",{href:"https://hcfy.app/docs/faq#edit-shortcut-key",target:"_blank",rel:"noreferrer"},"修改后没有生效？")),ge&&"请打开附加组件管理器（about:addons），点击“管理扩展程序”右侧的设置按钮，选择“管理扩展快捷键”来修改这些快捷键。"),l.createElement(i.vl,{condensed:!0,striped:!0,bordered:!0},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{style:{width:160}},"名称"),l.createElement("th",{style:{width:170}},"快捷键"),l.createElement("th",null,"简介"))),l.createElement("tbody",null,null===(e=t.value)||void 0===e?void 0:e.map((e=>{const t=e.name;return t?l.createElement("tr",{key:t},l.createElement("td",null,e.description||"激活该扩展程序"),l.createElement("td",null,e.shortcut?function(e){const t=e.split("+"),n=t.length-1;return l.createElement(l.Fragment,null,t.map(((e,t)=>{const a=t===n;return l.createElement(l.Fragment,{key:e},l.createElement("kbd",null,e),!a&&"+")})))}(e.shortcut):"未设置"),l.createElement("td",null,Re[t])):null})))))}var Oe=n(8325),Fe=n(2414),De=n(2574);let Ke;const Ie=()=>Ke||(Ke=(0,Oe.X)((()=>new Promise(((e,t)=>{const n=window.speechSynthesis.getVoices();n.length?e(n):t(new Error("无法获取系统支持的语音列表，请稍后重试。"))}))),{delay:500,count:10}).then((e=>{const t={},n={};e.forEach((e=>{const l=e.lang;t[l]?t[l].push(e):t[l]=[e];const a=l.slice(0,l.indexOf("-"));n[a]?n[a].indexOf(l)<0&&n[a].push(l):n[a]=[l]}));const l=[],a={};return(0,Fe.Z)(t,((e,n)=>{1===e.length&&(l.push(n),a[n]=e[0],delete t[n])})),(0,Fe.Z)(n,((e,t)=>{1===e.length&&delete n[t]})),{singleVoiceMap:a,singleList:l,voicesGroup:t,multipleLang:n}}))),ze=(0,De.Z)({"中文(简体)":"zh-CN","中文(粤语)":"zh-HK","中文(繁体)":"zh-TW",英语:"en","英语(英国)":"en-GB","英语(美国)":"en-US","英语(加拿大)":"en-CA","英语(澳大利亚)":"en-AU","英语(印度)":"en-IN","英语(爱尔兰)":"en-IE","英语(南非)":"en-ZA",德语:"de-DE",西班牙语:"es-ES","西班牙语(墨西哥)":"es-MX","西班牙语(美国)":"es-US","西班牙语(阿根廷)":"es-AR",法语:"fr-FR","法语(加拿大)":"fr-CA",印地语:"hi-IN",印尼语:"id-ID",意大利语:"it-IT",日语:"ja-JP",韩语:"ko-KR",荷兰语:"nl-NL","荷兰语(比利时)":"nl-BE",波兰语:"pl-PL",葡萄牙语:"pt-PT","葡萄牙语(巴西)":"pt-BR",俄语:"ru-RU",土耳其语:"tr-TR",瑞典语:"sv-SE",希伯来语:"he-IL",罗马尼亚语:"ro-RO",泰语:"th-TH",斯洛伐克语:"sk-SK",阿拉伯语:"ar-SA",匈牙利语:"hu-HU",希腊语:"el-GR",挪威语:"nb-NO",丹麦语:"da-DK",芬兰语:"fi-FI",捷克语:"cs-CZ"}),Be=(0,De.Z)({"中文(简体)":"zh",英语:"en",法语:"fr",西班牙语:"es",荷兰语:"nl",葡萄牙语:"pt"});Be.zh="中文";const _e={...(0,p.Z)(v.q,["audioVolume","audioRate","systemTTS","systemTTSVoice","systemTTSAccent"]),...(0,p.Z)(v.d,["user"])};function qe(){const[e,t]=(0,b.Z)(_e),n=(0,S.Z)(Ie),{setShowVip:a}=(0,l.useContext)($);return e?l.createElement(l.Fragment,null,l.createElement(i.Zb,null,l.createElement(i.H4,{id:"系统语音"},l.createElement("span",{style:{marginRight:10}},"系统语音"),l.createElement(te,null,l.createElement("p",null,"系统语音是由你的浏览器和操作系统提供的语音，划词翻译支持使用系统语音来朗读文本。"),l.createElement("p",null,"系统语音有两种类型：本地语音和网络语音。本地语音在电脑没有联网时也能使用；网络语音需要电脑联网才能使用，网络不好的情况下可能无法发声。",he&&l.createElement("b",null,"由谷歌提供的网络语音需要能连接外网才可使用。")),l.createElement("div",null,"建议在 Microsoft Edge 浏览器或 macOS 操作系统上使用系统语音设置，因为它们提供的语音最丰富多样。"))),l.createElement(i.cw,{label:"何时使用系统语音",helperText:"部分操作系统或浏览器在使用系统语音后可能会出现浏览器崩溃、视频音画不同步或杂音问题，如果你遇到了这些问题，请选择“不使用系统语音”。"},l.createElement(i.Ee,{selectedValue:e.systemTTS,onChange:e=>{t({systemTTS:e.currentTarget.value})}},l.createElement(i.Y8,{label:"先使用翻译源自己的语音朗读，如果翻译源无法朗读，再使用系统语音",value:"aid"}),l.createElement(i.Y8,{label:"始终使用系统语音朗读",value:"prior"}),l.createElement(i.Y8,{label:"不使用系统语音",value:"none"}))),n.loading?l.createElement("div",null,"正在读取系统语音列表，请稍候……"):n.error?l.createElement("div",null,n.error.message):n.value&&l.createElement(i.cw,null,l.createElement(i.cw,{className:"inline-form-group-label",label:l.createElement(l.Fragment,null,"选择口音",Le),helperText:Object.keys(n.value.multipleLang).length?"你的浏览器对以上语言支持多种口音，你可以选择一个你喜欢的口音来朗读这些语言。":"你的浏览器没有提供多个口音，因此无法选择。"},Object.keys(n.value.multipleLang).map((r=>{var c,s;const o=null===(c=n.value)||void 0===c?void 0:c.multipleLang[r];return l.createElement("div",{key:r},Be[r]||r,"：",l.createElement(i.Lu,{value:(null===(s=null==e?void 0:e.user)||void 0===s?void 0:s.vipActivated)?e.systemTTSAccent[r]:r,onChange:n=>{var l;(null===(l=null==e?void 0:e.user)||void 0===l?void 0:l.vipActivated)?t((e=>{const t=n.target.value;t?e.systemTTSAccent[r]=t:delete e.systemTTSAccent[r]})):a(!0)}},l.createElement("option",{value:""},"自动"),o.map((e=>l.createElement("option",{key:e,value:e},ze[e]||e)))))}))),l.createElement(i.cw,{className:"inline-form-group-label",label:l.createElement(l.Fragment,null,"选择系统语音",Le),helperText:Object.keys(n.value.voicesGroup).length?"你的浏览器对以上语言支持多个系统语音，你可以选择一个你喜欢的系统语音用来朗读这些语言。":"你的浏览器没有提供多个系统语音，因此无法选择。"},Object.keys(n.value.voicesGroup).map((r=>{var c;const s=n.value.voicesGroup[r];return l.createElement("div",{key:r},ze[r]||r,"：",l.createElement(i.Lu,{value:(null===(c=null==e?void 0:e.user)||void 0===c?void 0:c.vipActivated)?e.systemTTSVoice[r]:r,onChange:n=>{var l;(null===(l=null==e?void 0:e.user)||void 0===l?void 0:l.vipActivated)?t((e=>{const t=n.target.value;t?e.systemTTSVoice[r]=t:delete e.systemTTSVoice[r]})):a(!0)}},l.createElement("option",{value:""},"自动"),s.map((e=>l.createElement("option",{key:e.name,value:e.name},e.name+(e.localService?" - 本地语音":" - 网络语音"))))))}))),l.createElement(i.J2,{interactionKind:"click",content:l.createElement("div",{style:{padding:10,maxHeight:400,overflowY:"auto",overscrollBehavior:"contain"}},l.createElement(i.vl,{bordered:!0,condensed:!0,striped:!0},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null,"语言"),l.createElement("th",null,"系统语音名称"),l.createElement("th",null,"类型"))),l.createElement("tbody",null,n.value.singleList.map((e=>{var t;const a=null===(t=n.value)||void 0===t?void 0:t.singleVoiceMap[e];return l.createElement("tr",{key:e},l.createElement("td",null,ze[e]||e),l.createElement("td",null,null==a?void 0:a.name),l.createElement("td",null,(null==a?void 0:a.localService)?"本地语音":"网络语音"))})))))},l.createElement("a",null,"查看你的浏览器和操作系统支持的其它语音")))),l.createElement(i.Zb,null,l.createElement(i.H4,{id:"音量和语速"},"音量和语速"),l.createElement(i.cw,{label:"音量"},l.createElement(i.iR,{min:0,max:100,stepSize:1,labelStepSize:20,value:e.audioVolume,onChange:e=>{t({audioVolume:e})}})),l.createElement(i.cw,{label:"语速"},l.createElement(i.iR,{min:0,max:4,stepSize:.01,labelStepSize:1,value:e.audioRate,onChange:e=>{t({audioRate:e})}})))):null}var Ue=n(4520),Ve=n(7354);const He=(0,p.Z)(v.q,["contextMenus"]);function Me(){const[e,t]=(0,b.Z)(He);return l.createElement(i.Zb,null,l.createElement(i.H4,null,"右键菜单"),l.createElement(i.cw,{helperText:"你可以移除你不想要的右键菜单。快捷链接的右键菜单请在“翻译面板”内移除。"},l.createElement(Ue.C,{items:Ve.I,selected:e?e.contextMenus:He.contextMenus,onChange:e=>{t({contextMenus:e})}})))}const We=[{label:"显示弹出页面",value:"show-popup"},{label:"开启网页全文翻译",value:"open-webpage-trs"}],je=(0,p.Z)(v.q,["popupAction"]);function $e(){const[e,t]=(0,b.Z)(je);return l.createElement(i.Zb,null,l.createElement(i.H4,null,"扩展按钮"),l.createElement(i.cw,{label:"点击扩展按钮时",inline:!0},l.createElement(i.Ee,{inline:!0,options:We,selectedValue:e?e.popupAction:je.popupAction,onChange:e=>{t({popupAction:e.currentTarget.value})}})))}var Je=n(2054);const Xe={permissions:["background"]};function Ye(){window.alert("Firefox 浏览器不支持此功能。")}const Qe=ge?function(){return{hasBg:!1,requestBg:Ye,removeBg:Je.Z}}:function(){return{hasBg:oe(Xe),requestBg:(0,l.useCallback)((()=>{m().permissions.request(Xe).catch((e=>{alert("开启失败，错误消息："+e.message)}))}),[]),removeBg:(0,l.useCallback)((()=>{m().permissions.remove(Xe).catch((e=>{alert("关闭失败，错误消息："+e.message)}))}),[])}};function Ge(){const{hasBg:e,requestBg:t,removeBg:n}=Qe();return l.createElement(i.XZ,{labelElement:l.createElement(l.Fragment,null,"让划词翻译在后台持续运行"," ",l.createElement(te,null,l.createElement("p",null,"勾选后，划词翻译会在后台静默运行，即使你没有打开、或者关闭了浏览器，划词翻译也能响应【打开独立翻译窗口】的全局快捷键。"),"此选项无法同步到账号内。")),checked:e,onChange:e=>{e.target.checked?t():n()}})}const et=(0,p.Z)(v.q,["googleType","googleRegion"]);function tt(){const[e,t]=(0,b.Z)(et);return l.createElement(l.Fragment,null,l.createElement(i.cw,{inline:!0,style:{marginBottom:0},label:l.createElement(l.Fragment,null,"接口类型"," ",l.createElement(te,{inline:!0},l.createElement(i.UL,null,l.createElement("li",null,"速度快、准确率低：0.1 ~ 0.8 秒就有翻译结果，但是跟",l.createElement("a",{href:"https://translate.google.cn",target:"_blank",rel:"noreferrer noopener"},"谷歌翻译网站"),"的翻译结果可能不一样，特别是专业领域的翻译"),l.createElement("li",null,"速度慢、准确率高：0.8 ~ 1.2 秒才有翻译结果，但是跟",l.createElement("a",{href:"https://translate.google.cn",target:"_blank",rel:"noreferrer noopener"},"谷歌翻译网站"),"的翻译结果一样"))))},l.createElement(i.Ee,{inline:!0,selectedValue:e?e.googleType:et.googleType,onChange:e=>{t({googleType:e.currentTarget.value})}},l.createElement(i.Y8,{label:"速度快、准确率低",value:"fast"}),l.createElement(i.Y8,{label:"速度慢、准确率高",value:"accuracy"}))),l.createElement(i.cw,{label:"地区",inline:!0},l.createElement(i.Ee,{inline:!0,selectedValue:e?e.googleRegion:et.googleRegion,onChange:e=>{t({googleRegion:e.currentTarget.value})}},l.createElement(i.Y8,{label:"国内（.cn）",value:"cn"}),l.createElement(i.Y8,{label:"国外（.com）",value:"com"}))))}const nt=(0,p.Z)(v.q,["pdfAuto","pdfSnifferEnable","notifySyncOptions","customAPI","customAPINames"]);function lt(){const{setShowLogin:e,setShowVip:t,syncOptions:n}=(0,l.useContext)($),a=(0,l.useContext)(k),c=(0,r.s0)(),s=(0,l.useRef)(null),[o,m]=(0,l.useState)("login");return(0,l.useEffect)((()=>{var e;"login"===o&&(null===(e=s.current)||void 0===e||e.focus("user"))}),[o]),l.createElement(i.mQ,{id:"login-or-reg-tabs",large:!0,selectedTabId:o,onChange:m},l.createElement(i.OK,{id:"login",title:"登录",panel:l.createElement(f,{ref:s,openType:"login",onLogin:e=>{a(e),n(e)}})}),l.createElement(i.OK,{id:"reg",title:"注册",panel:l.createElement(l.Fragment,null,"划词翻译无需注册即可免费使用，在",l.createElement("a",{onClick:()=>{e(!1),t(!0)}},"开通会员"),"或",l.createElement("a",{onClick:()=>{e(!1),c("/services?tab=points")}},"购买翻译积分"),"时才能注册账号。")}))}function at(e){const{title:t,children:n}=e;return l.createElement("div",{className:"item-list"},t&&l.createElement(i.H4,null,t),n)}function rt(e){return l.createElement("div",{className:"item-list-item"},l.createElement("div",{className:"item-title"},e.title),l.createElement("div",{className:"item-content"},e.children))}function ct(e){return l.createElement("p",{className:"utils-flex"},l.createElement("span",null,l.createElement("span",null,e.title),e.description&&l.createElement("span",{className:"bp3-text-small bp3-text-muted",style:{display:"block"}},e.description)),l.createElement("span",{className:"bp3-text-muted"},e.children))}function it(e){const{user:t,onVip:n}=e,a=O(e.user);return l.createElement(ct,{title:"会员到期时间"},t.forever&&l.createElement(l.Fragment,null,"永不过期"),!a.isOpened&&l.createElement(l.Fragment,null,"未开通"),!t.forever&&t.vipActivated&&a.endTime,a.isOpened&&!t.vipActivated&&l.createElement(l.Fragment,null,a.endTime,"（已过期）"),l.createElement(i.zx,{style:{marginLeft:15},disabled:t.forever,icon:"crown",text:a.text,onClick:n}))}const st=(0,p.Z)(v.d,["optionsSyncAt"]);function ot(){const{setShowVip:e,syncOptions:t}=(0,l.useContext)($),n=(0,l.useContext)(y),a=(0,l.useContext)(k),[c]=(0,b.Z)(st),s=(0,r.s0)(),[o,p]=(0,d.Z)((async()=>{await u.L.post("/logout"),a(null),m().storage.local.remove(["optionsSyncAt","favoritesSyncAt","historiesSyncAt"])}),[]);return(0,l.useEffect)((()=>{u.L.get("/user-info").then((e=>{a(e.data)}))}),[a]),n?l.createElement(at,{title:"个人中心"},l.createElement(rt,{title:"个人信息"},l.createElement(ct,{title:"账号"},n.email,l.createElement(i.zx,{style:{marginLeft:15},icon:"log-out",loading:o.loading,text:"退出登录",onClick:p})),l.createElement(it,{user:n,onVip:()=>{e(!0)}}),l.createElement(ct,{title:"翻译积分",description:l.createElement(l.Fragment,null,"用于支付使用第三方服务时产生的费用。",l.createElement("a",{target:"_blank",href:"https://hcfy.app/docs/services/tp",rel:"noreferrer"},"了解更多"))},n.points||0,l.createElement(i.zx,{style:{marginLeft:15},icon:"blank",text:"购买积分",onClick:()=>{s("/services?tab=points")}})),l.createElement(ct,{title:"上次同步设置的时间"},c?c.optionsSyncAt?(0,P.Z)(new Date(c.optionsSyncAt),"yyyy 年 M 月 d 日 HH:mm:ss"):"未同步过设置":null,l.createElement(i.zx,{style:{marginLeft:15},icon:"refresh",text:"立即同步",onClick:()=>{t(n)}})))):null}function mt(){const[e,t]=(0,l.useState)(!1);return l.createElement(l.Fragment,null,l.createElement("a",{onClick:()=>{t(!0)}},"查看范例"),l.createElement(i.Vq,{isOpen:e,onClose:()=>{t(!1)},title:"范例",className:"example-dialog"},l.createElement("div",{className:"bp3-dialog-body"},l.createElement(i.vl,{bordered:!0,condensed:!0,striped:!0},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null,"规则"),l.createElement("th",null,"匹配的网址"),l.createElement("th",null,"不匹配的网址"))),l.createElement("tbody",null,l.createElement("tr",null,l.createElement("td",null,l.createElement("p",null,"*/*"),l.createElement("p",null,"匹配任意网址。")),l.createElement("td",null,l.createElement("p",null,"limingkai.cn"),l.createElement("p",null,"hcfy.limingkai.cn"),l.createElement("p",null,"baidu.com/search"),l.createElement("p",null,"jd.com/item.html")),l.createElement("td",null,l.createElement("p",null,"没有不匹配的网址"))),l.createElement("tr",null,l.createElement("td",null,l.createElement("p",null,"*.limingkai.cn/*"),l.createElement("p",null,"匹配 ",l.createElement(i.EK,null,"limingkai.cn")," 或者所有域名以"," ",l.createElement(i.EK,null,".limingkai.cn")," 结尾的网址，网址可以有任意路径。")),l.createElement("td",null,l.createElement("p",null,"limingkai.cn"),l.createElement("p",null,"hcfy.limingkai.cn"),l.createElement("p",null,"hcfy.limingkai.cn/path"),l.createElement("p",null,"aaa.hcfy.limingkai.cn")),l.createElement("td",null,l.createElement("p",null,"limingkai.org ",l.createElement(i.Vp,null,"域名不匹配")),l.createElement("p",null,"baidu.com ",l.createElement(i.Vp,null,"域名不匹配")))),l.createElement("tr",null,l.createElement("td",null,l.createElement("p",null,"limingkai.cn/*"),l.createElement("p",null,"匹配域名是 ",l.createElement(i.EK,null,"limingkai.cn")," 的所有网址。")),l.createElement("td",null,l.createElement("p",null,"limingkai.cn"),l.createElement("p",null,"limingkai.cn/path")),l.createElement("td",null,l.createElement("p",null,"hcfy.limingkai.cn ",l.createElement(i.Vp,null,"域名不匹配")))),l.createElement("tr",null,l.createElement("td",null,l.createElement("p",null,"limingkai.cn/"),l.createElement("p",null,"仅匹配 ",l.createElement(i.EK,null,"limingkai.cn")," 这一个网址。")),l.createElement("td",null,l.createElement("p",null,"limingkai.cn")),l.createElement("td",null,l.createElement("p",null,"hcfy.limingkai.cn ",l.createElement(i.Vp,null,"域名不匹配")),l.createElement("p",null,"limingkai.cn/path ",l.createElement(i.Vp,null,"路径不匹配")))),l.createElement("tr",null,l.createElement("td",null,l.createElement("p",null,"*/path"),l.createElement("p",null,"匹配任意域名的网址，但路径部分只能是 ",l.createElement(i.EK,null,"path"),"。")),l.createElement("td",null,l.createElement("p",null,"hcfy.limingkai.cn/path"),l.createElement("p",null,"baidu.com/path")),l.createElement("td",null,l.createElement("p",null,"hcfy.limingkai.cn/a ",l.createElement(i.Vp,null,"路径不匹配")))),l.createElement("tr",null,l.createElement("td",null,l.createElement("p",null,"*/path/"),l.createElement("p",null,"匹配任意域名，但路径部分只能是 ",l.createElement(i.EK,null,"path/"),"。跟上个例子相比，路径末尾多了一个 ",l.createElement(i.EK,null,"/"),"。")),l.createElement("td",null,l.createElement("p",null,"hcfy.limingkai.cn/path/"),l.createElement("p",null,"baidu.com/path/")),l.createElement("td",null,l.createElement("p",null,"hcfy.limingkai.cn/path ",l.createElement(i.Vp,null,"路径不匹配")),l.createElement("p",null,"hcfy.limingkai.cn/path/a ",l.createElement(i.Vp,null,"路径不匹配")))),l.createElement("tr",null,l.createElement("td",null,l.createElement("p",null,"hcfy.limingkai.cn/*path*"),l.createElement("p",null,"匹配 ",l.createElement(i.EK,null,"hcfy.limingkai.cn")," 域名且路径中包含"," ",l.createElement(i.EK,null,"path")," 的网址。")),l.createElement("td",null,l.createElement("p",null,"hcfy.limingkai.cn/path"),l.createElement("p",null,"hcfy.limingkai.cn/abcpath"),l.createElement("p",null,"hcfy.limingkai.cn/abc/path"),l.createElement("p",null,"hcfy.limingkai.cn/abc/pathdef"),l.createElement("p",null,"hcfy.limingkai.cn/abc/path/def")),l.createElement("td",null,l.createElement("p",null,"hcfy.limingkai.cn/paXth ",l.createElement(i.Vp,null,"路径不匹配")),l.createElement("p",null,"hcfy.limingkai.cn/pa/th ",l.createElement(i.Vp,null,"路径不匹配")))),l.createElement("tr",null,l.createElement("td",null,l.createElement("p",null,"limingkai.cn/*/path/*/"),l.createElement("p",null,"匹配 ",l.createElement(i.EK,null,"limingkai.cn")," 域名且路径中包含"," ",l.createElement(i.EK,null,"path"),"、",l.createElement(i.EK,null,"path")," 左右有路径片段且以"," ",l.createElement(i.EK,null,"/")," 结尾的网址。")),l.createElement("td",null,l.createElement("p",null,"limingkai.cn/a/path/b/"),l.createElement("p",null,"limingkai.cn/a/b/path/c/d/")),l.createElement("td",null,l.createElement("p",null,"limingkai.cn/path/"," ",l.createElement(i.Vp,null,l.createElement(i.EK,null,"path")," 左右两边没有路径片段")),l.createElement("p",null,"limingkai.cn/a/path/"," ",l.createElement(i.Vp,null,l.createElement(i.EK,null,"path")," 右边没有路径片段")),l.createElement("p",null,"limingkai.cn/path/b/"," ",l.createElement(i.Vp,null,l.createElement(i.EK,null,"path")," 左边没有路径片段")))))))))}function ut(e){return`${e.host}${e.path}`}function dt(e){const t=e.match(/^(([^:]+):\/\/)?([^/]+)?(\/.*)?$/);if(!t)return;let n=t[3]||"";const l=n.indexOf(":");l>=0&&(n=n.slice(0,l));let a=t[4]||"";const r=a.indexOf("#");if(r>=0&&(a=a.slice(0,r)),!n.startsWith(".")){if(!a){if(!n)return;a="/"}return{host:n,path:a}}}function pt(e,t){return new RegExp("^"+e.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&").replace("*",".*").replace(/^\.\*\\\./,"(.*\\.)?")+"$").test(t)}function Et(e,t){return new RegExp("^"+e.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&").replace(/\*/g,".*")+"$").test(t)}function ht(e,t,n){let l,a;l="string"==typeof e?dt(e):e;let r=!1,c=!1;if(l){const e=e=>{const t=function(e,t){let n;if(n="string"==typeof t?dt(t):t,n)return pt(e.host,n.host)&&Et(e.path,n.path)}(e,l);return t&&(a=e),t};r=n.some(e),r||(c=t.some(e))}return{urlParts:l,matchedRule:a,whiteListMatched:r,blackListMatched:c}}const gt={host:"",path:"/*"};function ft(e,t){switch(t.type){case"reset":return gt;case"merge":return{...e,...t.data};default:throw new TypeError("不支持的 action type: "+JSON.stringify(t))}}function vt(e){const{isOpen:t,setIsOpen:n,onSave:a,isExists:r,name:c}=e,[s,o]=(0,l.useState)(!1),m=(0,l.useRef)(null),u=()=>{n(!1),p({type:"reset"}),f("")},[d,p]=(0,l.useReducer)(ft,gt),E=function(e){const t=e.host;return!!t&&("*"===t||!t.includes("*")||/^\*\.[^*]+$/.test(t))}(d),h=e=>{var t;const n=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text");if(n){const t=dt(n);t&&(e.preventDefault(),p({type:"merge",data:t}))}},[g,f]=(0,l.useState)(""),v=E&&function(e,t){let n;if(n="string"==typeof t?dt(t):t,n)return{isHostMatch:{ruleHost:e.host,urlHost:n.host,matches:pt(e.host,n.host)},isPathMatch:{rulePath:e.path,urlPath:n.path,matches:Et(e.path,n.path)}}}(d,g),b=void 0!==v,y=v&&v.isHostMatch.matches&&v.isPathMatch.matches;return l.createElement(i.Vq,{canEscapeKeyClose:!1,canOutsideClickClose:!1,isOpen:t,onClose:u,onOpening:()=>{var e;null===(e=m.current)||void 0===e||e.focus()},title:"新增"+c+"规则",className:"edit-rule-dialog"},l.createElement("div",{className:"bp3-dialog-body"},l.createElement(i.cw,{label:"规则的格式"},l.createElement("div",{className:"bp3-form-helper-text"},"规则由“网站”和“页面”两个部分组成，在这两个部分中都可以使用通配符"," ",l.createElement(i.EK,null,"*"),"。",l.createElement(i.UL,null,l.createElement("li",null,"在“网站”中：",l.createElement(i.UL,null,l.createElement("li",null,"可以有一个或 0 个通配符。如果有，则必须以通配符开头；"),l.createElement("li",null,"如果只填写了通配符，则表示匹配所有域名；"),l.createElement("li",null,"如果填写了以 ",l.createElement(i.EK,null,"*.")," ","开头的域名，则表示匹配所有以这个域名结尾的域名；"),l.createElement("li",null,"你也可以不使用通配符来匹配单一的域名。"))),l.createElement("li",null,"在“页面”中：",l.createElement(i.UL,null,l.createElement("li",null,"可以使用任意多个通配符，每个通配符表示匹配 0 个或多个任意字符；"),l.createElement("li",null,"页面必须以 ",l.createElement(i.EK,null,"/")," 开头；"),l.createElement("li",null,"页面部分默认填写了 ",l.createElement(i.EK,null,"/*"),"，表示匹配任意页面。")))),l.createElement(mt,null))),l.createElement(i.H5,null,"填写规则"),l.createElement(i.cw,null,l.createElement(i.eQ,null,l.createElement(i.BZ,{placeholder:"域名",value:d.host,inputRef:m,onChange:e=>{p({type:"merge",data:{host:e.target.value.trim()}})},onPaste:h}),l.createElement(i.BZ,{placeholder:"路径",value:d.path,onChange:e=>{let t=e.target.value.trim();"/"!==t[0]&&(t="/"+t),p({type:"merge",data:{path:t}})},onPaste:h})),d.host&&!E&&l.createElement(i.UW,{icon:null,intent:"warning"},"域名格式不正确")),l.createElement(i.H5,null,"测试"," ",E&&l.createElement(i.EK,{style:{fontWeight:"normal"}},ut(d))),l.createElement(i.cw,null,l.createElement(i.BZ,{value:g,onChange:e=>{f(e.target.value.trim())},placeholder:"你可以填写一个网址来测试是否跟规则匹配"}),g&&!b&&l.createElement(i.UW,{icon:null,intent:"warning"},"网址格式不正确"),v&&b&&y&&l.createElement(i.UW,{title:"匹配"}),v&&b&&!y&&l.createElement(i.UW,{title:"不匹配"},v.isHostMatch.matches||l.createElement("p",null,"网址的域名 ",l.createElement(i.EK,null,v.isHostMatch.urlHost)," ","不匹配规则 ",l.createElement(i.EK,null,v.isHostMatch.ruleHost)),v.isPathMatch.matches||l.createElement("p",null,"网址的路径 ",l.createElement(i.EK,null,v.isPathMatch.urlPath)," ","不匹配规则 ",l.createElement(i.EK,null,v.isPathMatch.rulePath))))),l.createElement("div",{className:"bp3-dialog-footer"},l.createElement("div",{className:"bp3-dialog-footer-actions"},l.createElement(i.zx,{onClick:u},"取消"),l.createElement(i.zx,{intent:"primary",onClick:()=>{var e;E?r(d)?o(!0):(a(d),u()):null===(e=m.current)||void 0===e||e.focus()}},"保存"),l.createElement(i.bZ,{confirmButtonText:"我知道了",isOpen:s,onConfirm:()=>{o(!1)}},"规则 ",l.createElement(i.EK,null,ut(d))," 已经有了，无需重复添加。"))))}function bt(e){const{rules:t,setRules:n,name:a,disabled:r}=e,[c,s]=(0,l.useState)(!1),o=(0,l.useRef)();const[m,u]=(0,l.useState)(!1),d=()=>{u(!1),o.current=void 0};return l.createElement("div",{className:"domain-rules"},l.createElement("div",{className:"header"},l.createElement(i.H6,null,a),l.createElement(i.zx,{disabled:r,icon:"add",onClick:()=>{s(!0)},minimal:!0})),l.createElement("div",{className:"table-box"},l.createElement(i.vl,{bordered:!0,striped:!0,condensed:!0},l.createElement("tbody",null,t.length?t.map((e=>{const t=ut(e);return l.createElement("tr",{key:t},l.createElement("td",null,t),l.createElement("td",null,l.createElement(i.zx,{disabled:r,minimal:!0,icon:"delete",onClick:()=>function(e){o.current=e,u(!0)}(e)})))})):l.createElement("tr",null,l.createElement("td",{colSpan:2},l.createElement(i.tR,{title:"没有规则",description:"黑名单"===a?l.createElement(l.Fragment,null,"命中黑名单的网址会禁用网页划词"):l.createElement(l.Fragment,null,"命中白名单的网址会始终启用网页划词"),action:l.createElement(i.zx,{disabled:r,onClick:()=>{s(!0)},intent:"primary"},"添加一条规则")})))))),l.createElement(i.bZ,{icon:"trash",intent:"danger",isOpen:m,confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:()=>{if(o.current){const e=t.indexOf(o.current);if(e>=0){const l=[...t];l.splice(e,1),n(l)}}d()},onCancel:d},"确定要从",a,"中删除"," ",l.createElement(i.EK,null,o.current?ut(o.current):"这条规则")," ","吗？"),l.createElement(vt,{isOpen:c,setIsOpen:s,onSave:e=>{const l=[...t];l.push(e),n(l)},isExists:e=>t.some((t=>V()(t,e))),name:a}))}var yt=n(8172);function kt(){const e=(0,r.s0)();return l.createElement(i.u,{interactionKind:"hover",hoverCloseDelay:300,content:l.createElement(l.Fragment,null,"此选项支持",l.createElement("a",{onClick:()=>e("/#快捷键")},"快捷键"),"。")},l.createElement(i.Vp,{style:{fontWeight:"normal"},minimal:!0},"快捷键"))}const wt=(0,p.Z)(v.q,["charsLimit"]);function xt(){const[e,t]=(0,b.Z)(wt);return l.createElement(i.cw,{label:"限制字符数量",helperText:"如果划选的文本字符数超过这个数量则不会显示翻译按钮或翻译结果。设置为 0 则不做限制。"},l.createElement(i.Af,{min:0,minorStepSize:1,stepSize:10,majorStepSize:100,selectAllOnFocus:!0,selectAllOnIncrement:!0,value:e?e.charsLimit:wt.charsLimit,onValueChange:e=>{t({charsLimit:e})}}))}const Ct=(0,p.Z)(v.q,["button","buttonAutoClose","buttonOffsetTop","buttonOffsetLeft","disableInTextarea","domainBlackList","domainWhiteList","textList","pin","pinPos","pinIgnoreDomainList","modifierKeys","modifierKeyPressedAction","modifierKeyTranslate","modifierKeyLink"]),St={host:"*",path:"/*"};var Tt=n(2610);const Lt=(0,p.Z)(v.q,["pageTrsHighlight","pageTrsApiOptions","pageTrsEditable"]);function Zt(){const e=(0,S.Z)((()=>m().extension.isAllowedIncognitoAccess()),[]);return e.loading||!e.value||e.error?null:l.createElement(i.UW,{icon:"info-sign",title:"无痕模式下的限制"},l.createElement("p",null,"由于浏览器自身的安全限制，内置 PDF 阅读器无法在无痕窗口中使用，所以当你在无痕窗口中打开内置 PDF 阅读器时，划词翻译会自动改为在普通窗口中打开。"))}const At=(0,p.Z)(v.q,["pdfStandalone"]);function Nt(){const[e,t]=(0,b.Z)(At);return l.createElement(i.cw,{helperText:"默认情况下，划词翻译会在新标签页中打开内置 PDF 阅读器，勾选此选项后则会在一个单独的窗口中打开，此窗口是类似于独立翻译窗口那种没有工具栏的窗口。"},l.createElement(i.XZ,{inline:!0,label:"在单独的窗口中打开",checked:e?e.pdfStandalone:At.pdfStandalone,onChange:e=>{t({pdfStandalone:e.target.checked})}}))}const Rt=(0,p.Z)(v.q,["pdfAuto","pdfSnifferEnable"]);function Pt(e){const{service:t}=e,[n,a]=(0,l.useState)(!1),[r,c]=(0,l.useState)(!0);if((0,l.useEffect)((()=>{t.pointsEnable&&(a(!0),t.pointsEnable.get().then((e=>{a(!1),c(e)})))}),[t]),!t.points)return l.createElement("div",null,t.name,"暂不支持通过翻译积分使用。");const s=!t.secretKeys&&!t.free;return l.createElement("div",null,l.createElement("p",null,t.name,"支持购买翻译积分直接使用。",l.createElement("a",{href:"https://hcfy.app/docs/services/tp#detail-prices",target:"_blank",rel:"noreferrer"},"查看价格")),l.createElement(i.u,{interactionKind:"hover-target",lazy:!0,content:l.createElement("div",{style:{width:250}},s?`${t.name}只能通过翻译积分使用，无法停用。`:r?l.createElement(l.Fragment,null,l.createElement("b",null,"停用后"),"，当你未配置密钥、或密钥免费额度用完后，划词翻译",l.createElement("b",null,"不会"),"自动消耗翻译积分使用",t.name,"。"):l.createElement(l.Fragment,null,l.createElement("b",null,"启用后"),"，当你未配置密钥、或密钥免费额度用完后，划词翻译",l.createElement("b",null,"会"),"自动消耗翻译积分使用",t.name,"。"))},l.createElement(i.AN,{loading:n,disabled:s,text:r?"停用":"启用",onClick:()=>{t.pointsEnable?(a(!0),t.pointsEnable.set(!r).then((()=>{c(!r),a(!1)}))):alert(`划词翻译内部错误：未给${t.name}声明启用 / 停用翻译积分的方法。`)}})))}function Ot(e){const{secretKeys:t,onChange:n,info:a}=e;if(!a)return l.createElement("div",null,"此服务暂不支持自行申请密钥使用。");const r=!!a.idLabel,c=!!a.deeplProLabel,s=3+(r?1:0)+(c?1:0);return l.createElement(l.Fragment,null,l.createElement("div",{style:{textAlign:"right"}},l.createElement(i.zx,{icon:"add",intent:"primary",text:"添加密钥",onClick:()=>{n((0,yt.ZP)(t,(e=>{const t={key:""};r&&(t.id=""),c&&(t.deeplPro=!1),e.push(t)})))}})),l.createElement(i.vl,{condensed:!0,bordered:!0,striped:!0,style:{width:"100%"}},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null),r&&l.createElement("th",null,a.idLabel),l.createElement("th",null,a.keyLabel),c&&l.createElement("th",null,a.deeplProLabel),l.createElement("th",null))),l.createElement("tbody",null,!t.length&&l.createElement("tr",null,l.createElement("td",{colSpan:s,style:{textAlign:"center"}},"未配置过密钥")),t.map(((e,a)=>l.createElement("tr",{key:a},l.createElement("td",null,a+1),r&&l.createElement("td",null,l.createElement(i.BZ,{value:e.id,onChange:e=>{const l=e.target.value;n((0,yt.ZP)(t,(e=>{e[a].id=l})))}})),l.createElement("td",null,l.createElement(E,{value:e.key,onChange:e=>{const l=e.target.value;n((0,yt.ZP)(t,(e=>{e[a].key=l})))}})),c&&l.createElement("td",null,l.createElement(i.Ee,{onChange:e=>{const l=e.target.value;n((0,yt.ZP)(t,(e=>{e[a].deeplPro="Pro"===l})))},selectedValue:e.deeplPro?"Pro":"Free"},l.createElement(i.Y8,{label:"Free",value:"Free"}),l.createElement(i.Y8,{label:"Pro",value:"Pro"}))),l.createElement("td",null,l.createElement(i.zx,{icon:"delete",onClick:()=>{n((0,yt.ZP)(t,(e=>{e.splice(a,1)})))}}))))))))}const Ft={DeepLWeb:{keyDocLink:"https://hcfy.app/docs/services/deepl",keyLabel:"Authentication Key",deeplProLabel:"接口类型"},YouDaoWeb:{keyDocLink:"https://hcfy.app/docs/services/youdao-api",idLabel:"应用 ID",keyLabel:"应用密钥"},QQOfficial:{keyDocLink:"https://hcfy.app/docs/services/qq-api",idLabel:"SecretId",keyLabel:"SecretKey"},BaiDuWeb:{keyDocLink:"https://hcfy.app/docs/services/baidu-api",idLabel:"APP ID",keyLabel:"密钥"},BaiDuDomain:{keyDocLink:"https://hcfy.app/docs/services/baidu-pro-api",idLabel:"APP ID",keyLabel:"密钥"},ALiOfficial:{keyDocLink:"https://hcfy.app/docs/services/ali-api",idLabel:"AccessKey ID",keyLabel:"AccessKey Secret"},ALiOfficialDomain:{keyDocLink:"https://hcfy.app/docs/services/ali-pro-api",idLabel:"AccessKey ID",keyLabel:"AccessKey Secret"},CaiYunOfficial:{keyDocLink:"https://hcfy.app/docs/services/caiyun-api",keyLabel:"Token"},bdocr:{keyDocLink:"https://hcfy.app/docs/services/baidu-ocr",idLabel:"API Key",keyLabel:"Secret Key"}};function Dt(e){const{service:t,summary:n}=e,[a,r]=(0,l.useState)(!1),[c,s]=(0,l.useState)([]),o=Ft[t.id];if((0,l.useEffect)((()=>{t.secretKeys&&t.secretKeys.get().then(s)}),[t]),!t.secretKeys)return l.createElement("div",null,t.name,"暂不支持自行申请密钥使用。");const m=c.filter(t.secretKeys.isComplete).length;return l.createElement("div",null,l.createElement("p",null,m?l.createElement(l.Fragment,null,"已配置了"," ",l.createElement(i.Vp,{round:!0,style:{fontSize:12}},m)," ","个密钥。"):"未配置密钥。",n,(null==o?void 0:o.keyDocLink)&&l.createElement("a",{href:o.keyDocLink,target:"_blank",rel:"noreferrer"},"查看申请步骤")),l.createElement(i.zx,{onClick:()=>{"ALiOfficialDomain"!==t.id?"BaiDuDomain"!==t.id?r(!0):window.alert("百度翻译（专业版）与百度翻译的密钥是共用的，你只需要管理百度翻译的密钥即可。"):window.alert("阿里翻译（专业版）与阿里翻译的密钥是共用的，你只需要管理阿里翻译的密钥即可。")}},"管理密钥"),l.createElement(i.Vq,{title:`管理${t.name}的密钥`,isOpen:a,onClose:()=>{r(!1)}},l.createElement("div",{className:"bp3-dialog-body"},l.createElement(Ot,{info:o,secretKeys:c,onChange:e=>{s(e),t.secretKeys?t.secretKeys.set(e):window.alert(`划词翻译内部错误：${t.name}不支持通过密钥使用，却给用户显示了填写密钥的弹窗。`)}}))))}function Kt(e){const{service:t,onClick:n,active:a,summary:r,secretKeySummary:c}=e,[s,o]=(0,l.useState)("secretKey");return(0,l.useEffect)((()=>{t.secretKeys||(t.points?o("points"):t.free&&o("free"))}),[t]),l.createElement(i.Zb,{className:a?"active":void 0},l.createElement("div",{className:"utils-flex",style:{marginBottom:10}},l.createElement(i.H4,{style:{marginBottom:0}},t.name),n&&(a?l.createElement(i.Vp,null,"已选择此服务"):l.createElement(i.zx,{small:!0,onClick:n,text:"选择此服务"}))),r&&l.createElement("div",{className:"bp3-text-muted"},r),"tesseractocr"!==t.id&&(t.secretKeys||t.points||t.free)&&l.createElement(i.mQ,{id:t.id,selectedTabId:s,onChange:e=>o(e)},l.createElement(i.OK,{id:"secretKey",title:"免费申请",panel:l.createElement(Dt,{service:t,summary:c})}),l.createElement(i.OK,{id:"points",title:"翻译积分",panel:l.createElement(Pt,{service:t})}),t.free&&l.createElement(i.OK,{id:"free",title:"免费试用",panel:l.createElement("div",null,t.name,"支持",l.createElement("a",{href:"https://hcfy.app/docs/services/free/",target:"_blank",rel:"noreferrer"},"免费试用"),"。")})))}function It(e){const{name:t,description:n,services:a,summaryMap:r,selectedStorageKey:c}=e,s=(0,l.useMemo)((()=>{if(c)return{[c]:v.q[c]}}),[c]),[o,m]=(0,b.Z)(s),u=c?null==o?void 0:o[c]:void 0,d=(0,l.useCallback)((e=>{c&&m({[c]:e})}),[c,m]);return l.createElement("div",null,l.createElement(i.H2,null,t),n&&l.createElement("p",null,n),l.createElement("div",{className:"services-box"},a.map((e=>{const t=e.id;return l.createElement(Kt,{key:t,service:e,summary:r.common[t],secretKeySummary:r.secretKey[t],active:u?u===t:void 0,onClick:c?()=>{d(t)}:void 0})}))))}var zt=n(1354),Bt=n(9697);const _t=["baiDuAppKey","baiDuOCRKey","youDaoAppKey","aLiApiKey","qqApiKey","cyApiToken","deeplKey"],qt="3ehd39ehd";function Ut(e){return"string"==typeof e?!e:"secret"in e?!e.secret&&!e.key:null==e.id?!e.key:!e.key&&!e.id}async function Vt(){const e=await m().storage.local.get(_t);if(t=e,Object.keys(t).every((e=>{const n=t[e];return(Array.isArray(n)?n:[n]).every(Ut)})))throw new Error("未配置过服务，无需导出。");var t;const n=JSON.stringify(e);if(!await m().runtime.sendMessage({action:"write to clipboard",text:zt.AES.encrypt(n,qt).toString()}))throw new Error("复制进剪切板失败。")}const Ht=i.x7.create(),Mt=()=>{Vt().then((()=>{Ht.show({intent:"success",message:"已将配置信息复制进剪切板。"})}),(e=>{Ht.show({intent:"warning",message:e.message})}))};function Wt(e){const{onImported:t}=e,[n,a]=(0,l.useState)(!1),[r,c]=(0,l.useState)(""),[s,o]=(0,l.useState)((()=>!!localStorage.getItem("exportkeystip"))),[u,d]=(0,l.useState)(!1);return l.createElement(l.Fragment,null,l.createElement(i.zx,{icon:"export",onClick:()=>{s?Mt():d(!0)},style:{marginRight:10}},"导出"),l.createElement(i.bZ,{intent:"primary",confirmButtonText:"继续",isOpen:u,onConfirm:()=>{o(!0),localStorage.setItem("exportkeystip","1"),d(!1),Mt()}},l.createElement("p",null,"你可以将你的服务配置导出并导入进另一个浏览器的划词翻译里，",l.createElement("b",null,"请不要将配置信息发送给其他人！")),l.createElement("p",null,"另外，",l.createElement("b",null,"不要将划词翻译 v8.7.0 及以上版本的配置导入到低于 v8.7.0 版本的划词翻译当中。"))),l.createElement(i.zx,{icon:"import",onClick:()=>{a(!0)}},"导入"),l.createElement(i.Vq,{title:"导入服务配置",isOpen:n,onClose:()=>{a(!1)},onClosed:()=>{c("")}},l.createElement("form",{onSubmit:e=>{e.preventDefault(),async function(e){const t=zt.AES.decrypt(e,qt).toString(zt.enc.Utf8);let n;try{n=(0,p.Z)(JSON.parse(t),_t)}catch(e){throw new Error("配置信息有误，无法导入。Code 1")}if((0,Bt.Z)(n))throw new Error("配置信息有误，无法导入。Code 2");await m().storage.local.set(n)}(r).then((()=>{Ht.show({intent:"success",message:"导入成功。"}),a(!1),null==t||t()}),(e=>{Ht.show({intent:"danger",message:e.message})}))}},l.createElement("div",{className:"bp3-dialog-body"},l.createElement(i.Kx,{placeholder:"请将配置信息粘贴到这里。",fill:!0,required:!0,value:r,onChange:e=>{c(e.target.value)},autoFocus:!0})),l.createElement("div",{className:"bp3-dialog-footer"},l.createElement("div",{className:"bp3-dialog-footer-actions"},l.createElement(i.zx,{intent:"primary",type:"submit",text:"导入"}))))))}var jt=n(9784),$t=n(4185),Jt=n(9966),Xt=n(7320),Yt=n(124);const Qt={workerPath:"worker.min.js",corePath:"tesseract-core.wasm.js",langPath:"https://tessdata.projectnaptha.com/4.0.0_best",workerBlobURL:!1},Gt={id:"tesseractocr",name:"Tesseract OCR",free:!0};class en extends Yt.E{constructor(){super(Gt)}async callByFree(e){const t=(0,Xt.createWorker)(Qt);await t.load(),await t.loadLanguage(e.lang),await t.initialize(e.lang),await t.setParameters({tessjs_create_hocr:"0",tessjs_create_tsv:"0",preserve_interword_spaces:"1"});const n=await t.recognize(e.image);return t.terminate(),n.data}transform(e){return e.paragraphs.map((e=>e.text.trim().replace(/\r?\n/g," "))).join("\n")}}new en;const tn=[Gt,Jt.FC],nn=(0,p.Z)(v.d,["tipForServicesUpdateClosed"]);function ln(){const[e,t]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{m().storage.local.get(nn).then((({tipForServicesUpdateClosed:e})=>{e||t(!0)}))}),[]),l.createElement(i.Vq,{title:"从 v8.7.0 起，划词翻译对第三方服务做了一些改进",isOpen:e,canEscapeKeyClose:!1,canOutsideClickClose:!1,isCloseButtonShown:!1},l.createElement("div",{className:"bp3-dialog-body"},l.createElement(i.UL,null,l.createElement("li",null,"现已支持填写多组密钥。"),l.createElement("li",null,l.createElement("p",null,"当一个服务的所有密钥都报错之后（例如密钥填写有误、免费额度用完了等错误），划词翻译会自动消耗翻译积分使用此服务。如果你不希望这样，你可以停用某个服务的翻译积分。"),l.createElement("div",{className:"bp3-text-muted"},"每个服务的翻译积分都是默认启用的，但如果你在上个版本中给某个服务填写过密钥，那么划词翻译会停用此服务的翻译积分，避免在你不知情的情况下消耗你的积分。你可以给这些服务重新启用翻译积分。")))),l.createElement("div",{className:"bp3-dialog-footer"},l.createElement("div",{className:"bp3-dialog-footer-actions"},l.createElement(i.zx,{intent:"primary",onClick:()=>{t(!1),m().storage.local.set({tipForServicesUpdateClosed:!0})}},"我知道了"))))}const an={BaiDuDomain:l.createElement("p",null,"支持五个专业领域：网络文学、金融财经、科技电子、水利机械、生物医药。"),BingDictWeb:l.createElement("p",null,"仅有词典，无法用于翻译句子。"),ALiOfficialDomain:l.createElement("p",null,"支持六个专业领域：电商 - 商品标题、电商 - 商品详情、电商 - 买卖家沟通、医疗、社交、金融。"),YouDaoWeb:l.createElement("p",null,"支持中文词组翻译为英语词组（带拼音）；支持英语词典（带音标）。"),SoGouOfficial:l.createElement("p",null,"搜狗翻译已下线。",l.createElement("a",{href:"https://hcfy.app/blog/2021/11/23/sougou-off",target:"_blank",rel:"noreferrer"},"查看公告")),tesseractocr:l.createElement(l.Fragment,null,l.createElement("p",null,l.createElement("a",{href:"https://github.com/tesseract-ocr/tesseract#readme",target:"_blank",rel:"noreferrer"},"Tesseract OCR")," ","无需翻译积分或密钥即可免费使用，但是："),l.createElement(i.UL,null,l.createElement("li",null,"识别时间较长，大约需要 2 ~ 8 秒。"),l.createElement("li",null,"准确率相对较低。"),l.createElement("li",null,"不能自动判断图片里的语种，识别前需要手动指定。"),l.createElement("li",null,"会占用一定的系统资源，偶尔会导致电脑卡顿。"))),bdocr:l.createElement(i.UL,null,l.createElement("li",null,"识别时间只需 1 秒不到。"),l.createElement("li",null,"准确率高。"),l.createElement("li",null,"能自动判断图片里的语种，无需手动指定。"),l.createElement("li",null,"不占用系统资源。")),"default-speech":l.createElement(l.Fragment,null,l.createElement("p",null,"划词翻译内置的语音转文字服务无需翻译积分或密钥即可免费使用，但是："),l.createElement(i.UL,null,l.createElement("li",null,"需要能连接外网才能使用。"),l.createElement("li",null,"只能通过麦克风使用，不能用于音视频翻译功能。"),l.createElement("li",null,"不支持 Firefox 浏览器。"))),TencentRealtime:l.createElement(i.UL,null,l.createElement("li",null,"无需连接外网即可使用。"),l.createElement("li",null,"既可以通过麦克风使用，也可以用于音视频翻译功能。"),l.createElement("li",null,"支持 Firefox 浏览器。"))};var rn=n(9520);class cn extends rn.ZP{constructor(){super("hcfy"),this.version(3).stores({historyRecords:"id,date,_id,syncStatus",favorites:"id,date,text,_id,syncStatus"}),this.historyRecords=this.table("historyRecords"),this.favorites=this.table("favorites")}}const sn=new cn;var on=n(6749);const mn=(e,t)=>{e._id?(e.deleted=!0,e.syncStatus=un.Pending):delete t.value};var un;!function(e){e.Pending="Pending"}(un||(un={}));class dn{constructor(e,t,n,l,a,r,c,i){this.table=e,this.syncKeys=t.concat("date"),this.getDataFromServer=n,this.syncTimeStorageKey=l,this.deleteData=a,this.commitChanges=r,this.pullChanges=c,this.deleteLogsFn=i}async add(e,t){const n={...e},l=Date.now();n.id=(0,on.Z)(l+"-"),n.date=l,n.syncStatus=un.Pending,await this.table.add(n),t&&this.commit().catch(Je.Z)}async deleteById(e,t){await this.table.where("id").anyOf(e).modify(mn),t&&this.commit().catch(Je.Z)}async deleteAll(e){let t;e&&(t=await this.deleteData()),await this.table.clear(),t&&await this.setSyncTime(t)}async deleteByKey(e,t,n){await this.table.where(e).equalsIgnoreCase(t).modify(mn),n&&this.commit().catch(Je.Z)}async hasByKey(e,t){return await this.table.where(e).equalsIgnoreCase(t).and((e=>!e.deleted)).count()>0}query(e,t,n){const l=t?this.table.where("date").below(t).reverse():this.table.orderBy("date").reverse();return l.filter(n?e=>!e.deleted&&n(e):e=>!e.deleted),l.limit(e).toArray()}async getSyncChanges(){const e=await this.table.where("syncStatus").equals(un.Pending).toArray(),t=[],n=[],l=[];return e.forEach((e=>{e._id?e.deleted&&l.push(e._id):(t.push((0,p.Z)(e,this.syncKeys)),n.push(e.id))})),{changes:{added:(0,Bt.Z)(t)?void 0:t,deleted:(0,Bt.Z)(l)?void 0:l},addedLocalIds:n}}addServerData(e){return sn.transaction("rw",this.table,(async()=>{const t=Date.now()+"-",n=e.map((e=>(e.id=(0,on.Z)(t),e._id)));await this.table.where("_id").anyOf(n).delete(),await this.table.bulkAdd(e)}))}async downloadData(e){const t=await this.getDataFromServer(e),n=t.list;return Array.isArray(n)&&n.length&&await this.addServerData(n),t.date}setSyncTime(e){return m().storage.local.set({[this.syncTimeStorageKey]:e})}async commit(){const{changes:e,addedLocalIds:t}=await this.getSyncChanges(),n=await this.commitChanges(e);(0,Bt.Z)(n)||await this.table.where("id").anyOf(t).modify((e=>{const l=t.indexOf(e.id);l>=0&&(e._id=n[l],delete e.syncStatus)}))}async pull(e){const t=(await m().storage.local.get(this.syncTimeStorageKey))[this.syncTimeStorageKey];if(!t){const e=await this.downloadData();return await this.setSyncTime(e),this.deleteLogsFn(e).catch(Je.Z),!0}if(!e)return!1;const{changes:n,date:l}=await this.pullChanges(t);let a;const r=n.reduce(((e,t)=>{var n,l;return t.deleteAll?(e.added.clear(),e.deleted.clear(),a=!0,e):(null===(n=t.added)||void 0===n||n.forEach((t=>{e.added.add(t)})),null===(l=t.deleted)||void 0===l||l.forEach((t=>{e.added.has(t)?e.added.delete(t):e.deleted.add(t)})),e)}),{added:new Set,deleted:new Set});let c,i=[];const s=!!r.added.size;r.added.size&&(i=await this.table.where("_id").anyOf(Array.from(r.added)).toArray(),i.forEach((e=>{r.added.delete(e._id)})),r.added.size&&(c=(await this.getDataFromServer(Array.from(r.added))).list));const o=a||!!c||!!r.deleted.size;return o&&await sn.transaction("rw",this.table,(async()=>{a&&(await this.table.clear(),!(0,Bt.Z)(i)&&await this.table.bulkAdd(i));const e=[];return c&&e.push(this.addServerData(c)),r.deleted.size&&e.push(this.table.where("_id").anyOf(Array.from(r.deleted)).delete()),Promise.all(e)})),await this.setSyncTime(l),(o||s)&&this.deleteLogsFn(l).catch(Je.Z),o}}const pn=new dn(sn.favorites,["text","dir"],(async e=>(await u.L.post("/favorites",e)).data),"favoritesSyncAt",(async()=>(await u.L.delete("/favorites")).data),(async e=>(await u.L.put("/favorites",e)).data),(async e=>(await u.L.get("/favorites?lastCheck="+e)).data),(e=>u.L.delete("/favorites/logs?date="+e)));function En(e,t,n){let l;if(n){const e=n.toLocaleLowerCase();l=t=>{if(t.text.toLocaleLowerCase().includes(e))return!0;const n=t.results;return!!n&&Object.keys(n).some((t=>{var l,a;const r=n[t];return!!r&&(!!(null===(l=r.dict)||void 0===l?void 0:l.some((t=>t.terms.some((t=>t.includes(e))))))||!!(null===(a=r.result)||void 0===a?void 0:a.some((t=>t.includes(e)))))}))}}return pn.query(e,t,l)}var hn=n(935);const gn={end:!0,rows:[],loading:!1,selectedRows:[],searchText:"",latestDate:void 0},fn=(e,t)=>(0,yt.ZP)(e,(e=>{switch(t.type){case"reset":return gn;case"set":return void t.cb(e);case"set latestDate":const n=(0,hn.Z)(e.rows);return n?void(e.latestDate=n.date):void(e.latestDate=void 0);case"append data":if(e.end=t.data.length<100,!t.data.length)return;return void e.rows.push(...t.data);case"switch-check":const l=e.selectedRows.indexOf(t.id);return void(l>=0?e.selectedRows.splice(l,1):e.selectedRows.push(t.id))}}));function vn(e,t,n){const[a,r]=(0,l.useState)(0),[c,i]=(0,l.useReducer)(fn,gn),s=(0,l.useCallback)((()=>{i({type:"set latestDate"})}),[]);(0,l.useEffect)((()=>{if(c.end)return;const e=()=>{document.documentElement.scrollTop+window.innerHeight===document.documentElement.scrollHeight&&s()};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}}),[s,c.end]),(0,l.useEffect)((()=>{let t=!1;return i({type:"set",cb(e){e.loading=!0}}),e(100,c.latestDate,c.searchText).then((e=>{t||(i({type:"set",cb(e){e.loading=!1}}),i({type:"append data",data:e}))})),()=>{t=!0}}),[c.searchText,c.latestDate,a,e]);return(0,l.useEffect)((()=>{t&&n.pull(t.vipActivated).then((e=>{e&&(i({type:"reset"}),r((e=>e+1)))}))}),[n,t]),{tableData:c,queryNextPage:s,deleteSelected:()=>n.deleteById(c.selectedRows,!!t&&t.vipActivated).then((()=>{i({type:"set",cb(e){e.rows=e.rows.filter((e=>!c.selectedRows.includes(e.id))),e.selectedRows=[]}})})),clearData:()=>n.deleteAll(!!t).then((()=>{i({type:"set",cb(e){e.selectedRows=[],e.end=!0,e.rows=[],e.latestDate=void 0,e.searchText=""}})})),setSearchText:e=>{i({type:"set",cb(t){e!==t.searchText&&(t.end=!0,t.rows=[],t.searchText=e.trim(),t.latestDate=void 0)}})},cancelSelected:()=>{i({type:"set",cb(e){e.selectedRows=[]}})},switchCheck:e=>{i({type:"switch-check",id:e})}}}var bn=n(4184),yn=n.n(bn),kn=n(5601),wn=n(4076),xn=n(5539),Cn=n(8140);async function Sn(e){m().runtime.sendMessage({action:"audio",url:e}).catch((e=>{window.alert("朗读时出错："+(null==e?void 0:e.message))}))}function Tn(e){const t=e.uri,n=e.size,a=e.style;return l.createElement(i.zx,{style:a,icon:l.createElement(i.JO,{icon:"volume-up",iconSize:Nn[n]}),small:"small"===n,large:"large"===n,minimal:!0,disabled:!t,onClick:t?()=>Sn(t):void 0,title:t?"朗读":"不支持此语种"})}function Ln(e,t){const n="GoogleWeb"===t,l=[];return!e.phonetic||n&&!e.dict||l.push(e.phonetic.map((e=>`${e.name?e.name+" ":""}/${e.value}/`))),e.dict?l.push(...e.dict.map((e=>`${e.pos?e.pos+(n?": ":" "):""}${e.terms.join(", ")}`))):e.result&&l.push(...e.result),m().runtime.sendMessage({action:"write to clipboard",text:l.join("\n")})}function Zn(e){e.stopPropagation()}const An=/\b[A-Z\s\-'a-z]+\b/g;const Nn={small:12,middle:16,large:20};function Rn(e){switch(e){case"美":return"英语(美国)";case"英":return"英语(英国)";default:return}}function Pn(e){var t;const{apiId:n,result:{loading:a,result:r}={loading:!1,result:null},queryResult:c,autoCopy:s=!1,autoPlay:o=!1,wordClickable:m=!0,setQuery:u=Je.Z,size:d="small",collapse:p,onCollapseChange:E,portalContainer:h}=e,g=Nn[d],f="small"===d,v="large"===d,[b,y]=(0,l.useState)("duplicate"),[k,w]=(0,l.useState)(),x=jt.Y.find((e=>e.id===n))||{name:n,id:n},C=()=>{y("tick"),w("success"),window.setTimeout((()=>{y("duplicate"),w(void 0)}),1e3)};(0,l.useEffect)((()=>{var e;r&&o&&r.text.length<30&&Sn({apiId:n,source:r.from,text:r.text,ttsURI:(null===(e=r.phonetic)||void 0===e?void 0:e[0].ttsURI)||r.ttsURI})}),[n,o,r]),(0,l.useEffect)((()=>{r&&s&&Ln(r,n).then((e=>{e?C():window.alert("自动复制翻译结果失败，请稍后重试。")}),(e=>{window.alert(`自动复制翻译结果时发生了一个错误：${null==e?void 0:e.message}`)}))}),[r,s,n]);const S=xn.q[n];return l.createElement(i.Zb,{className:"result-block",onClick:Zn},l.createElement("div",{className:"legend"},l.createElement("div",{className:"legend-left"},l.createElement("span",{className:"api-ico",style:S?{backgroundImage:`url(${S})`}:void 0}),l.createElement(i.H6,null,x.name),r&&l.createElement(l.Fragment,null,l.createElement(kn.Z,{lang:r.from,setLang:c,size:"small",maxHeight:212,portalContainer:h},l.createElement("span",{className:"source"},l.createElement("span",{className:"source-text"},r.from),l.createElement(i.JO,{icon:"caret-down",iconSize:12}))),l.createElement(Tn,{uri:{apiId:n,source:r.from,text:r.text,ttsURI:(null===(t=r.phonetic)||void 0===t?void 0:t[0].ttsURI)||r.ttsURI},size:d}))),l.createElement("div",{style:{flexShrink:0}},void 0!==p&&l.createElement(i.zx,{minimal:!0,small:f,large:v,title:p?"展开":"收起",onClick:()=>{E&&E(!p)},icon:l.createElement(i.JO,{icon:p?"chevron-down":"chevron-up",iconSize:g+2})}),l.createElement(i.zx,{onClick:()=>{r&&Ln(r,n).then((e=>{e?C():window.alert("复制翻译结果失败，请稍后重试。")}),(e=>{window.alert(`复制翻译结果时发生了一个错误：${null==e?void 0:e.message}`)}))},disabled:!r||!!r.error,icon:l.createElement(i.JO,{icon:b,iconSize:g}),minimal:!0,small:f,large:v,intent:k,title:"复制翻译结果"}),l.createElement(i.AN,{disabled:!(null==r?void 0:r.link),target:"_blank",href:(null==r?void 0:r.link)||"",icon:l.createElement(i.JO,{icon:"share",iconSize:g}),minimal:!0,small:f,large:v,title:"查看详细结果"}))),l.createElement(i.UO,{isOpen:!p},l.createElement("div",{style:{display:a?"block":"none"}},l.createElement("p",{className:yn()({"bp3-skeleton":a})},"1"),l.createElement("p",{className:yn()({"bp3-skeleton":a}),style:{width:"150px"}},"1")),(null==r?void 0:r.error)&&l.createElement("div",{className:"error"},l.createElement(Cn.i,{error:r.error,onRetry:()=>c()})),(null==r?void 0:r.phonetic)&&l.createElement("div",{className:"phonetic"},r.phonetic.map(((e,t)=>l.createElement("div",{key:t,className:"phonetic-item",style:{maxWidth:"100%"}},e.name&&l.createElement("span",{style:{flexShrink:0,marginRight:5}},e.name),e.value&&l.createElement(wn.Z,null,"/",e.value,"/"),e.ttsURI&&l.createElement(Tn,{style:{flexShrink:0},uri:{apiId:n,source:Rn(e.name)||r.from,text:r.text,ttsURI:e.ttsURI},size:d}))))),r&&l.createElement("div",{className:"common-result"},r.dict&&l.createElement("div",{className:"dict"},r.dict.map(((e,t)=>{const a=e.terms.join(", ");return l.createElement("p",{key:t},e.pos&&l.createElement("span",{className:"dict-pos"},e.pos,"GoogleWeb"===n?": ":""),m?function(e,t){const n=Array.from(e.matchAll(An)),a=e.split(An);return l.createElement(l.Fragment,null,a.map(((e,a)=>{const r=n[a];return l.createElement(l.Fragment,{key:a},e,r?l.createElement("a",{onClick:()=>t(r[0])},r[0]):"")})))}(a,u):a)}))),!r.dict&&r.result&&l.createElement("div",{className:"general-result"},r.result.map(((e,t)=>l.createElement("p",{key:t},e,l.createElement(Tn,{uri:{text:e,apiId:n,source:null==r?void 0:r.to},size:d}))))))))}const On=["GoogleWeb","BingDictWeb"];function Fn(e){const{item:t,selected:n,switchSelected:a}=e,[r,c]=(0,l.useState)({});return(0,l.useEffect)((()=>{t.results&&c(t.results)}),[t]),(0,l.useEffect)((()=>{if(t.results)return;const e=t.dir;if(e){const n={};Promise.all(On.map((l=>(async(e,t,n,l)=>{try{return await m().runtime.sendMessage({action:"translate",data:{apiCode:t,text:e,source:n,destinations:[l]}})}catch(e){}})(t.text,l,e.from,e.to).then((e=>{e&&(n[l]=e)}))))).then((()=>{c(n),pn.table.update(t.id,{results:n})}))}}),[t]),l.createElement(i.Zb,{className:yn()("favorite-item",{active:n}),interactive:!0,onClick:()=>{a(t.id)}},l.createElement(i.H4,null,t.text),Object.keys(r).map((e=>l.createElement(Pn,{key:e,apiId:e,result:{loading:!1,result:r[e]||null},queryResult:Je.Z,wordClickable:!1}))))}const Dn=(0,p.Z)(v.q,["favoritesEnabled"]);const Kn=pe?Ee?"https://microsoftedge.microsoft.com/addons/detail/oikmahiipjniocckomdccmplodldodja":"https://chrome.google.com/webstore/detail/ikhdkkncnoglghljlkmcimlnlhkeamad":"https://addons.mozilla.org/zh-CN/firefox/addon/hcfy/";var In=n(657);const zn=n(9101).N.ofType();var Bn;!function(e){e.g="g",e.i="i",e.m="m"}(Bn||(Bn={}));const _n=[Bn.g,Bn.i,Bn.m],qn={[Bn.g]:"全局匹配",[Bn.i]:"忽略大小写",[Bn.m]:"多行匹配"},Un=e=>qn[e];function Vn(e){const{selected:t,setSelected:n}=e,a=(0,l.useCallback)((e=>{n((t=>{const n=t.indexOf(e);return n<0?t:t.slice(0,n)+t.slice(n+1)}))}),[n]),r=(0,l.useCallback)(((e,{handleClick:n,modifiers:a})=>l.createElement(i.sN,{icon:t.includes(e)?"tick":"blank",onClick:n,active:a.active,key:e,text:qn[e]})),[t]);return l.createElement(zn,{tagRenderer:Un,tagInputProps:{inputProps:{readOnly:!0}},items:_n,onRemove:a,itemRenderer:r,onItemSelect:e=>{n((t=>{const n=t.indexOf(e);return n<0?t+e:t.slice(0,n)+t.slice(n+1)}))},selectedItems:t.split("")})}const Hn={pattern:"",flags:"gi",replaceTo:""};function Mn(e){const{show:t,hideDialog:n,onAdd:a}=e,[r,c]=(0,l.useState)(Hn),s=(0,l.useCallback)((e=>{c((t=>({...t,flags:e(t.flags)})))}),[]),o=(0,l.useRef)(null),[m,u]=(0,l.useState)(""),[d,p]=(0,l.useState)(""),[E,h]=(0,l.useState)(null),[g,f]=(0,l.useState)(!1);(0,l.useEffect)((()=>{let e;try{e=new RegExp(r.pattern,r.flags),f(!1)}catch(e){return f(!0),void h(null)}h(r.pattern?e:null)}),[r.flags,r.pattern]),(0,l.useEffect)((()=>{p(E&&m?m.replace(E,r.replaceTo):"")}),[E,r.replaceTo,m]);return l.createElement(i.Vq,{title:"添加源文本替换正则",canOutsideClickClose:!1,isOpen:t,onClose:n,onClosed:()=>{c(Hn),u("")},onOpened:()=>{var e;null===(e=o.current)||void 0===e||e.focus()}},l.createElement("form",{onSubmit:e=>{e.preventDefault(),!g&&r.pattern&&(n(),a(r))}},l.createElement("div",{className:"bp3-dialog-body"},l.createElement(i.cw,{label:"正则",labelFor:"input-pattern"},l.createElement("input",{id:"input-pattern",className:"bp3-input bp3-fill",ref:o,value:r.pattern,required:!0,onChange:e=>{const t=e.target.value;c((e=>({...e,pattern:t})))}})),l.createElement(i.cw,{label:"标识"},l.createElement(Vn,{selected:r.flags,setSelected:s})),l.createElement(i.cw,{label:"替换为",labelFor:"input-replace-to"},l.createElement("input",{id:"input-replace-to",className:"bp3-input bp3-fill",value:r.replaceTo,onChange:e=>{const t=e.target.value;c((e=>({...e,replaceTo:t})))}})),g&&l.createElement(i.UW,{intent:"danger",title:"正则有误",style:{marginBottom:10}}),l.createElement("div",{className:"bp3-text-muted bp3-text-small"},l.createElement("p",null,"以上配置等同于下面这行 JavaScript 代码："),l.createElement(i.SU,{style:{whiteSpace:"break-spaces"}},'"',m.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'".replace(new RegExp("',r.pattern.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),'", "',r.flags,'"), "',r.replaceTo.replace(/"/g,'\\"'),'")'),l.createElement("p",null,"相关文档：",l.createElement("a",{href:"https://developer.mozilla.org/zh-CN/docs/web/javascript/reference/global_objects/regexp/regexp",target:"_blank",rel:"noreferrer noopener"},"RegExp 构造函数")," ","|"," ",l.createElement("a",{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replace",target:"_blank",rel:"noreferrer noopener"},"String.prototype.replace() 方法"))),l.createElement("p",null,l.createElement(i.Kx,{fill:!0,placeholder:"在此输入文本可以测试正则",value:m,onChange:e=>{u(e.target.value)}})),m&&E&&l.createElement("div",{className:"bp3-text-muted bp3-text-small"},l.createElement("p",null,"以上文本会被替换为："),l.createElement(i.SU,{style:{whiteSpace:"break-spaces"}},d))),l.createElement("div",{className:"bp3-dialog-footer"},l.createElement("div",{className:"bp3-dialog-footer-actions"},l.createElement(i.zx,{onClick:n},"取消"),l.createElement(i.zx,{type:"submit",intent:"primary"},"添加")))))}function Wn(e){const{regexps:t,setRegexps:n}=e,a=(0,l.useContext)(y),[r,c]=(0,l.useState)(!1);return l.createElement(l.Fragment,null,l.createElement("p",{className:"bp3-form-helper-text"},"除了使用上面预定义的替换功能，你还可以使用",l.createElement("a",{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions",target:"_blank",rel:"noreferrer noopener"},"正则表达式"),"自行添加源文本替换逻辑。",l.createElement(i.zx,{intent:"primary",icon:"add",small:!0,onClick:()=>c(!0),disabled:!(null==a?void 0:a.vipActivated)},"添加正则表达式")),l.createElement(i.vl,{condensed:!0,bordered:!0,striped:!0,style:{width:"100%"}},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null,"正则表达式"),l.createElement("th",null,"替换为"),l.createElement("th",null))),l.createElement("tbody",null,t.map(((e,a)=>l.createElement("tr",{key:a},l.createElement("td",null,l.createElement(i.EK,null,l.createElement("pre",{style:{display:"inline"}},"/",e.pattern,"/",e.flags))),l.createElement("td",null,e.replaceTo?l.createElement(i.EK,null,e.replaceTo):"从源文本中删除"),l.createElement("td",null,l.createElement(i.zx,{icon:"delete",small:!0,onClick:()=>{n((0,yt.ZP)(t,(e=>{e.splice(a,1)})))}},"删除"))))),!t.length&&l.createElement("tr",null,l.createElement("td",{colSpan:3,style:{textAlign:"center"}},"未添加正则表达式")))),l.createElement(Mn,{show:r,hideDialog:()=>c(!1),onAdd:e=>{n((0,yt.ZP)(t,(t=>{t.push(e)})))}}))}const jn=(0,p.Z)(v.q,["sourceTransformNoBr","sourceTransformNCaml","sourceTransformNoComment","sourceTransformRegExps"]);function $n(){const e=(0,l.useContext)(y),[t,n]=(0,b.Z)(jn);return l.createElement(i.cw,{className:"inline-form-group-label"},l.createElement(i.XZ,{labelElement:l.createElement(l.Fragment,null,"将换行符替换成空格",l.createElement(te,null,"部分网站如"," ",l.createElement("a",{href:"https://www.rfc-editor.org/rfc/rfc6633.txt",target:"_blank",rel:"noreferrer"},"RFCs 文档站"),"在文本中自行加入了换行符，这导致翻译结果不是按照完整的句子翻译的，勾选此选项即可将源文本里的所有换行符替换成空格。")),inline:!0,disabled:!(null==e?void 0:e.vipActivated),checked:t?t.sourceTransformNoBr:jn.sourceTransformNoBr,onChange:e=>{n({sourceTransformNoBr:e.target.checked})}}),l.createElement(i.XZ,{labelElement:l.createElement(l.Fragment,null,"将双斜线（//）替换成空格",l.createElement(te,null,"部分代码使用双斜线 // 作为代码注释，勾选此选项即可去掉文本中的所有双斜线。如果同时勾选了“将换行符替换成空格”，则可以正常翻译多行注释。")),inline:!0,disabled:!(null==e?void 0:e.vipActivated),checked:t?t.sourceTransformNoComment:jn.sourceTransformNoComment,onChange:e=>{n({sourceTransformNoComment:e.target.checked})}}),l.createElement(i.XZ,{labelElement:l.createElement(l.Fragment,null,"转换驼峰式和下划线式词组",l.createElement(te,null,"部分网站如 GitHub 里查看代码时，有很多驼峰式或下划线式的词组如“someData”、“click_by_someone”，勾选此选项后则会转换成“some data”、“click by someone”这类形式。")),inline:!0,disabled:!(null==e?void 0:e.vipActivated),checked:t?t.sourceTransformNCaml:jn.sourceTransformNCaml,onChange:e=>{n({sourceTransformNCaml:e.target.checked})}}),l.createElement(Wn,{regexps:t?t.sourceTransformRegExps:[],setRegexps:e=>{n({sourceTransformRegExps:e})}}))}const Jn=l.createElement(l.Fragment,null,[{label:"电商 - 商品标题",value:"title"},{label:"电商 - 商品描述",value:"description"},{label:"电商 - 买卖家沟通",value:"communication"},{label:"医疗",value:"medical"},{label:"社交",value:"social"},{label:"金融",value:"finance"}].map((e=>l.createElement("option",{key:e.value,value:e.value},e.label))));function Xn(e){return l.createElement(i.Lu,{value:e.value||"",onChange:t=>{e.onChange(t.currentTarget.value||null)}},l.createElement("option",{value:""},"请选择"),Jn)}const Yn=l.createElement(l.Fragment,null,[{label:"电子科技",value:"electronics"},{label:"金融财经",value:"finance"},{label:"水利机械",value:"mechanics"},{label:"生物医药",value:"medicine"},{label:"网络文学",value:"novel"}].map((e=>l.createElement("option",{key:e.value,value:e.value},e.label)))),Qn=["electronics","mechanics","novel"];function Gn(e){return l.createElement(i.Lu,{value:e.value||"",onChange:t=>{e.onChange(t.currentTarget.value||null)}},l.createElement("option",{value:""},"请选择"),Yn)}var el=n(3500);function tl(e){const{selected:t,onChange:n}=e;return l.createElement(Ue.C,{items:el.F,selected:t,onChange:n,labelKey:"name",valueKey:"id",itemRenderer:(e,t,n,a,r)=>l.createElement("div",{key:n},l.createElement(i.XZ,{inline:!0,labelElement:t,checked:a,onChange:e=>{r(e.target.checked)}}),l.createElement(i.AN,{minimal:!0,small:!0,icon:l.createElement(i.JO,{icon:"share",iconSize:12}),target:"_blank",href:e.home}))})}(0,p.Z)(v.q,["quickLinks"]);const nl={name:"",link:"",menu:!1,panel:!1},ll=[{name:"谷歌搜索",link:"https://www.google.com/search?q=%s",menu:!0,panel:!0},{name:"百度搜索",link:"https://www.baidu.com/s?wd=%s",menu:!0,panel:!0},{name:"维基百科",link:"https://zh.wikipedia.org/w/index.php?search=%s",menu:!0,panel:!0},{name:"剑桥词典",link:"https://dictionary.cambridge.org/dictionary/english-chinese-simplified/%s",menu:!0,panel:!0}],al=i.x7.create({position:"bottom",maxToasts:1});function rl(e){var t;const{setShowVip:n}=(0,l.useContext)($),a=(0,l.useContext)(y),{options:r,setOptions:c}=e,[s,o]=(0,l.useState)(!1),[m,u]=(0,l.useState)(-1),[d,p]=(0,l.useState)(!1),[E,h]=(0,l.useState)(-1),[g,f]=(0,l.useState)(nl),[v,b]=(0,l.useState)(!1),k=(0,l.useRef)(null);return l.createElement(i.cw,{helperText:l.createElement(l.Fragment,null,"快捷链接是基于你所划选的文本生成的链接。",l.createElement("a",{style:{marginRight:10},onClick:()=>b((e=>!e))},"查看教程"),l.createElement("a",{href:"https://github.com/lmk123/crx-selection-translate/discussions/945",target:"_blank",rel:"noreferrer"},"分享你的或查看其他人的快捷链接"))},l.createElement(i.Vq,{isOpen:v,title:"如何配置快捷链接",onClose:()=>b(!1)},l.createElement("div",{className:"bp3-dialog-body"},l.createElement("p",null,"以百度搜索为例："),l.createElement(i.OL,null,l.createElement("li",null,"打开",l.createElement("a",{href:"https://www.baidu.com",target:"_blank",rel:"noreferrer"},"百度搜索"),"并搜索 ",l.createElement(i.EK,null,"test"),"，百度搜索会跳转到一个新的网址：",l.createElement("a",{href:"https://www.baidu.com/s?wd=test&ie=utf-8&tn=baiduhome_pg",target:"_blank",rel:"noreferrer"},"https://www.baidu.com/s?wd=test&ie=utf-8&tn=baiduhome_pg")),l.createElement("li",null,"这个网址中包含我们刚才搜索的关键词 ",l.createElement(i.EK,null,"test"),"，我们只需要将 ",l.createElement(i.EK,null,"test")," 替换成 ",l.createElement(i.EK,null,"%s")," ","填写进快捷链接即可，也就是"," ",l.createElement(i.EK,null,"https://www.baidu.com/s?wd=%s&ie=utf-8&tn=baiduhome_pg")),l.createElement("li",null,"最后，这个网址中其实有很多不需要的参数，例如"," ",l.createElement(i.EK,null,"&ie=utf-8&tn=baiduhome_pg"),"，也可以将它们去掉之后再填进划词翻译中。")),l.createElement("div",null,"配置好了之后，假设你在网页上划选了“划词翻译”，那么百度搜索的快捷链接就会指向"," ",l.createElement("a",{href:"https://www.baidu.com/s?wd=%E5%88%92%E8%AF%8D%E7%BF%BB%E8%AF%91",target:"_blank",rel:"noreferrer"},"https://www.baidu.com/s?wd=划词翻译"),"，点击之后就能看到用百度搜索“划词翻译”的搜索结果。"))),l.createElement(i.bZ,{isOpen:m>=0,cancelButtonText:"取消",confirmButtonText:"确定",intent:"danger",icon:"trash",onClose:e=>{var t;e&&(t=m,c((e=>{e.quickLinks.splice(t,1)}))),u(-1)}},"确定要删除“",null===(t=null==r?void 0:r.quickLinks[m])||void 0===t?void 0:t.name,"”吗？"),l.createElement(i.Vq,{isOpen:s,title:(d?"修改":"新增")+"快捷链接",onClose:()=>{o(!1),f(nl)},onOpened:()=>{var e;null===(e=k.current)||void 0===e||e.focus()}},l.createElement("form",{onSubmit:e=>{var t,n,l,a,i,s,m,u;if(e.preventDefault(),d){if(null==r?void 0:r.quickLinks.find(((e,t)=>e.name===g.name&&t!==E)))return null===(t=k.current)||void 0===t||t.setCustomValidity("快捷链接的名称不能重复。"),void(null===(n=k.current)||void 0===n||n.reportValidity());null===(l=k.current)||void 0===l||l.setCustomValidity(""),m=g,u=E,c((e=>{e.quickLinks.splice(u,1,m)}))}else{if(null==r?void 0:r.quickLinks.find((e=>e.name===g.name)))return null===(a=k.current)||void 0===a||a.setCustomValidity("快捷链接的名称不能重复。"),void(null===(i=k.current)||void 0===i||i.reportValidity());null===(s=k.current)||void 0===s||s.setCustomValidity(""),(e=>{c((t=>{t.quickLinks.push(e)}))})(g)}o(!1),f(nl)}},l.createElement("div",{className:"bp3-dialog-body"},l.createElement("p",null,"示例：",ll.map((e=>l.createElement("a",{style:{marginRight:"5px"},key:e.name,onClick:()=>f(e)},e.name)))),l.createElement(i.cw,{label:"名称："},l.createElement(i.BZ,{required:!0,inputRef:k,value:g.name,onChange:e=>{f((0,yt.ZP)((t=>{t.name=e.target.value})))}})),l.createElement(i.cw,{label:"链接：",helperText:"可以在链接中使用“%s”表示划选的文本。"},l.createElement(i.BZ,{required:!0,type:"url",value:g.link,onChange:e=>{f((0,yt.ZP)((t=>{t.link=e.target.value})))}})),l.createElement(i.cw,{label:"显示在：",inline:!0},l.createElement(i.XZ,{inline:!0,label:"右键菜单",checked:g.menu,onChange:()=>{f((0,yt.ZP)((e=>{e.menu=!e.menu})))}}),l.createElement(i.XZ,{inline:!0,label:"翻译面板",checked:g.panel,onChange:()=>{f((0,yt.ZP)((e=>{e.panel=!e.panel})))}}))),l.createElement("div",{className:"bp3-dialog-footer"},l.createElement("div",{className:"bp3-dialog-footer-actions"},l.createElement(i.zx,{onClick:()=>{o(!1),f(nl)}},"取消"),l.createElement(i.zx,{type:"submit",intent:"primary"},"确定"))))),l.createElement(i.vl,{className:"quick-links-table",condensed:!0,striped:!0,bordered:!0,style:{width:"100%"}},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null,"名称"),l.createElement("th",null,"在翻译面板中显示"),l.createElement("th",null,"在右键菜单中显示"),l.createElement("th",null,"操作"))),l.createElement("tbody",null,!(null==r?void 0:r.quickLinks.length)&&l.createElement("tr",null,l.createElement("td",{colSpan:4},l.createElement(i.tR,{title:"没有快捷链接",description:"你还没有添加任何快捷链接，点击下方按钮即可添加。"}))),null==r?void 0:r.quickLinks.map(((e,t)=>l.createElement("tr",{key:t},l.createElement("td",null,l.createElement("a",{href:e.link.replace("%s",encodeURIComponent("划词翻译")),target:"_blank",rel:"noreferrer"},e.name)),l.createElement("td",null,e.panel?"是":"否"),l.createElement("td",null,e.menu?"是":"否"),l.createElement("td",null,l.createElement(i.zx,{minimal:!0,icon:"edit",onClick:()=>{r&&(!(null==a?void 0:a.vipActivated)&&r.quickLinks.length>5?al.show({timeout:0,intent:"primary",action:{text:"开通会员",onClick:()=>{n(!0)}},message:"非会员用户最多添加 5 个快捷链接，在修改快捷链接之前，请先将快捷链接删除至 5 个。成为会员即可解除此限制。"}):(p(!0),h(t),f(e),o(!0)))}},"修改"),l.createElement(i.zx,{minimal:!0,icon:"delete",onClick:()=>u(t)},"删除"))))),l.createElement("tr",null,l.createElement("td",{colSpan:4,style:{textAlign:"center"}},l.createElement(i.zx,{onClick:()=>{r&&(!(null==a?void 0:a.vipActivated)&&r.quickLinks.length>=5?al.show({timeout:0,intent:"primary",action:{text:"开通会员",onClick:()=>{n(!0)}},message:"非会员用户最多添加 5 个快捷链接。成为会员即可解除此限制。"}):(p(!1),o(!0)))}},"新增快捷链接"))))))}var cl=n(4538);const il=[{label:l.createElement(l.Fragment,null,l.createElement(i.JO,{icon:"cut",style:{marginRight:4}}),"截图翻译按钮"),value:"cut"},{label:l.createElement(l.Fragment,null,l.createElement(i.JO,{icon:"translate",style:{marginRight:4}}),"网页全文翻译按钮"),value:"translate"},{label:l.createElement(l.Fragment,null,l.createElement(i.JO,{icon:"video",style:{marginRight:4}}),"音视频翻译按钮"),value:"video"},{label:l.createElement(l.Fragment,null,l.createElement(i.JO,{icon:"media",style:{marginRight:4}}),"图片翻译按钮"),value:"media"},{label:l.createElement(l.Fragment,null,l.createElement(i.JO,{icon:l.createElement(cl.R,{iconSize:14}),style:{marginRight:4}}),"麦克风翻译按钮"),value:"microphone"},{label:l.createElement(l.Fragment,null,l.createElement(i.JO,{icon:"folder-open",style:{marginRight:4}}),"收藏夹按钮"),value:"folder-open"},{label:l.createElement(l.Fragment,null,l.createElement(i.JO,{icon:"history",style:{marginRight:4}}),"历史记录按钮"),value:"history"}],sl=(0,p.Z)(v.q,["panelButtons"]);function ol(){const[e,t]=(0,b.Z)(sl);return l.createElement(i.cw,{label:"面板上的按钮"},l.createElement(Ue.C,{items:il,selected:e?e.panelButtons:sl.panelButtons,onChange:e=>{t({panelButtons:e})}}))}const ml=(0,p.Z)(v.q,["width","source","destination","secondDestination","secondDestinationLatestSource","showTextArea","autoClipboard","autoClipboardImage","autoPlay","autoCopy","recentUseLangFrom","recentUseLangTo","pin","pinAfterDrag","pinPos","panelPos","panelSize","panelCustomStyle","textAreaAuto","textAreaShortKey","selectedAPIs","aliDomain","baiduDomain","selectedExternalLinks","quickLinks","placement","autoPaste"]),ul=[{label:"上",value:"top"},{label:"上左",value:"top-end"},{label:"上右",value:"top-start"},{label:"下",value:"bottom"},{label:"下左",value:"bottom-end"},{label:"下右",value:"bottom-start"},{label:"左",value:"left"},{label:"左上",value:"left-end"},{label:"左下",value:"left-start"},{label:"右",value:"right"},{label:"右上",value:"right-end"},{label:"右下",value:"right-start"}],dl=l.createElement(i.Vp,{htmlTitle:"此选项可以直接在翻译面板的快捷设置中调整。",minimal:!0},"快捷选项");var pl=n(1085),El=n(5965),hl=n(2699),gl=n(9119),fl=n(4974);const vl=new dn(sn.historyRecords,["text","url","favicon","title"],(async e=>(await u.L.post("/histories",e)).data),"historiesSyncAt",(async()=>(await u.L.delete("/histories")).data),(async e=>(await u.L.put("/histories",e)).data),(async e=>(await u.L.get("/histories?lastCheck="+e)).data),(e=>u.L.delete("/histories/logs?date="+e)));function bl(e,t,n){let l;if(n){const e=n.toLocaleLowerCase();l=t=>t.title.toLocaleLowerCase().includes(e)||t.url.toLocaleLowerCase().includes(e)||t.text.toLocaleLowerCase().includes(e)}return vl.query(e,t,l)}const yl=(0,p.Z)(v.q,["historyEnabled","historySyncEnabled"]);function kl(e){const t=new Date(e);return(0,R.Z)(t)?(0,P.Z)(t,"b K:mm",{locale:fl.Z}):""}function wl(e){return new URL(e).hostname}a.render(l.createElement(se.UT,null,l.createElement((function(e){return l.createElement(x,null,l.createElement(Y,null,e.children))}),null,l.createElement(r.Z5,null,l.createElement(r.AW,{path:"/",element:l.createElement((function(){(0,s.Z)();const e=(0,r.TH)(),t=(0,l.useContext)(y),{setShowVip:n}=(0,l.useContext)($),a=e.pathname;return l.createElement(l.Fragment,null,l.createElement(ne,null),l.createElement(i.Zb,{id:"left-nav"},l.createElement(i.v2,{large:!0},l.createElement(i.sN,{active:"/user"===a,icon:"user",text:t?"个人中心":"登录 / 注册",href:(0,r.oQ)("/user")}),l.createElement(ie,{title:"设置"}),l.createElement(i.sN,{active:"/"===a,href:(0,r.oQ)("/"),icon:"cog",text:"通用"}),l.createElement(i.sN,{active:"/panel"===a,href:(0,r.oQ)("/panel"),icon:"th-list",text:"翻译面板"}),l.createElement(i.sN,{active:"/cross"===a,href:(0,r.oQ)("/cross"),icon:"text-highlight",text:"网页划词翻译"}),l.createElement(i.sN,{active:"/fulltext"===a,href:(0,r.oQ)("/fulltext"),icon:"translate",text:"网页全文翻译"}),l.createElement(i.sN,{active:"/pdf"===a,href:(0,r.oQ)("/pdf"),icon:"document",text:"PDF"}),l.createElement(ie,{title:"个人"}),l.createElement(i.sN,{active:"/stars"===a,href:(0,r.oQ)("/stars"),icon:"folder-open",text:"收藏夹"}),l.createElement(i.sN,{active:"/history"===a,href:(0,r.oQ)("/history"),icon:"history",text:"历史记录"}),l.createElement(ie,{title:"服务"}),l.createElement(i.sN,{icon:"crown",text:"开通会员",onClick:()=>{n(!0)}}),l.createElement(i.sN,{active:"/services"===e.pathname,href:(0,r.oQ)("/services"),icon:"applications",text:"服务申请"}),l.createElement(i.sN,{icon:"clean",text:"邀请有礼",target:"_blank",href:"https://hcfy.app/docs/invite"}),l.createElement(i.sN,{active:"/about"===e.pathname,href:(0,r.oQ)("/about"),icon:"info-sign",text:"关于"}))),l.createElement("main",{id:"main"},l.createElement(r.j3,null)))}),null)},l.createElement(r.AW,{index:!0,element:l.createElement((function(){const{darkMode:e,setDarkMode:t}=(0,s.Z)(),[n,a]=(0,b.Z)(nt),[r,c]=(0,l.useState)(!1),{hasNotifications:o,requestNotifications:u}={hasNotifications:oe(me),requestNotifications:(0,l.useCallback)((()=>m().permissions.request(me)),[])};return l.createElement("div",{style:{margin:15}},l.createElement(Se,{style:{marginBottom:10}}),l.createElement(Pe,null),l.createElement(i.Zb,null,l.createElement(i.cw,{label:"深色模式",inline:!0},l.createElement(i.Ee,{inline:!0,onChange:e=>{t(e.target.value)},selectedValue:e},l.createElement(i.Y8,{label:"开",value:"open"}),l.createElement(i.Y8,{label:"关",value:"close"}),l.createElement(i.Y8,{label:"跟随系统",value:"system"}))),l.createElement(Ge,null)),l.createElement(i.Zb,null,l.createElement(i.H4,{id:"谷歌翻译"},"谷歌翻译"),l.createElement(tt,null)),l.createElement(qe,null),l.createElement(Me,null),l.createElement($e,null),l.createElement(i.Zb,null,l.createElement(i.H4,{id:"通知"},"通知"),!o&&l.createElement(i.UW,{icon:"info-sign",title:"划词翻译需要获得你的授权才能显示桌面通知"},l.createElement("p",null,"如果你希望划词翻译给你发送这些桌面通知，请先授权。"),l.createElement(i.zx,{intent:"primary",onClick:u,text:"允许划词翻译显示通知"})),l.createElement(i.cw,{inline:!0},l.createElement(i.XZ,{label:"在后台同步设置之后显示通知",checked:n?n.notifySyncOptions:nt.notifySyncOptions,onChange:e=>{a({notifySyncOptions:e.target.checked})},disabled:!o}))),l.createElement(i.Zb,null,l.createElement(i.H4,{id:"自定义翻译源"},"自定义翻译源 ",Ze),l.createElement(i.cw,{label:"接口地址",helperText:l.createElement(l.Fragment,null,"划词翻译会从这个接口地址获取自定义翻译源的翻译结果。",l.createElement("a",{href:"https://hcfy.app/docs/services/custom-api",target:"_blank",rel:"noreferrer"},"查看示例"))},l.createElement(i.BZ,{value:n?n.customAPI:nt.customAPI,onChange:e=>{a({customAPI:e.target.value})}})),l.createElement(i.cw,{label:"翻译源名称",helperText:"按下回车键添加翻译源名称，可输入多个。成为永久会员后，翻译面板会显示这些翻译源的翻译结果，另外，翻译源也会显示在网页全文翻译的选项中。"},l.createElement(i.EG,{values:n?n.customAPINames:nt.customAPINames,onChange:e=>{a({customAPINames:e})}})),l.createElement(i.zx,{loading:r,onClick:()=>{const e=null==n?void 0:n.customAPINames[0];e?(c(!0),m().runtime.sendMessage({action:"translate",data:{apiCode:e,text:"划词翻译自定义翻译源测试"}}).then((e=>{c(!1),e.error?window.alert("接口报错了。错误消息：\n"+JSON.stringify(e.error,null,2)):window.alert("调用成功，返回的数据为：\n"+JSON.stringify(e,null,2))}),(e=>{c(!1),window.alert("接口报错了。错误消息："+(null==e?void 0:e.message))}))):window.alert("请至少添加一个翻译源名称")}},"测试")))}),null)}),l.createElement(r.AW,{path:"user",element:l.createElement((function(){const e=(0,l.useContext)(y);return l.createElement("div",{id:"user-center",style:{margin:"15px",width:700}},!e&&l.createElement(lt,null),e&&l.createElement(ot,null))}),null)}),l.createElement(r.AW,{path:"cross",element:l.createElement((function(){const[e,t]=(0,l.useState)(!1),[n,a]=(0,b.Z)(Ct),r=e=>{a((t=>{const n=t.modifierKeys.indexOf(e);n>=0?t.modifierKeys.splice(n,1):t.modifierKeys.push(e)}))},c=!(null==n?void 0:n.modifierKeys.length),s=null==n?void 0:n.domainBlackList,o=null==n?void 0:n.domainWhiteList,m=(0,l.useMemo)((()=>!!s&&s.some((e=>e.host===St.host&&e.path===St.path))),[s]),[u,d]=(0,l.useState)(""),p=(0,l.useMemo)((()=>dt(u)),[u]),{matchedRule:E,whiteListMatched:h,blackListMatched:g}=(0,l.useMemo)((()=>p&&s&&o?ht(p,s,o):{matchedRule:void 0,whiteListMatched:void 0,blackListMatched:void 0}),[s,o,p]),f=!!n;return(0,l.useEffect)((()=>{if(f){const e=decodeURI(window.location.hash.slice(1));e&&(window.location.hash="",window.location.hash=e)}}),[f]),n?l.createElement("div",{id:"selection",style:{margin:15}},l.createElement(i.Zb,null,l.createElement(i.H4,{id:"辅助键"},"辅助键"),l.createElement(i.cw,{label:"选择辅助键",helperText:l.createElement(l.Fragment,null,"当选中的辅助键",l.createElement("b",null,l.createElement("i",null,"全部")),"按下不放时会触发下面的操作。")},l.createElement(i.XZ,{inline:!0,labelElement:l.createElement(l.Fragment,null,l.createElement("kbd",null,"Ctrl"),"/",l.createElement("kbd",null,"⌘")),checked:n.modifierKeys.includes("ctrl"),onChange:()=>{r("ctrl")}}),l.createElement(i.XZ,{inline:!0,labelElement:l.createElement(l.Fragment,null,l.createElement("kbd",null,"Alt"),"/",l.createElement("kbd",null,"⌥")),checked:n.modifierKeys.includes("alt"),onChange:()=>{r("alt")}}),l.createElement(i.XZ,{inline:!0,labelElement:l.createElement("kbd",null,"Shift"),checked:n.modifierKeys.includes("shift"),onChange:()=>{r("shift")}})),l.createElement(i.cw,null,l.createElement(i.Ee,{inline:!0,disabled:c,label:"在按住辅助键不放的情况下：",selectedValue:n.modifierKeyPressedAction,onChange:e=>{a({modifierKeyPressedAction:e.currentTarget.value})}},l.createElement(i.Y8,{label:"不选择",value:""}),l.createElement(i.Y8,{label:"划词后直接弹出翻译结果",value:"selection"}),l.createElement(i.Y8,{label:"开启鼠标悬浮取词",value:"hover"}),1===n.modifierKeys.length&&"ctrl"===n.modifierKeys[0]&&"selection"===n.modifierKeyPressedAction&&l.createElement(i.UW,{intent:"warning"},"单独使用",l.createElement("kbd",null,"Ctrl"),"/",l.createElement("kbd",null,"⌘"),"作为辅助键时，选择“划词后直接弹出翻译结果”可能会导致你用",l.createElement("kbd",null,"Ctrl"),"/",l.createElement("kbd",null,"⌘"),"+",l.createElement("kbd",null,"C"),"复制文本时误触翻译。如果你遇到了这个问题，请替换或添加其它辅助键。")),l.createElement(i.XZ,{disabled:c,label:"松开辅助键后，翻译页面中选中的文本",checked:n.modifierKeyTranslate,onChange:e=>{a({modifierKeyTranslate:e.target.checked})}}),1===n.modifierKeys.length&&"ctrl"===n.modifierKeys[0]&&n.modifierKeyTranslate&&l.createElement(i.UW,{intent:"warning"},"单独使用",l.createElement("kbd",null,"Ctrl"),"/",l.createElement("kbd",null,"⌘"),"作为辅助键时，启用此选项会导致你在文本框中选中文本后，用",l.createElement("kbd",null,"Ctrl"),"/",l.createElement("kbd",null,"⌘"),"+",l.createElement("kbd",null,"Space"),"切换输入法时误触翻译。如果你想避免这个问题，请替换或添加其它辅助键。"),l.createElement(i.XZ,{disabled:c,label:"按住辅助键不放时，让页面中的链接可被选中",checked:n.modifierKeyLink,onChange:e=>{a({modifierKeyLink:e.target.checked})}}))),l.createElement(i.Zb,null,l.createElement(i.H4,{id:"网址筛选"},"网址筛选"),l.createElement("p",{className:"bp3-text-small bp3-text-muted"},"划词翻译支持用黑 / 白名单规则控制在某些网址下是否启用网页划词。禁用了网页划词的页面在用鼠标划词后不会显示翻译按钮或翻译窗口，而且扩展图标会变为灰色，但你仍然可以使用辅助键、快捷键和右键菜单获取翻译结果。"),l.createElement(i.cw,{helperText:"勾选后，划词翻译在所有网站中划词后都不会显示翻译按钮 / 结果。"},l.createElement(i.XZ,{labelElement:l.createElement(l.Fragment,null,"在所有网站中禁用网页划词 ",l.createElement(kt,null)),checked:m,onChange:e=>{const t=e.target.checked;a((e=>{const n=e.domainBlackList,l=n.findIndex((e=>e.host===St.host&&e.path===St.path));t&&l>=0||!t&&l<0||(t?n.unshift(St):n.splice(l,1))}))}})),l.createElement("p",null,l.createElement(i.zx,{onClick:()=>{t((e=>!e))}},e?"隐藏":"显示","黑 / 白名单规则")),l.createElement("p",{className:"bp3-text-small bp3-text-muted"},"通常情况下，你不需要手动修改黑 / 白名单规则，因为你可以在点击扩展图标后出现的弹窗中便捷的禁用 / 启用网页划词。"),l.createElement(i.UO,{isOpen:e,keepChildrenMounted:!0},l.createElement("div",{className:"list"},l.createElement(bt,{disabled:m,rules:n.domainBlackList,setRules:e=>{a({domainBlackList:e})},name:"黑名单"}),l.createElement(bt,{disabled:m,rules:n.domainWhiteList,setRules:e=>{a({domainWhiteList:e})},name:"白名单"})),l.createElement(i.H6,null,"测试黑 / 白名单"),l.createElement(i.cw,null,l.createElement(i.BZ,{value:u,onChange:e=>{d(e.target.value.trim())},placeholder:"你可以填写一个网址来测试是否命中了黑名单或白名单"}),u&&!p&&l.createElement(i.UW,{intent:"warning"},"网址格式不正确"),E&&l.createElement(i.UW,null,g&&"没有命中白名单且","命中了",l.createElement("b",null,h?"白":"黑","名单"),"中的"," ",l.createElement(i.EK,null,ut(E))," 规则，此网址下会",l.createElement("b",null,h?"开启":"关闭"),"网页划词功能。"),p&&!g&&!h&&l.createElement(i.UW,null,"既没有命中白名单，也没有命中黑名单，此网址下会开启网页划词功能。"))),l.createElement(i.cw,{helperText:"勾选后，在固定模式下，无论当前页面是否处于黑 / 白名单中，划词后都会立刻显示翻译结果。"},l.createElement(i.XZ,{label:"固定模式下忽略黑 / 白名单规则",checked:n?n.pinIgnoreDomainList:Ct.pinIgnoreDomainList,onChange:()=>{a((e=>{e.pinIgnoreDomainList=!e.pinIgnoreDomainList}))}}))),l.createElement(i.Zb,null,l.createElement(i.H4,null,"文本筛选"),l.createElement(i.cw,null,n.textList.map((e=>l.createElement("div",{key:e.name},l.createElement(i.XZ,{disabled:m,label:e.name,checked:e.enabled,onChange:()=>{return t=e,void a((e=>{const n=e.textList,l=(0,yt.Js)(n).indexOf(t);if(l>=0){const e=n[l];e.enabled=!e.enabled}}));var t}}),l.createElement("p",{className:"bp3-text-small bp3-text-muted"},e.description)))))),l.createElement(i.Zb,null,l.createElement(i.H4,null,"其它筛选"),l.createElement(i.cw,null,l.createElement(i.XZ,{label:"在文本框内划词后不触发翻译",checked:n.disableInTextarea,onChange:e=>{a({disableInTextarea:e.target.checked})}}),l.createElement("p",{className:"bp3-text-muted bp3-text-small"},"勾选后，当你在文本框内划词时不会显示翻译按钮或翻译结果，也不会在固定模式时触发翻译。")),l.createElement(xt,null)),l.createElement(i.Zb,null,l.createElement(i.H4,null,"翻译按钮"),l.createElement(i.cw,{label:"翻译按钮"},l.createElement(i.XZ,{disabled:m,label:"划词后先显示翻译按钮",checked:n.button,onChange:e=>{a({button:e.target.checked})}}),l.createElement("p",{className:"bp3-text-muted bp3-text-small"},"勾选后，划词之后会先显示翻译按钮，点击按钮后才会弹出翻译结果；如果不勾选，那么划词后会直接弹出翻译结果。")),l.createElement(i.cw,{label:"按钮显示位置",helperText:"如果翻译按钮遮挡了其它扩展程序的按钮，你可以调整它的位置。设置为负数可以让按钮向下 / 向右偏移。"},l.createElement("div",{className:"btn-offset-option"},"向上偏移：",l.createElement(i.Af,{disabled:m||!n.button,value:n.buttonOffsetTop,onValueChange:e=>{a({buttonOffsetTop:e})},rightElement:l.createElement(i.Vp,null,"像素")}),"向左偏移：",l.createElement(i.Af,{disabled:m||!n.button,value:n.buttonOffsetLeft,onValueChange:e=>{a({buttonOffsetLeft:e})},rightElement:l.createElement(i.Vp,null,"像素")}))),l.createElement(i.cw,null,l.createElement(i.XZ,{disabled:m||!n.button,label:"自动隐藏",checked:n.buttonAutoClose,onChange:e=>{a({buttonAutoClose:e.target.checked})}}),l.createElement("p",{className:"bp3-text-muted bp3-text-small"},"勾选后，翻译按钮会在 2 秒后自动隐藏。")))):null}),null)}),l.createElement(r.AW,{path:"fulltext",element:l.createElement((function(){const[e,t]=(0,b.Z)(Lt);return l.createElement("div",{style:{margin:15}},l.createElement(i.Zb,null,l.createElement(i.cw,{inline:!0,helperText:"开启后，网页全文翻译在“双语”模式下会将译文突出显示，这样能在视觉上跟原文做出区分。"},l.createElement(i.XZ,{label:"突出显示译文",checked:e?e.pageTrsHighlight:Lt.pageTrsHighlight,onChange:e=>{t({pageTrsHighlight:e.target.checked})}})),l.createElement(i.cw,{inline:!0},l.createElement(i.XZ,{label:"让译文可编辑",checked:e?e.pageTrsEditable:Lt.pageTrsEditable,onChange:e=>{t({pageTrsEditable:e.target.checked})}}))),l.createElement(i.Zb,null,l.createElement(i.cw,{label:"可供选择的翻译服务",helperText:"注意：此设置项只是用来减少切换翻译服务时的下拉框选项个数的。如果你是想切换网页全文翻译使用的翻译服务，请在开启全文翻译后，将鼠标移动到网页右下角的划词翻译图标上。"},l.createElement(Tt.f,{noBingDict:!0,selectedAPIs:(null==e?void 0:e.pageTrsApiOptions)||[],onChange:e=>{t({pageTrsApiOptions:e})}}))))}),null)}),l.createElement(r.AW,{path:"pdf",element:l.createElement((function(){const[e,t]=(0,b.Z)(Rt);return l.createElement("div",{style:{margin:15}},l.createElement(i.Zb,null,l.createElement(i.H4,null,"内置 PDF 阅读器"),l.createElement(i.cw,{helperText:l.createElement(l.Fragment,null,l.createElement("p",null,"开启后，点击一个 PDF 文件链接或将 PDF 文件拖放到浏览器中时，会自动跳转到划词翻译的内置 PDF 阅读器。"),l.createElement("div",null,"小提示：如果你希望打开划词翻译内置 PDF 阅读器的同时可以保留浏览器的原生 PDF 页面，那么你可以关闭此选项，并开启下方的“检测网页中的 PDF”。这样一来，划词翻译会在浏览器的原生 PDF 页面中提示你是否要在内置 PDF 阅读器中打开，打开之后原生 PDF 页面仍然会保留。"))},l.createElement(i.XZ,{label:"自动打开 PDF",checked:e?e.pdfAuto:Rt.pdfAuto,onChange:e=>{t({pdfAuto:e.target.checked})}})),ge?l.createElement(xe,null):l.createElement(we,null),l.createElement(Zt,null),l.createElement(Nt,null)),l.createElement(i.Zb,null,l.createElement(i.cw,{helperText:"开启后，当网页里有 PDF 文件时，划词翻译会弹出在内置 PDF 阅读器里打开的提示。"},l.createElement(i.XZ,{label:"检测网页中的 PDF",checked:e?e.pdfSnifferEnable:Rt.pdfSnifferEnable,onChange:e=>{t({pdfSnifferEnable:e.target.checked})}}))))}),null)}),l.createElement(r.AW,{path:"services",element:l.createElement((function(){const{setShowBuyPoints:e}=(0,l.useContext)($),[t,n]=(0,l.useState)({common:an,secretKey:{}});(0,l.useEffect)((()=>{L.get("/summaryv2.json").then((e=>{n((0,yt.ZP)((t=>{t.secretKey=e.data.secretKey})))}))}),[]);const[a,r]=(0,l.useState)(!0),c=(0,l.useCallback)((()=>{r(!1),setTimeout((()=>{r(!0)}))}),[]);return l.createElement("div",{id:"services"},l.createElement(ln,null),l.createElement(i.UW,{title:"关于第三方服务"},l.createElement("p",null,"划词翻译的部分功能依赖下面这些第三方服务，你需要自行申请之后才能使用它们（免费）。",l.createElement("a",{href:"https://hcfy.app/docs/faq/#why-apply",target:"_blank",rel:"noreferrer noopener"},"为什么这些服务需要自行申请之后才能使用？")),l.createElement("p",null,"你也可以",l.createElement(i.zx,{style:{margin:"0 5px"},intent:"primary",small:!0,onClick:()=>{e(!0)}},"购买翻译积分"),"直接使用这些服务，但这不是必须的。",l.createElement("a",{href:"https://hcfy.app/docs/services/tp",target:"_blank",rel:"noreferrer"},"查看翻译积分的介绍")),l.createElement("div",null,"部分服务支持免费试用。",l.createElement("a",{href:"https://hcfy.app/docs/services/free",target:"_blank",rel:"noreferrer"},"查看免费试用的说明"))),l.createElement(i.UW,{intent:"primary",icon:null,style:{margin:"15px 0"}},"密钥配置信息：",l.createElement(Wt,{onImported:c}),l.createElement("span",{className:"bp3-text-small bp3-text-muted",style:{marginLeft:15}},"你可以将你配置的密钥导出并导入到另一个浏览器的划词翻译中。")),a&&l.createElement(l.Fragment,null,l.createElement(It,{name:"翻译服务",services:jt.Y,summaryMap:t}),l.createElement(It,{name:"图片转文字（OCR）服务",description:"截图翻译和图片翻译功能会使用你选择的服务将图片转为文字。",services:tn,summaryMap:t,selectedStorageKey:"ocrService"}),l.createElement(It,{name:"语音转文字服务",description:"语音翻译和音视频翻译功能会使用这些服务将语音转为文字。",services:$t.pB,summaryMap:t})))}),null)}),l.createElement(r.AW,{path:"history",element:l.createElement((function(){const[e,t]=(0,b.Z)(yl),n=e||yl,{setShowVip:a}=(0,l.useContext)($),r=(0,l.useContext)(y),[c,s]=(0,l.useState)(!1),[o,m]=(0,l.useState)(!1),{tableData:u,queryNextPage:d,deleteSelected:p,clearData:E,setSearchText:h,cancelSelected:g,switchCheck:f}=vn(bl,r,vl),v=(0,l.useMemo)((()=>{const e=[];let t,n;return u.rows.forEach((l=>{!t||(0,hl.Z)(t,l.date)?(t=(0,gl.Z)(l.date),n=[l],e.push({date:t,items:n})):n.push(l)})),e}),[u.rows]);return l.createElement("div",{id:"history-records"},l.createElement(i.bZ,{cancelButtonText:"取消",confirmButtonText:"确定",intent:"danger",isOpen:c,icon:"trash",onClose:e=>{e&&p(),s(!1)}},l.createElement("p",null,"确定要删除这些记录吗？")),l.createElement(i.bZ,{cancelButtonText:"取消",confirmButtonText:"确定",icon:"trash",intent:"danger",isOpen:o,onClose:e=>{e&&E(),m(!1)}},l.createElement("p",null,"确定要清空历史记录吗？")),l.createElement("div",{className:"actions"},l.createElement("div",{className:"actions-left"},l.createElement(i.BZ,{className:"search-input",placeholder:"搜索历史记录",rightElement:u.searchText?l.createElement(i.zx,{icon:"cross",minimal:!0,onClick:()=>{h("")}}):void 0,value:u.searchText,onChange:e=>{const t=e.target.value;h(t)}}),u.selectedRows.length?l.createElement(l.Fragment,null,l.createElement(i.zx,{text:`删除选中的记录（${u.selectedRows.length}）`,intent:"primary",style:{marginLeft:"10px"},onClick:()=>{s(!0)}}),l.createElement(i.zx,{text:"取消选择",style:{margin:"0 10px"},onClick:g}),l.createElement(i.zx,{intent:"danger",text:"清空历史记录",onClick:()=>{m(!0)}})):void 0),l.createElement("div",{className:"actions-right"},!(null==r?void 0:r.vipActivated)&&l.createElement("a",{style:{marginRight:15},onClick:()=>a(!0)},"将历史记录同步到云端"),l.createElement(i.XZ,{label:"启用历史记录",inline:!0,checked:n.historyEnabled,onChange:e=>{t({historyEnabled:e.target.checked})}}))),l.createElement("div",{className:"actions-bg",style:{height:"60px"}}),l.createElement("div",{style:{padding:"0 15px 15px 15px"}},v.map((({date:e,items:t})=>l.createElement(i.Zb,{key:e.getTime()},l.createElement(i.H3,null,function(e){if(!(0,R.Z)(e))return"";let t="";return(0,pl.Z)(e)?t="今天 - ":(0,El.Z)(e)&&(t="昨天 - "),t+(0,P.Z)(e,"yyyy 年 M 月 d 日 EEEE",{locale:fl.Z})}(e)),t.map((e=>{return l.createElement("p",{key:e.id,className:"history-item"},l.createElement("span",{className:"date"},l.createElement(i.XZ,{checked:u.selectedRows.includes(e.id),labelElement:l.createElement("span",{className:"bp3-text-muted"},kl(e.date)),onChange:()=>{f(e.id)}})),l.createElement("span",{className:"text"},e.text),(t=e.url).startsWith("chrome-extension://")||t.startsWith("moz-extension://")?l.createElement("span",{className:"bp3-text-small bp3-text-muted hostname",onClick:()=>{h("划词翻译")}},e.title):l.createElement(l.Fragment,null,l.createElement("img",{src:e.favicon,width:"12px",height:"12px",alt:""}),l.createElement("a",{className:"bp3-text-overflow-ellipsis",href:e.url,target:"_blank",rel:"noreferrer",title:e.title||e.url},e.title||e.url),l.createElement("span",{className:"bp3-text-small bp3-text-muted hostname",onClick:()=>{const t=wl(e.url);h(t)}},wl(e.url))));var t}))))),!u.loading&&!u.end&&l.createElement(i.zx,{onClick:d,text:"加载更多"}),u.loading&&l.createElement(i.$j,null),!u.loading&&!u.rows.length&&l.createElement(i.tR,{icon:"blank",title:u.searchText?"没有搜索结果":"无历史记录",description:n.historyEnabled?"":"若要记录翻译历史，请勾选上方的“启用历史记录”。"})))}),null)}),l.createElement(r.AW,{path:"stars",element:l.createElement((function(){const[e,t]=(0,b.Z)(Dn),n=e||Dn,{setShowVip:a}=(0,l.useContext)($),r=(0,l.useContext)(y),[c,s]=(0,l.useState)(!1),[o,m]=(0,l.useState)(!1),{tableData:u,queryNextPage:d,deleteSelected:p,clearData:E,setSearchText:h,cancelSelected:g,switchCheck:f}=vn(En,r,pn);return l.createElement("div",{id:"favorites"},l.createElement(i.bZ,{cancelButtonText:"取消",confirmButtonText:"确定",intent:"danger",isOpen:c,icon:"trash",onClose:e=>{e&&p(),s(!1)}},l.createElement("p",null,"确定要删除吗？")),l.createElement(i.bZ,{cancelButtonText:"取消",confirmButtonText:"确定",icon:"trash",intent:"danger",isOpen:o,onClose:e=>{e&&E(),m(!1)}},l.createElement("p",null,"确定要清空收藏夹吗？")),l.createElement("div",{className:"actions"},l.createElement("div",{className:"actions-left"},l.createElement(i.BZ,{className:"search-input",placeholder:"搜索收藏夹",rightElement:u.searchText?l.createElement(i.zx,{icon:"cross",minimal:!0,onClick:()=>{h("")}}):void 0,value:u.searchText,onChange:e=>{const t=e.target.value;h(t)}}),u.selectedRows.length?l.createElement(l.Fragment,null,l.createElement(i.zx,{text:`删除选中的收藏（${u.selectedRows.length}）`,intent:"primary",style:{marginLeft:"10px"},onClick:()=>{s(!0)}}),l.createElement(i.zx,{style:{margin:"0 10px"},text:"取消选择",onClick:g}),l.createElement(i.zx,{intent:"danger",text:"清空收藏夹",onClick:()=>{m(!0)}})):void 0),l.createElement("div",{className:"actions-right"},!(null==r?void 0:r.vipActivated)&&l.createElement("a",{style:{marginRight:15},onClick:()=>a(!0)},"将收藏夹同步到云端"),l.createElement(i.XZ,{label:"启用收藏功能",inline:!0,checked:n.favoritesEnabled,onChange:e=>{t({favoritesEnabled:e.target.checked})}}))),l.createElement("div",{className:"actions-bg",style:{height:"60px"}}),l.createElement("div",{className:"favorite-list"},u.rows.map((e=>l.createElement(Fn,{key:e.id,item:e,selected:u.selectedRows.includes(e.id),switchSelected:f})))),!u.loading&&!u.end&&l.createElement(i.zx,{onClick:d,text:"加载更多"}),u.loading&&l.createElement(i.$j,null),!u.loading&&!u.rows.length&&l.createElement(i.tR,{icon:"blank",title:u.searchText?"没有搜索结果":"无收藏",description:n.favoritesEnabled?"如果你不需要收藏功能，可以取消勾选上方的“启用收藏功能”，这样翻译面板上的收藏图标就会消失。":""}))}),null)}),l.createElement(r.AW,{path:"about",element:l.createElement((function(){return l.createElement("div",{style:{margin:"15px"}},l.createElement(i.H2,{id:"关于"},"关于划词翻译"),l.createElement("p",null,"划词翻译是一款简单好用的翻译软件，支持桌面端的 Chrome、Edge 和 Firefox 浏览器。"),l.createElement("p",null,"划词翻译由我个人创建于 2013 年，并持续维护至今。",l.createElement("a",{target:"_blank",rel:"noreferrer",href:"https://hcfy.app/docs/histroy"},"查看划词翻译大事记")),l.createElement("p",null,"如果你觉得划词翻译很好用，请给它一个五星好评！"),l.createElement("p",null,l.createElement(i.AN,{text:"给划词翻译一个五星好评",href:Kn,target:"_blank",rel:"noreferrer"})))}),null)}),l.createElement(r.AW,{path:"panel",element:l.createElement((function(){const e=(0,l.useContext)(y),[t,n]=(0,b.Z)(ml);return l.createElement("div",{style:{margin:15}},l.createElement(i.Zb,null,l.createElement(i.H4,{id:"启用翻译源"},"启用翻译源"),l.createElement(i.cw,{label:"直接显示结果",labelInfo:dl,helperText:"这些翻译源的结果会直接在翻译面板上显示出来。"},l.createElement(Tt.f,{selectedAPIs:(null==t?void 0:t.selectedAPIs)||[],onChange:e=>{n({selectedAPIs:e})}}),(null==t?void 0:t.selectedAPIs.includes("ALiOfficialDomain"))&&l.createElement("div",null,"请选择阿里翻译（专业版）的专业领域：",l.createElement(Xn,{value:t.aliDomain,onChange:e=>{n({aliDomain:e})}})),(null==t?void 0:t.selectedAPIs.includes("BaiDuDomain"))&&l.createElement("div",null,"请选择百度翻译（专业版）的专业领域：",l.createElement(Gn,{value:t.baiduDomain,onChange:e=>{n({baiduDomain:e})}}),t.baiduDomain&&Qn.includes(t.baiduDomain)&&l.createElement("p",{className:"bp3-text-small bp3-text-muted"},"百度翻译（专业版）的电子科技、水利机械、网络文学三个领域仅支持从中文翻译为英文，如果将英文翻译为中文，会默认显示普通的百度翻译结果。"))),l.createElement(i.cw,{label:"显示顺序",helperText:"翻译源的显示顺序跟你勾选的顺序一致。如果你想完全重新排序，可以取消勾选所有翻译源后重新勾选。"},!(null==t?void 0:t.selectedAPIs.length)&&"-",null==t?void 0:t.selectedAPIs.map(((e,t,n)=>{const a=jt.Y.find((t=>t.id===e)),r=t===n.length-1;return a?l.createElement("span",{key:a.id,style:r?void 0:{marginRight:3}},a.name,!r&&" >"):null}))),l.createElement(i.cw,{label:"跳转链接",helperText:"你可以在翻译面板上添加这些翻译服务的跳转链接，点击之后会打开在线翻译结果地址。"},l.createElement("div",{className:"external-translators"},l.createElement(tl,{selected:(null==t?void 0:t.selectedExternalLinks)||[],onChange:e=>{n({selectedExternalLinks:e})}})))),l.createElement(i.Zb,null,l.createElement(i.H4,null,"语种"),l.createElement(i.cw,{label:"源语种",labelInfo:dl,helperText:"当自动检测的语种不正确时，你可以指定源语种。"},l.createElement(kn.Z,{addAuto:!0,lang:t?t.source:ml.source,setLang:e=>{n({source:e})}})),l.createElement(i.cw,{label:"目标语种",labelInfo:dl,helperText:"划词翻译会优先将文本翻译为首要目标语种，如果文本的语种与首要目标语种相同，则会翻译为次要目标语种。"},l.createElement("div",null,"首要：",l.createElement(kn.Z,{lang:t?t.destination:ml.destination,setLang:e=>{n({destination:e})}})),"次要：固定为",l.createElement(kn.Z,{disabled:t?t.secondDestinationLatestSource:ml.secondDestinationLatestSource,lang:t?t.secondDestination:ml.secondDestination,setLang:e=>{n({secondDestination:e})}}),l.createElement("span",{style:{margin:"0 10px"}},"或者"),l.createElement(i.XZ,{style:{margin:0},inline:!0,disabled:!(null==e?void 0:e.vipActivated),labelElement:l.createElement(l.Fragment,null,"动态的设置为上次翻译的文本的语种 ",Le),checked:t?t.secondDestinationLatestSource:ml.secondDestinationLatestSource,onChange:e=>{n({secondDestinationLatestSource:e.target.checked})}})," ",l.createElement("a",{href:"https://hcfy.app/docs/guides/talk/#latest-source",target:"_blank",rel:"noreferrer"},"查看说明"))),l.createElement(i.Zb,null,l.createElement(i.H4,null,"自动化"),l.createElement(i.cw,{helperText:"点击扩展图标或使用全局快捷键打开独立窗口时，自动读取剪切板的文本或图片并翻译。"},l.createElement(i.Ee,{inline:!0,label:l.createElement(l.Fragment,null,"自动读取剪切板里的文本 ",dl),options:[{label:"询问",value:"null"},{label:"翻译",value:"true"},{label:"不翻译",value:"false"}],selectedValue:JSON.stringify(t?t.autoClipboard:ml.autoClipboard),onChange:e=>{n({autoClipboard:JSON.parse(e.currentTarget.value)})}}),l.createElement(i.Ee,{inline:!0,label:l.createElement(l.Fragment,null,"自动读取剪切板里的图片"),options:[{label:"询问",value:"null"},{label:"翻译",value:"true"},{label:"不翻译",value:"false"}],selectedValue:JSON.stringify(t?t.autoClipboardImage:ml.autoClipboardImage),onChange:e=>{n({autoClipboardImage:JSON.parse(e.currentTarget.value)})}})),l.createElement(i.cw,{helperText:"翻译后如果第一个翻译源可以朗读，则自动朗读被翻译的文本。为避免朗读时间过长，如果被翻译的文本超过了 30 个字符则不会朗读。"},l.createElement(i.rs,{labelElement:l.createElement(l.Fragment,null,"自动朗读 ",dl),checked:t?t.autoPlay:ml.autoPlay,onChange:e=>{n({autoPlay:e.target.checked})}})),l.createElement(i.cw,{helperText:"翻译后如果第一个翻译源有翻译结果，则自动将翻译结果复制进剪切板。"},l.createElement(i.rs,{labelElement:l.createElement(l.Fragment,null,"自动复制 ",dl," ",Le),disabled:!(null==e?void 0:e.vipActivated),checked:t?t.autoCopy:ml.autoCopy,onChange:e=>{n({autoCopy:e.target.checked})}}))),l.createElement(i.Zb,null,l.createElement(i.H4,{id:"快捷链接"},"快捷链接"),l.createElement(rl,{options:t,setOptions:n})),l.createElement(i.Zb,null,l.createElement(i.H4,null,"文本框"),l.createElement(i.cw,{helperText:"是否要在网页划词面板中显示文本框。在独立翻译窗口和扩展图标窗口中将始终显示文本框。"},l.createElement(i.XZ,{labelElement:l.createElement(l.Fragment,null,"显示文本框 ",dl),checked:t?t.showTextArea:ml.showTextArea,onChange:e=>{n({showTextArea:e.target.checked})}})),l.createElement(i.cw,null,l.createElement(i.XZ,{label:"粘贴文本后立刻翻译",checked:t?t.autoPaste:ml.autoPaste,onChange:e=>{n({autoPaste:e.target.checked})}})),l.createElement(i.cw,{helperText:"勾选后，你在文本框内停止输入超过 1 秒后会自动翻译文本框中的文本。如果你经常在文本框内输入大段的文本，建议不要启用此选项，因为这会导致输入过程中触发多次翻译，造成字符数的浪费。"},l.createElement(i.XZ,{label:"自动翻译文本框",checked:t?t.textAreaAuto:ml.textAreaAuto,onChange:e=>{n({textAreaAuto:e.target.checked})}})),l.createElement(i.cw,null,l.createElement(i.Ee,{inline:!0,label:"翻译快捷键",selectedValue:t?t.textAreaShortKey:ml.textAreaShortKey,onChange:e=>{const t=e.currentTarget.value;n({textAreaShortKey:t})},options:[{label:"Ctrl / ⌘ + Enter",value:"ctrl-enter"},{label:"Enter",value:"enter"}]}))),l.createElement(i.Zb,null,l.createElement(i.H4,null,"源文本处理",Le),l.createElement($n,null)),l.createElement(i.Zb,null,l.createElement(i.H4,null,"自定义界面"),l.createElement(i.cw,{label:"字体和按钮大小",labelInfo:dl},l.createElement(In.l,{value:(null==t?void 0:t.panelSize)||ml.panelSize,onChange:e=>{n({panelSize:e})}})),l.createElement(ol,null),l.createElement(i.cw,{label:"自定义面板样式",helperText:l.createElement(l.Fragment,null,"使用"," ",l.createElement("a",{href:"https://developer.mozilla.org/zh-CN/docs/Web/CSS",target:"_blank",rel:"noreferrer"},"CSS")," ","自定义面板样式。",l.createElement("a",{href:"https://github.com/lmk123/crx-selection-translate/discussions/950",target:"_blank",rel:"noreferrer"},"分享你的或查看其他人的自定义样式"))},l.createElement(i.Kx,{growVertically:!0,large:!0,fill:!0,onChange:e=>{n({panelCustomStyle:e.target.value})},value:(t?t.panelCustomStyle:ml.panelCustomStyle)||"#translate-panel {\n  /* 浅色模式下的面板样式 */\n}\n.bp3-dark #translate-panel {\n  /* 深色模式下的面板样式 */\n}",placeholder:"#translate-panel {\n  /* 浅色模式下的面板样式 */\n}\n.bp3-dark #translate-panel {\n  /* 深色模式下的面板样式 */\n}"}))),l.createElement(i.Zb,null,l.createElement(i.H4,null,"网页划词面板"),l.createElement(i.cw,{label:"面板宽度",helperText:"拖动面板的左右边缘可以调整面板的宽度。"},l.createElement(i.BZ,{disabled:!0,value:t?t.width+"px":ml.width+"px"})),l.createElement(i.cw,{helperText:"固定模式下，面板不会跟随浏览器滚动，且划词后会立刻显示翻译结果。点击面板左上角的图钉可以切换固定状态。"},"是否固定：",(t?t.pin:ml.pin)?"是":"否"),l.createElement(i.cw,{label:"面板位置",helperText:"固定模式下面板距离浏览器左上角的距离。拖动面板可以改变面板的位置。"},"左边距：",(null==t?void 0:t.pinPos)?t.pinPos.x+"px":"-",l.createElement("br",null),"上边距：",(null==t?void 0:t.pinPos)?t.pinPos.y+"px":"-"),l.createElement(i.cw,{helperText:"勾选后，当你拖动窗口时，弹窗会自动切换为固定状态。"},l.createElement(i.XZ,{labelElement:l.createElement(l.Fragment,null,"拖动窗口后自动切换为固定状态"),checked:t?t.pinAfterDrag:ml.pinAfterDrag,onChange:e=>{n({pinAfterDrag:e.target.checked})}})),l.createElement(i.cw,{helperText:"弹窗会先尝试朝这个方向显示，如果空间不够，它会自动调整方向确保处于可视区域内。"},l.createElement(i.Ee,{label:"弹窗显示方向",inline:!0,onChange:e=>{n({placement:e.target.value})},selectedValue:t?t.placement:ml.placement,className:"placement-group"},ul.map((e=>l.createElement(i.Y8,{value:e.value,label:e.label,key:e.value})))))),l.createElement(i.Zb,null,l.createElement(i.H4,{id:"独立翻译窗口"},"独立翻译窗口"),t&&l.createElement(i.cw,{label:"位置和宽高",helperText:"每当你对独立窗口进行调整后都会自动保存位置和宽高。"},l.createElement("p",null,"上边距：",t.panelPos.top,"px 左边距：",t.panelPos.left,"px",l.createElement("br",null),"宽度：",t.panelPos.width,"px 高度：",t.panelPos.height,"px"),l.createElement(i.zx,{onClick:()=>{n({panelPos:ml.panelPos}),m().runtime.sendMessage({action:"update panel pos"})}},"重置位置与大小"))))}),null)}))))),document.getElementById("app"))},7354:(e,t,n)=>{n.d(t,{I:()=>l,n:()=>a});const l=[{value:"translate",label:"翻译这段文本"},{value:"open-pdf-in-viewer",label:"在划词翻译中打开此 PDF（PDF 文件）"},{value:"open-link-in-viewer",label:"在划词翻译中打开此 PDF（PDF 链接）"},{value:"screen-translate",label:"截图翻译"},{value:"page-translate",label:"网页全文翻译"},{value:"video-translate",label:"音视频翻译"}],a=l.map((e=>e.value))},5127:(e,t,n)=>{n.d(t,{m:()=>a});var l=n(3364);class a extends Error{constructor(e,t){super(e),null!==(null==t?void 0:t.type)&&(this.type=(null==t?void 0:t.type)||"OTHER"),this.link=null==t?void 0:t.link,this.context=null==t?void 0:t.context,this.errors=null==t?void 0:t.errors,this.noRetry=null==t?void 0:t.noRetry}toJSON(){var e;return{type:this.type,message:this.message,link:this.link,errors:null===(e=this.errors)||void 0===e?void 0:e.map((e=>(0,l.R)(e).toJSON()))}}clone(){return new a(this.message,{context:this.context,type:this.type,link:this.link,errors:this.errors,noRetry:this.noRetry})}}},4194:(e,t,n)=>{n.d(t,{mD:()=>l.m,RE:()=>a.R});var l=n(5127),a=(n(9989),n(3364))},9989:(e,t,n)=>{n.d(t,{D:()=>a});var l=n(5127);function a(e){return e instanceof l.m?e:e instanceof Error?new l.m(e.message,{type:null}):new l.m("划词翻译内部出现了一个预期之外的错误，如果你看到了这条消息，请反馈给我。",{type:null})}},3364:(e,t,n)=>{n.d(t,{R:()=>s});var l=n(9669),a=n.n(l),r=n(5127),c=n(9989);const i={401:"登录状态已失效，请重新登录。"};function s(e){if(a().isAxiosError(e)){const t=function(e){var t;const{url:n,baseURL:l}=e;let a;try{a=new URL(n||"",l)}catch(e){return"远程服务器"}const{host:r}=a;return(null===(t="https://hs-api.limingkai.cn/")?void 0:t.includes(r))?"划词翻译服务器":"远程服务器"}(e.config),n="划词翻译服务器"===t;if(e.response){const l=e.response.status;return new r.m(n?i[l]||`划词翻译服务器内部产生了一个错误，请稍后重试。HTTP 响应码：${l}。`:`${t}返回了错误的 HTTP 响应码：${l}。`,{type:"API_SERVER_ERROR"})}return e.request?new r.m(`${t}没有响应。`,{type:"NETWORK_ERROR",link:{name:"查看解决方案",url:"划词翻译服务器"===t?"https://hcfy.app/docs/faq/#server-no-response":"https://hcfy.app/docs/faq/#why-services-always-loading"}}):new r.m(`向${t}发起请求时发生了一个错误：“${e.message}”`,{type:null})}return(0,c.D)(e)}}},n={};function l(e){var a=n[e];if(void 0!==a)return a.exports;var r=n[e]={exports:{}};return t[e].call(r.exports,r,r.exports,l),r.exports}l.m=t,e=[],l.O=(t,n,a,r)=>{if(!n){var c=1/0;for(m=0;m<e.length;m++){for(var[n,a,r]=e[m],i=!0,s=0;s<n.length;s++)(!1&r||c>=r)&&Object.keys(l.O).every((e=>l.O[e](n[s])))?n.splice(s--,1):(i=!1,r<c&&(c=r));if(i){e.splice(m--,1);var o=a();void 0!==o&&(t=o)}}return t}r=r||0;for(var m=e.length;m>0&&e[m-1][2]>r;m--)e[m]=e[m-1];e[m]=[n,a,r]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={961:0};l.O.j=t=>0===e[t];var t=(t,n)=>{var a,r,[c,i,s]=n,o=0;if(c.some((t=>0!==e[t]))){for(a in i)l.o(i,a)&&(l.m[a]=i[a]);if(s)var m=s(l)}for(t&&t(n);o<c.length;o++)r=c[o],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return l.O(m)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=l.O(void 0,[473,150,875,967,209,697,969,141,125],(()=>l(3951)));a=l.O(a)})();