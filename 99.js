"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[99],{9966:(e,t,a)=>{a.d(t,{$o:()=>i});var n=a(124),l=a(3326),r=a(3150),s=a.n(r),o=a(3417);const i=!0,c={id:"bdocr",name:"百度文字识别",points:!0,secretKeys:{get:()=>s().storage.local.get({baiDuOCRKey:[]}).then((({baiDuOCRKey:e})=>(Array.isArray(e)?e:[e]).map((e=>({id:e.key,key:e.secret}))))),set:e=>s().storage.local.set({baiDuOCRKey:e.map((e=>({key:e.id,secret:e.key})))}),isComplete:e=>(0,o.dz)(e,["id"])},pointsEnable:{get:()=>s().storage.local.get({bdOcrPoints:i}).then((({bdOcrPoints:e})=>e)),set:e=>s().storage.local.set({bdOcrPoints:e})}};class u extends n.E{constructor(){super(c,!0)}callBySecretKey(e,t){return new l.w(e).ocr(t.image)}transform(e){if(!e.paragraphs_result)throw new Error("百度文字识别服务配置有误，请确认你领取过免费资源包，且密钥填写无误。");return e.paragraphs_result.reduce(((t,{words_result_idx:a})=>(t.push(a.reduce(((t,a)=>t+e.words_result[a].words),"")),t)),[]).join("\n")}}new u},6372:(e,t,a)=>{a.d(t,{wm:()=>i,Xn:()=>c,Lx:()=>d,zr:()=>p});var n=a(1227),l=a.n(n),r=a(3938);const s=l()("web-speech"),o=window.SpeechRecognition||window.webkitSpeechRecognition,i=!!o,c={"cnm-Hans-CN":"中文(简体)","en-US":"英语(美国)","ja-JP":"日语","ko-KR":"韩语","fr-FR":"法语","de-DE":"德语","ru-RU":"俄语"},u={"audio-capture":"你的电脑没有连接麦克风。","no-speech":"没有检测到语音。","not-allowed":"请在浏览器询问是否允许使用麦克风时选择“允许”。如果你之前选择过“禁止”，请点击浏览器地址栏左侧的锁或感叹号图标，然后将“麦克风”改为“允许”。如果浏览器从未询问过，则说明当前页面由于未知的原因不允许使用麦克风。","service-not-allowed":"你的浏览器当前不允许使用划词翻译的内置语音识别服务。",network:"网络出错，请检查你的网络连接。注意：划词翻译内置的语音转文字服务需要能连接外网才可使用。","language-not-supported":"你的浏览器不支持识别此语种。",aborted:"识别过程被中断了。","bad-grammar":"语法错误。"},m=/\S/;const d={id:"default-speech",name:"划词翻译内置语音转文字",realtime:!0,defaultLang:"cnm-Hans-CN"};class v extends r.Z{constructor(){super(d)}async microphone(e){const{lang:t,options:a}=e;if(!i)throw new Error("划词翻译的内置语音转文字服务不支持在 Firefox 上使用，请选用腾讯云语音转文字服务。");let n=!1,l=!1;const r=new o;r.lang=t,r.interimResults=!!a.onInterim,r.continuous=!a.stopOnFirstSentence,r.addEventListener("error",(e=>{var t;s("error 事件",e),"aborted"===e.error&&n||(n=!0,null===(t=a.onError)||void 0===t||t.call(a,new Error(`${u[e.error]||e.error+". "}${e.message||""}`)))}));const c=[];return r.addEventListener("result",(e=>{var t,n;const l=e.results[e.resultIndex],r=l[0].transcript;if(l.isFinal){const e=r.replace(m,(function(e){return e.toUpperCase()}));s("识别到一句完整的话：",e),null===(t=a.onSentence)||void 0===t||t.call(a,e),c.push(e)}else s("识别到一句话的临时结果：",r),null===(n=a.onInterim)||void 0===n||n.call(a,r)})),r.addEventListener("nomatch",(e=>{var t;s("nomatch 事件",e),l=!0,null===(t=a.onError)||void 0===t||t.call(a,new Error(`${this.service.name}无法准确识别你的语音，请确保在安静的环境中，并吐字清晰。`))})),r.addEventListener("end",(e=>{var t;s("end 事件",e,"识别出来的文本：",c,`是否已经中断：${n}`,`是否已经 nomatch：${l}`),n||l||null===(t=a.onStop)||void 0===t||t.call(a,c)})),r.start(),{stop:()=>{s("调用 stop 方法"),r.stop()},abort:()=>{s("调用 abort 方法"),n=!0,r.abort()}}}mediaStream(e){return Promise.reject(new Error("划词翻译的内置语音转文字服务只支持通过麦克风使用。"))}}const p=new v},8028:(e,t,a)=>{a.d(t,{k:()=>x});var n=a(7294),l=a(966),r=a(4538),s=a(9025),o=a(9970),i=a(1515),c=a(1922),u=a(6372),m=a(3281),d=a(4194),v=a(4185);const p=new s.P("sttLimit",3),g=(0,i.Z)(o.q,["tipForSTTClosed"]);function x(e){const{isLarge:t,isSmall:a,iconSize:s,onSelect:o,portalContainer:i}=e,[x,f]=(0,c.Z)(g),[h,E]=(0,n.useState)(!1),[w,y]=(0,n.useState)("default-speech"),[k,b]=(0,n.useState)(""),[C,S]=(0,n.useState)(""),[R,I]=(0,n.useState)(""),{serviceImplement:z,langMap:Z}=(0,n.useMemo)((()=>{switch(w){case"TencentRealtime":return{serviceImplement:m.Uz,langMap:m.PK};case"default-speech":return{serviceImplement:u.zr,langMap:u.Xn}}}),[w]);return(0,n.useEffect)((()=>{switch(w){case"TencentRealtime":b(m.Ty.defaultLang);break;case"default-speech":b(u.Lx.defaultLang)}}),[w]),(0,n.useEffect)((()=>{if(!h)return;const e=[];let t,a=!1;const n=e=>{window.alert((0,d.DR)(e).message),E(!1)};return z.microphone({lang:k,options:{stopOnFirstSentence:!0,onError:n,onSentence:t=>{e.push(t),S(e.join(""))},onInterim:t=>{I(e.join("")+t)},onStop:e=>{e.length?(p.addOne(),o(e.join(""))):window.alert("未识别出任何文本，请重试。"),E(!1)}}}).then((e=>{a?null==e||e.abort():t=e}),n),()=>{a=!0,null==t||t.abort(),S(""),I("")}}),[h,k,o,z]),n.createElement(n.Fragment,null,n.createElement(l.zx,{icon:n.createElement(r.R,{iconSize:s}),small:a,large:t,minimal:!0,title:"语音翻译",onClick:u.wm?()=>{x&&!x.tipForSTTClosed&&(window.alert("语音翻译功能目前只有在你的电脑能访问外网的情况下才能使用。未来的版本中会改善此情况，届时会另行通知。"),f({tipForSTTClosed:!0})),p.isOver().then((e=>{e?window.alert("非会员用户每天只能使用 3 次语音翻译功能，成为会员即可解除此限制。"):E(!0)}))}:()=>{window.alert("Firefox 暂时不支持语音翻译功能，请在其它浏览器上使用。未来的版本中会添加对 Firefox 浏览器的支持，届时会另行通知。")}}),n.createElement(l.Vq,{isOpen:h,enforceFocus:!1,portalContainer:i},n.createElement("div",{className:"bp3-dialog-body"},n.createElement("div",{style:{marginBottom:10}},"选择服务：",n.createElement(l.Lu,{onChange:e=>{y(e.currentTarget.value)},large:t,value:w},v.pB.map((e=>n.createElement("option",{key:e.id,value:e.id},e.name)))),"切换语种：",n.createElement(l.Lu,{onChange:e=>{b(e.currentTarget.value)},large:t,value:k},Object.keys(Z).map((e=>n.createElement("option",{key:e,value:e},Z[e]||e))))),n.createElement(l.BZ,{value:C||R,readOnly:!0,placeholder:"请讲，我正在听……"})),n.createElement("div",{className:"bp3-dialog-footer"},n.createElement("div",{className:"bp3-dialog-footer-actions"},n.createElement(l.zx,{large:t,onClick:()=>{E(!1)}},"取消")))))}},5487:(e,t,a)=>{a.d(t,{j:()=>v});var n=a(3150),l=a.n(n),r=a(7294),s=a(966);function o(e){const{fileInputProps:t,initialText:a="请选择",onInputChange:n}=e,[l,o]=(0,r.useState)(!1),[i,c]=(0,r.useState)(a);return r.createElement(s.S2,{text:i,hasSelection:l,buttonText:"浏览",onInputChange:e=>{var t;const l=null===(t=e.target.files)||void 0===t?void 0:t[0];l?(o(!0),c(l.name)):(o(!1),c(a)),null==n||n(e)},...t})}var i=a(5976),c=a(1515),u=a(9970),m=a(1922);const d=(0,c.Z)(u.q,["localOCR","ocrService"]);function v(e){var t;const{isLarge:a,isSmall:n,iconSize:c,onSelect:u,portalContainer:v}=e,[p,g]=(0,m.Z)(d),[x,f]=(0,r.useState)(""),[h,E]=(0,r.useState)(!1),w="tesseractocr"===(null==p?void 0:p.ocrService),[y,k]=(0,r.useState)(!1),b=()=>{k(!1),f(""),E(!1)};return r.createElement(r.Fragment,null,r.createElement(s.zx,{icon:r.createElement(s.JO,{icon:"media",iconSize:c}),small:n,large:a,minimal:!0,title:"图片翻译",onClick:()=>{k(!0)}}),r.createElement(s.Vq,{isOpen:y,enforceFocus:!1,portalContainer:v},r.createElement("form",null,r.createElement("div",{className:"bp3-dialog-body"},r.createElement("p",null,r.createElement(o,{initialText:"选择图片",onInputChange:e=>{var t;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&function(e){return new Promise(((t,a)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=()=>a(n.error),n.readAsDataURL(e)}))}(a).then((e=>{w?(f(e),E(!1)):(b(),u(e))}),(e=>{window.alert(`读取图片失败，错误消息：${e.message}`)}))},fileInputProps:{inputProps:{accept:"image/*",required:!0},fill:!0,large:a}})),r.createElement("p",null,"或者"," ",r.createElement(s.zx,{small:n,large:a,onClick:()=>{l().runtime.sendMessage({action:"read clipboard image"}).then((e=>{e?w?(f(e),E(!0)):(b(),u(e)):window.alert("剪切板内没有图片。")}))}},"读取剪切板内的图片"),h&&r.createElement("span",{style:{marginLeft:5}},"已读取")),w&&x&&r.createElement("div",null,r.createElement("div",null,"选择语种：",r.createElement(i.U,{value:(null===(t=null==p?void 0:p.localOCR)||void 0===t?void 0:t.lang)||d.localOCR.lang,onChange:e=>{g((t=>{t.localOCR.lang=e}))},isLarge:a,isSmall:n,portalContainer:v})),r.createElement(s.zx,{small:n,large:a,intent:"primary",onClick:()=>{b(),u(x)}},"确定"))),r.createElement("div",{className:"bp3-dialog-footer"},r.createElement("div",{className:"bp3-dialog-footer-actions"},r.createElement(s.zx,{small:n,large:a,type:"reset",onClick:b},"取消"))))))}},5977:(e,t,a)=>{a.d(t,{H:()=>m,Z:()=>v});var n=a(3150),l=a.n(n),r=a(5601),s=a(966),o=a(7294),i=a(657),c=a(2610);const u={small:12,middle:16,large:20};function m(){l().runtime.sendMessage({action:"open options page",suffix:"?vip"}).catch((e=>{window.alert("打开设置页时发生了一个错误。错误消息：："+(null==e?void 0:e.message))}))}function d(e){l().runtime.sendMessage({action:"open options page",suffix:e}).catch((e=>{window.alert("打开设置页时发生了一个错误。错误消息：："+(null==e?void 0:e.message))}))}function v(e){const{source:t,setSource:a,options:n,setOptions:l,user:v,children:p,size:g,portalContainer:x}=e;if(!n)return null;const f="large"===g,h=(e,t)=>{l((a=>{const n=a[t],l=n.indexOf(e);l>=0?n.splice(l,1):4===n.length&&n.pop(),n.unshift(e)}))};return o.createElement(s.Zb,{className:"quick-settings"},o.createElement("div",null,o.createElement(r.Z,{lang:t,setLang:e=>{a(e),h(e,"recentUseLangFrom")},addAuto:!0,recentUse:n.recentUseLangFrom,size:g,portalContainer:x}),o.createElement(s.JO,{icon:"arrow-right",iconSize:u[g],style:{margin:"0 10px"}}),o.createElement(r.Z,{lang:n.destination,setLang:e=>{l({destination:e}),h(e,"recentUseLangTo")},recentUse:n.recentUseLangTo,size:g,portalContainer:x})),o.createElement("div",null,o.createElement(c.f,{useShortName:!0,selectedAPIs:n.selectedAPIs,onChange:e=>{l({selectedAPIs:e})}})),o.createElement("div",null,o.createElement(s.XZ,{inline:!0,label:"自动朗读",large:f,checked:n.autoPlay,onChange:e=>{l({autoPlay:e.target.checked})}}),o.createElement(s.u,{interactionKind:"hover",hoverCloseDelay:300,enforceFocus:!1,portalContainer:x,disabled:(null==v?void 0:v.vipActivated)||!1,content:o.createElement(o.Fragment,null,"这是一个会员功能，请在",o.createElement("a",{onClick:m},"开通会员"),"后使用。")},o.createElement(s.XZ,{inline:!0,label:"自动复制",disabled:!(null==v?void 0:v.vipActivated),checked:n.autoCopy,onChange:e=>{l({autoCopy:e.target.checked})}}))),o.createElement(i.l,{value:n.panelSize,onChange:e=>{l({panelSize:e})}}),p&&o.createElement("div",null,p),o.createElement("a",{onClick:()=>d(),className:"bp3-text-small"},"打开完整设置"),!(null==v?void 0:v.vipActivated)&&o.createElement("a",{onClick:()=>d("?vip"),className:"bp3-text-small",style:{marginLeft:15}},o.createElement(s.JO,{icon:"crown",iconSize:14,style:{position:"relative",top:-1}})," ","开通会员"))}},3937:(e,t,a)=>{a.d(t,{Z:()=>u});var n=a(966),l=a(7294),r=a(1922),s=a(1515),o=a(9970),i=a(9784);const c=(0,s.Z)(o.q,"selectedAPIs");function u(){const[e,t]=(0,r.Z)(c);return l.createElement(l.Fragment,null,i.Y.map((a=>l.createElement(n.sN,{key:a.id,text:a.name,onClick:()=>(e=>{const a=e.id;t((e=>{const t=e.selectedAPIs;t.indexOf(a)<0&&t.push(a)}))})(a),disabled:!e||e.selectedAPIs.includes(a.id)}))))}},6983:(e,t,a)=>{a.d(t,{h:()=>g,Z:()=>k});var n=a(3150),l=a.n(n),r=a(7294),s=a(966),o=a(4184),i=a.n(o),c=a(2054),u=a(5601),m=a(4076),d=a(9784),v=a(5539),p=a(8140);async function g(e){l().runtime.sendMessage({action:"audio",url:e}).catch((e=>{window.alert("朗读时出错："+(null==e?void 0:e.message))}))}function x(e){const t=e.uri,a=e.size,n=e.style;return r.createElement(s.zx,{style:n,icon:r.createElement(s.JO,{icon:"volume-up",iconSize:w[a]}),small:"small"===a,large:"large"===a,minimal:!0,disabled:!t,onClick:t?()=>g(t):void 0,title:t?"朗读":"不支持此语种"})}function f(e,t){const a="GoogleWeb"===t,n=[];return!e.phonetic||a&&!e.dict||n.push(e.phonetic.map((e=>`${e.name?e.name+" ":""}/${e.value}/`))),e.dict?n.push(...e.dict.map((e=>`${e.pos?e.pos+(a?": ":" "):""}${e.terms.join(", ")}`))):e.result&&n.push(...e.result),l().runtime.sendMessage({action:"write to clipboard",text:n.join("\n")})}function h(e){e.stopPropagation()}const E=/\b[A-Z\s\-'a-z]+\b/g;const w={small:12,middle:16,large:20};function y(e){switch(e){case"美":return"英语(美国)";case"英":return"英语(英国)";default:return}}function k(e){var t;const{apiId:a,result:{loading:n,result:l}={loading:!1,result:null},queryResult:o,autoCopy:k=!1,autoPlay:b=!1,wordClickable:C=!0,setQuery:S=c.Z,size:R="small",collapse:I,onCollapseChange:z,portalContainer:Z}=e,P=w[R],O="small"===R,T="large"===R,[N,F]=(0,r.useState)("duplicate"),[A,L]=(0,r.useState)(),$=d.Y.find((e=>e.id===a))||{name:a,id:a},U=()=>{F("tick"),L("success"),window.setTimeout((()=>{F("duplicate"),L(void 0)}),1e3)};(0,r.useEffect)((()=>{var e;l&&b&&l.text.length<30&&g({apiId:a,source:l.from,text:l.text,ttsURI:(null===(e=l.phonetic)||void 0===e?void 0:e[0].ttsURI)||l.ttsURI})}),[a,b,l]),(0,r.useEffect)((()=>{l&&k&&f(l,a).then((e=>{e?U():window.alert("自动复制翻译结果失败，请稍后重试。")}),(e=>{window.alert(`自动复制翻译结果时发生了一个错误：${null==e?void 0:e.message}`)}))}),[l,k,a]);const D=v.q[a];return r.createElement(s.Zb,{className:"result-block",onClick:h},r.createElement("div",{className:"legend"},r.createElement("div",{className:"legend-left"},r.createElement("span",{className:"api-ico",style:D?{backgroundImage:`url(${D})`}:void 0}),r.createElement(s.H6,null,$.name),l&&r.createElement(r.Fragment,null,r.createElement(u.Z,{lang:l.from,setLang:o,size:"small",maxHeight:212,portalContainer:Z},r.createElement("span",{className:"source"},r.createElement("span",{className:"source-text"},l.from),r.createElement(s.JO,{icon:"caret-down",iconSize:12}))),r.createElement(x,{uri:{apiId:a,source:l.from,text:l.text,ttsURI:(null===(t=l.phonetic)||void 0===t?void 0:t[0].ttsURI)||l.ttsURI},size:R}))),r.createElement("div",{style:{flexShrink:0}},void 0!==I&&r.createElement(s.zx,{minimal:!0,small:O,large:T,title:I?"展开":"收起",onClick:()=>{z&&z(!I)},icon:r.createElement(s.JO,{icon:I?"chevron-down":"chevron-up",iconSize:P+2})}),r.createElement(s.zx,{onClick:()=>{l&&f(l,a).then((e=>{e?U():window.alert("复制翻译结果失败，请稍后重试。")}),(e=>{window.alert(`复制翻译结果时发生了一个错误：${null==e?void 0:e.message}`)}))},disabled:!l||!!l.error,icon:r.createElement(s.JO,{icon:N,iconSize:P}),minimal:!0,small:O,large:T,intent:A,title:"复制翻译结果"}),r.createElement(s.AN,{disabled:!(null==l?void 0:l.link),target:"_blank",href:(null==l?void 0:l.link)||"",icon:r.createElement(s.JO,{icon:"share",iconSize:P}),minimal:!0,small:O,large:T,title:"查看详细结果"}))),r.createElement(s.UO,{isOpen:!I},r.createElement("div",{style:{display:n?"block":"none"}},r.createElement("p",{className:i()({"bp3-skeleton":n})},"1"),r.createElement("p",{className:i()({"bp3-skeleton":n}),style:{width:"150px"}},"1")),(null==l?void 0:l.error)&&r.createElement("div",{className:"error"},r.createElement(p.i,{error:l.error,onRetry:()=>o()})),(null==l?void 0:l.phonetic)&&r.createElement("div",{className:"phonetic"},l.phonetic.map(((e,t)=>r.createElement("div",{key:t,className:"phonetic-item",style:{maxWidth:"100%"}},e.name&&r.createElement("span",{style:{flexShrink:0,marginRight:5}},e.name),e.value&&r.createElement(m.Z,null,"/",e.value,"/"),e.ttsURI&&r.createElement(x,{style:{flexShrink:0},uri:{apiId:a,source:y(e.name)||l.from,text:l.text,ttsURI:e.ttsURI},size:R}))))),l&&r.createElement("div",{className:"common-result"},l.dict&&r.createElement("div",{className:"dict"},l.dict.map(((e,t)=>{const n=e.terms.join(", ");return r.createElement("p",{key:t},e.pos&&r.createElement("span",{className:"dict-pos"},e.pos,"GoogleWeb"===a?": ":""),C?function(e,t){const a=Array.from(e.matchAll(E)),n=e.split(E);return r.createElement(r.Fragment,null,n.map(((e,n)=>{const l=a[n];return r.createElement(r.Fragment,{key:n},e,l?r.createElement("a",{onClick:()=>t(l[0])},l[0]):"")})))}(n,S):n)}))),!l.dict&&l.result&&r.createElement("div",{className:"general-result"},l.result.map(((e,t)=>r.createElement("p",{key:t},e,r.createElement(x,{uri:{text:e,apiId:a,source:null==l?void 0:l.to},size:R}))))))))}},1587:(e,t,a)=>{a.d(t,{H:()=>g});var n=a(966),l=a(7294),r=a(1627),s=a(4304),o=a(2852),i=a(1515),c=a(9970),u=a(1922),m=a(3150),d=a.n(m);const v=o.oJ.ctrl,p={...(0,i.Z)(c.q,["textAreaShortKey","autoPaste"]),...(0,i.Z)(c.d,["tipForPasteTranslateClosed"])},g=(0,l.forwardRef)((function(e,t){const{isSmall:a,isLarge:o,value:i,onChange:c,onTranslate:m,iconSize:g,hideBtn:x,auto:f}=e,[h,E]=(0,u.Z)(p),w=(null==h?void 0:h.textAreaShortKey)||p.textAreaShortKey,y=(0,l.useRef)(null),[k,b]=(0,l.useState)(!1),{msg:C,textareaPlaceholder:S}=(0,l.useMemo)((()=>{const e=("ctrl-enter"===w?"Ctrl / ⌘ + ":"")+"Enter";return{msg:`翻译文本框内的文本(${e})`,textareaPlaceholder:`按下 ${e} 也可以翻译文本框内的文本`}}),[w]),R=(0,s.j)(),I=(0,r.H)(y.current);return(0,l.useEffect)((()=>{if(!f)return;const e=setTimeout(m,1e3);return()=>{clearTimeout(e)}}),[f,m]),(0,l.useImperativeHandle)(t,(()=>({select(){var e;null===(e=y.current)||void 0===e||e.select()}})),[]),l.createElement("div",{className:"query-text"},l.createElement(n.Kx,{fill:!0,small:a,large:o,inputRef:y,value:i,placeholder:S,onChange:e=>{c(e.target.value)},onKeyDown:e=>{e.stopPropagation(),("ctrl-enter"!==w||e[v])&&13===e.keyCode&&(e.preventDefault(),m())},onPaste:(null==h?void 0:h.autoPaste)?e=>{e.clipboardData.getData("text").trim()&&(b(!0),setTimeout((()=>{m(e.target.value)})))}:void 0}),!(null==h?void 0:h.tipForPasteTranslateClosed)&&k&&l.createElement(n.UW,{title:"自 v8.6.5 起，在文本框中粘贴文本后会立刻触发翻译。"},"你可以在",l.createElement("a",{onClick:()=>{d().runtime.sendMessage({action:"open options page",suffix:"#/panel"})}},"“设置” - “翻译面板”")," ","- “文本框”中关闭此功能。",l.createElement("a",{onClick:()=>{E({tipForPasteTranslateClosed:!0})}},"不再提示")),l.createElement(n.zx,{className:"translate-btn",style:{display:x?"none":void 0,right:18+(I.v&&R||0),bottom:8+(I.h&&R||0)},title:C,icon:l.createElement(n.JO,{icon:"search",iconSize:g}),small:a,large:o,intent:"primary",onClick:()=>{var e;m(),null===(e=y.current)||void 0===e||e.focus()}}))}))},473:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(3150),l=a.n(n),r=a(7294);function s(e,t,a){const[n,s]=(0,r.useState)(!1);(0,r.useEffect)((()=>{l().runtime.sendMessage({action:"is text in favorites",text:e}).then(s)}),[e]);const o=(0,r.useCallback)((()=>{l().runtime.sendMessage({action:"delete record in favorites",text:e}).catch((e=>{window.alert(`从收藏夹中删除时发生了一个错误：${null==e?void 0:e.message}`)})),s(!1)}),[e]),i=(0,r.useCallback)((()=>{e&&a&&(t({type:"save favorites",text:e,selectedAPIs:a}),s(!0))}),[t,a,e]);return{isInFavorites:n,saveOrDelete:n?o:i}}},2630:(e,t,a)=>{a.d(t,{n:()=>p});var n=a(3150),l=a.n(n),r=a(7294),s=a(8172),o=a(8707),i=a(2414);const c={results:{}},u=(e,t)=>(0,s.ZP)(e,(e=>{switch(t.type){case"set loading":return void(t.value?e.results[t.apiId]={loading:!0,result:null}:(0,o.Z)(e.results,[t.apiId,"loading"],!1));case"set result":return void(0,o.Z)(e.results,[t.apiId,"result"],t.result);case"clear results":return void(e.results={});case"save favorites":const a=t.selectedAPIs,n={};return(0,i.Z)(e.results,((e,t)=>{if(!e||e.loading)return;const l=e.result;l&&a.includes(t)&&(n[t]=(0,s.Js)(l))})),void l().runtime.sendMessage({action:"save favorite",record:{text:t.text,results:n}}).catch((e=>{window.alert(`保存到收藏夹时发生了一个错误：${null==e?void 0:e.message}`)}))}}));var m=a(7176),d=a(6749),v=a(9225);function p(e,t,a,n){const s=(0,r.useRef)(""),[o,i]=(0,r.useReducer)(u,c),p=(0,m.Z)(e),g=(0,m.Z)(a),x=(0,m.Z)(t),f=(0,m.Z)(n),h=async(e,t,a,n=(()=>!1))=>{let r;i({type:"set loading",apiId:t,value:!0});try{r=await l().runtime.sendMessage({action:"translate",data:{apiCode:t,text:e,source:a}})}catch(a){if(n())return;return i({type:"set loading",apiId:t,value:!1}),void i({type:"set result",apiId:t,result:{text:e,error:{message:(null==a?void 0:a.message)||"未知错误"}}})}if(!n()&&(i({type:"set loading",apiId:t,value:!1}),r)){if("GoogleWeb"===t){const e=r.from;e&&"中文(简体)"!==e&&l().storage.local.set({latestSource:e})}i({type:"set result",apiId:t,result:r})}};return(0,r.useEffect)((()=>{if(!n)return;if(e===p&&a===g&&n===f)return;i({type:"clear results"});const l=(0,d.Z)();if(s.current=l,!e)return;const r=()=>l!==s.current;null==t||t.forEach((t=>{h(e,t,a,r)}))}),[n,e,t,a]),(0,r.useEffect)((()=>{if(!x||!t)return;const n=(0,v.Z)(t,x);if(!n.length)return;const l=s.current,r=()=>l!==s.current;n.forEach((t=>{o.results[t]||h(e,t,a,r)}))}),[e,o.results,t,a]),{results:o,queryResult:h,dispatchResults:i}}},9554:(e,t,a)=>{a.d(t,{Z:()=>m});var n=a(3150),l=a.n(n),r=a(8172),s=a(6749),o=a(7294);let i="";const c=document.querySelector('link[rel=icon],link[rel="shortcut icon"]');i=c?c.href:window.location.origin+"/favicon.ico";const u=(0,r.ZP)(((e,t)=>{if("save translate record"===t.type){const a=Date.now(),n=(0,s.Z)(a+"-");return e.translateId=n,void l().runtime.sendMessage({action:"save history record",record:{text:t.text,date:a,url:window.location.href,title:document.title,favicon:i}}).catch((e=>{window.alert(`保存历史记录时发生了一个错误：${null==e?void 0:e.message}`)}))}}));function m(){return(0,o.useReducer)(u,{translateId:""})}},1520:(e,t,a)=>{a.d(t,{_:()=>d});var n=a(3150),l=a.n(n),r=a(1515),s=a(9970),o=a(966),i=a(7294),c=a(5977);const u=(0,r.Z)(s.q,["ocrService"]);function m(){return i.createElement(i.Fragment,null,i.createElement("div",null,"正在从截图中提取文本，请稍候……"),i.createElement("div",{className:"bp3-text-muted bp3-text-small"},i.createElement("div",{style:{marginTop:4}},i.createElement("a",{href:"https://hcfy.app/docs/guides/screenshot#slow",target:"_blank",rel:"noreferrer"},"为什么还没有提取成功？"))))}function d(e){return(0,i.useCallback)((async t=>{const{ocrService:a}=await l().storage.local.get(u),n="tesseractocr"===a,r=null==e?void 0:e.show({message:n?i.createElement(m,null):"正在从截图中提取文本，请稍候……",timeout:0});return l().runtime.sendMessage({action:"ocr",dataURI:t}).then((t=>(r&&(null==e||e.dismiss(r)),t)),(t=>(null==e||e.show({message:(null==t?void 0:t.message.includes("会员"))?i.createElement(i.Fragment,null,i.createElement("p",null,t.message),i.createElement(o.zx,{onClick:c.H,small:!0},"开通会员")):`从图片中提取文字时发生了一个错误：${null==t?void 0:t.message}`,intent:"warning",timeout:0},r),Promise.reject(t))))}),[e])}},5976:(e,t,a)=>{a.d(t,{U:()=>u});var n=a(1483),l=a(966);const r=[],s=[{text:"中文(简体)",value:"chi_sim"},{text:"中文(繁体)",value:"chi_tra"},{text:"英语",value:"eng"},{text:"日语",value:"jpn"},{text:"法语",value:"fra"},{text:"韩语",value:"kor"},{text:"德语",value:"deu"},{text:"俄语",value:"rus"},{text:"泰语",value:"tha"},{text:"南非语",value:"afr"},{text:"阿姆哈拉语",value:"amh"},{text:"阿拉伯语",value:"ara"},{text:"阿萨姆语",value:"asm"},{text:"阿塞拜疆语",value:"aze"},{text:"阿塞拜疆语(西里尔)",value:"aze_cyrl"},{text:"白俄罗斯语",value:"bel"},{text:"孟加拉语",value:"ben"},{text:"藏语",value:"bod"},{text:"波斯尼亚语",value:"bos"},{text:"保加利亚语",value:"bul"},{text:"加泰罗尼亚语(瓦伦西亚)",value:"cat"},{text:"宿务语",value:"ceb"},{text:"捷克语",value:"ces"},{text:"切罗基语",value:"chr"},{text:"威尔士语",value:"cym"},{text:"丹麦语",value:"dan"},{text:"宗喀语",value:"dzo"},{text:"希腊语(现代)",value:"ell"},{text:"中古英语",value:"enm"},{text:"世界语",value:"epo"},{text:"爱沙尼亚语",value:"est"},{text:"巴斯克语",value:"eus"},{text:"波斯语",value:"fas"},{text:"芬兰语",value:"fin"},{text:"德文尖角体",value:"frk"},{text:"中古法语",value:"frm"},{text:"爱尔兰语",value:"gle"},{text:"希腊语(古代)",value:"grc"},{text:"古吉拉特语",value:"guj"},{text:"海地克里奥尔语",value:"hat"},{text:"希伯来语",value:"heb"},{text:"印地语",value:"hin"},{text:"克罗地亚语",value:"hrv"},{text:"匈牙利语",value:"hun"},{text:"因纽特语",value:"iku"},{text:"印度尼西亚语",value:"ind"},{text:"冰岛语",value:"isl"},{text:"意大利语",value:"ita"},{text:"意大利语(古代)",value:"ita_old"},{text:"爪哇语",value:"jav"},{text:"坎纳达语",value:"kan"},{text:"格鲁吉亚语",value:"kat"},{text:"格鲁吉亚语(古代)",value:"kat_old"},{text:"哈萨克语",value:"kaz"},{text:"高棉语",value:"khm"},{text:"吉尔吉斯语",value:"kir"},{text:"库尔德语",value:"kur"},{text:"老挝语",value:"lao"},{text:"拉丁语",value:"lat"},{text:"拉脱维亚语",value:"lav"},{text:"立陶宛语",value:"lit"},{text:"马拉雅拉姆语",value:"mal"},{text:"马拉地语",value:"mar"},{text:"马其顿语",value:"mkd"},{text:"马耳他语",value:"mlt"},{text:"马来语",value:"msa"},{text:"缅甸语",value:"mya"},{text:"尼泊尔语",value:"nep"},{text:"荷兰语(弗拉芒)",value:"nld"},{text:"挪威语",value:"nor"},{text:"奥里亚语",value:"ori"},{text:"旁遮普语",value:"pan"},{text:"波兰语",value:"pol"},{text:"葡萄牙语",value:"por"},{text:"普什图语",value:"pus"},{text:"罗马尼亚语",value:"ron"},{text:"梵语",value:"san"},{text:"僧伽罗语",value:"sin"},{text:"斯洛伐克语",value:"slk"},{text:"斯洛维尼亚语",value:"slv"},{text:"西班牙语",value:"spa"},{text:"西班牙语(古代)",value:"spa_old"},{text:"阿尔巴尼亚语",value:"sqi"},{text:"塞尔维亚语",value:"srq"},{text:"塞尔维亚语(拉丁)",value:"srq_latn"},{text:"斯瓦希里语",value:"swa"},{text:"瑞典语",value:"swe"},{text:"叙利亚语",value:"syr"},{text:"泰米尔语",value:"tam"},{text:"泰卢固语",value:"tel"},{text:"塔吉克",value:"tgk"},{text:"他加禄语",value:"tgl"},{text:"提格里尼亚",value:"tir"},{text:"土耳其语",value:"tur"},{text:"维吾尔语",value:"uig"},{text:"乌克兰语",value:"ukr"},{text:"乌尔都语",value:"urd"},{text:"乌兹别克语",value:"uzb"},{text:"乌兹别克语(西里尔)",value:"uzb_cyrl"},{text:"越南语",value:"vie"},{text:"意第绪语",value:"yid"}].reduce(((e,t)=>(r.push(t.value),e[t.value]=t.text,e)),{});var o=a(7294);const i=n.P.ofType(),c=(e,{handleClick:t,modifiers:a})=>a.matchesPredicate?o.createElement(l.sN,{onClick:t,active:a.active,key:e,text:s[e]}):null;function u(e){const{value:t,onChange:a,isSmall:n,isLarge:u,portalContainer:m}=e;return o.createElement(i,{filterable:!1,activeItem:t,items:r,itemRenderer:c,onItemSelect:a,popoverProps:{portalContainer:m,modifiers:{preventOverflow:{boundariesElement:"viewport"}}}},o.createElement(l.zx,{rightIcon:"caret-down",small:n,large:u},s[t]))}},7354:(e,t,a)=>{a.d(t,{n:()=>n});const n=[{value:"translate",label:"翻译这段文本"},{value:"open-pdf-in-viewer",label:"在划词翻译中打开此 PDF（PDF 文件）"},{value:"open-link-in-viewer",label:"在划词翻译中打开此 PDF（PDF 链接）"},{value:"screen-translate",label:"截图翻译"},{value:"page-translate",label:"网页全文翻译"},{value:"video-translate",label:"音视频翻译"}].map((e=>e.value))},6006:(e,t,a)=>{a.d(t,{L:()=>r});const n=/^[A-Z]?[a-z]+([A-Z][a-z]*)+$/,l=/^([A-Za-z]+_)+[A-Za-z]+$/;function r(e,t){let a=e.trim();return t&&(t.sourceTransformNoBr&&(a=a.replace(/\r?\n/g," ")),t.sourceTransformNoComment&&(a=a.replace(/\/\//g," ")),t.sourceTransformRegExps&&(a=t.sourceTransformRegExps.reduce(((e,t)=>{let a;try{a=new RegExp(t.pattern,t.flags)}catch(t){return e}return e.replace(a,t.replaceTo||"")}),a)),t.sourceTransformNCaml&&(n.test(a)?a=a.replace(/[A-Z]/g,((e,t)=>0===t?e.toLowerCase():" "+e.toLowerCase())):l.test(a)&&(a=a.replace(/_/g," ")))),a}},9320:()=>{String.prototype.matchAll||(String.prototype.matchAll=function*(e){const t=new RegExp(e,e.flags),a=this.toString();let n;for(;n=t.exec(a);)yield n})},9025:(e,t,a)=>{a.d(t,{P:()=>i});var n=a(3150),l=a.n(n),r=a(1515),s=a(9970),o=a(3151);class i{constructor(e,t){this.storageKey=e,this.max=t}async isOver(e){var t;const a=this.storageKey,n=(0,r.Z)(s.d,["user",a]),i=await l().storage.local.get(n);if(null===(t=i.user)||void 0===t?void 0:t.vipActivated)return!1;const c=i[a];let u=!1;const m=new Date;return c.date||(c.date=m.getTime()),(0,o.Z)(m,c.date)?c.times>=this.max&&(u=!0):(c.date=m.getTime(),c.times=0),e&&!u&&(c.times+=1),await l().storage.local.set({[a]:c}),u}async addOne(){const e=(0,r.Z)(s.d,["user",this.storageKey]),t=(await l().storage.local.get(e))[this.storageKey];t.times+=1,await l().storage.local.set({[this.storageKey]:t})}}},4194:(e,t,a)=>{a.d(t,{mD:()=>n.m,DR:()=>l.D,RE:()=>r.R});var n=a(5127),l=a(9989),r=a(3364)},3364:(e,t,a)=>{a.d(t,{R:()=>i});var n=a(9669),l=a.n(n),r=a(5127),s=a(9989);const o={401:"登录状态已失效，请重新登录。"};function i(e){if(l().isAxiosError(e)){const t=function(e){var t;const{url:a,baseURL:n}=e;let l;try{l=new URL(a||"",n)}catch(e){return"远程服务器"}const{host:r}=l;return(null===(t="https://hs-api.limingkai.cn/")?void 0:t.includes(r))?"划词翻译服务器":"远程服务器"}(e.config),a="划词翻译服务器"===t;if(e.response){const n=e.response.status;return new r.m(a?o[n]||`划词翻译服务器内部产生了一个错误，请稍后重试。HTTP 响应码：${n}。`:`${t}返回了错误的 HTTP 响应码：${n}。`,{type:"API_SERVER_ERROR"})}return e.request?new r.m(`${t}没有响应。`,{type:"NETWORK_ERROR",link:{name:"查看解决方案",url:"划词翻译服务器"===t?"https://hcfy.app/docs/faq/#server-no-response":"https://hcfy.app/docs/faq/#why-services-always-loading"}}):new r.m(`向${t}发起请求时发生了一个错误：“${e.message}”`,{type:null})}return(0,s.D)(e)}}}]);